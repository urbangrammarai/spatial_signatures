
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>&lt;no title&gt; &#8212; Urban Grammar AI | WP2 - Spatial Signatures</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/sphinx-book-theme.e8f53015daec13862f6db5e763c41738.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      <img src="../_static/logo.svg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Urban Grammar AI | WP2 - Spatial Signatures</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p class="caption">
 <span class="caption-text">
  Project
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference external" href="http://urbangrammarai.xyz">
   Project homepage
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="http://urbangrammarai.xyz/data_processing">
   WP1 - Data processing
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Spatial unit
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../spatial_unit/unit.html">
   Exploration of tessellation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../spatial_unit/Parallelized_enclosures.html">
   Generating enclosures (proof of a concept)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../spatial_unit/enclosed_tessellation.html">
   Enclosed tessellation (proof of a concept)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../spatial_unit/Generate_enclosures.html">
   Generate enclosures for the Great Britain
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../spatial_unit/chunk_uk.html">
   Geo-chunking Great Britain
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../spatial_unit/chunked_enclosed_tessellation.html">
   Generate enclosed tessellation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../spatial_unit/hierarchical_ids.html">
   Generate hierarchical unique IDs
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Populating units with data
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../measuring/cross-chunk_indices.html">
   Cross-chunk indices
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../measuring/morphometrics.html">
   Urban morphometrics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../measuring/inscribed_circle.html">
   Create inscribed circles
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../measuring/functional_data.html">
   Functional data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../measuring/accessibility.html">
   Accessibility-based characters
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../measuring/GHS-composite-S2_ndvi.html">
   NDVI
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Cluster analysis
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="mastermap_openmap_cluster.html">
   Trial of clustering on OpenMap and MasterMap data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="model_selection.html">
   Clustering model selection matrix
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="spatial_signatures_gb.html">
   Generate Spatial Signatures across GB
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="level2_ss.html">
   Second-level signatures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="signature_labels_data.html">
   Create canonical labels attached to tessellation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="form_signatures_GB.html">
   Form-based signatures across GB
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="leve2_form.html">
   Second-level form signatures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="function_signatures_GB.html">
   Function-based signatures across GB
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="level2_function.html">
   Second-level function signatures
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Signature exploration
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_signatures.html">
   Plot signatures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="exploration_of_signatures.html">
   Exploration of top-level clusters
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="feature_importance.html">
   Cluster exploration and feature importance
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cluster_feature_importance.html">
   Feature importance per signature type
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="exploration_of_form_signatures.html">
   Exploration of form-based signatures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="form_feature_importance.html">
   Feature importance per form type
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="validation.html">
   External validation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../esda/sizeshape.html">
   Size and shape of signatures
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Data product
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../data_product/overview.html">
   Overview of the data product
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../data_product/create_data_product.html">
   Create a data product
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../data_product/oa_interpolation.html">
   Interpolation of signatures to OA and LSOA
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../data_product/vector_tile.html">
   Generate vector tiles
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/clusters/_northhampton.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/urbangrammarai/spatial_signatures"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/urbangrammarai/spatial_signatures/master?urlpath=tree/clusters/_northhampton.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="simple visible nav section-nav flex-column">
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">momepy</span>
<span class="kn">import</span> <span class="nn">libpysal</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">preprocessing</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">clustergram</span> <span class="kn">import</span> <span class="n">Clustergram</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chunks</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s1">&#39;../../urbangrammar_samba/spatial_signatures/local_auth_chunks.pq&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chunks</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>geometry</th>
      <th>chunkID</th>
    </tr>
    <tr>
      <th>lbls</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0.0</th>
      <td>POLYGON ((347746.989 428617.983, 347611.489 42...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1.0</th>
      <td>POLYGON ((466755.502 343585.209, 466723.708 34...</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2.0</th>
      <td>POLYGON ((492814.052 165900.388, 492653.958 16...</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3.0</th>
      <td>POLYGON ((555738.312 145126.176, 555646.807 14...</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4.0</th>
      <td>POLYGON ((539183.091 274691.315, 539231.597 27...</td>
      <td>4</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>98.0</th>
      <td>POLYGON ((416824.197 290592.777, 416904.996 29...</td>
      <td>98</td>
    </tr>
    <tr>
      <th>99.0</th>
      <td>POLYGON ((377928.269 131214.407, 377903.871 13...</td>
      <td>99</td>
    </tr>
    <tr>
      <th>100.0</th>
      <td>POLYGON ((356179.971 588517.721, 356353.165 58...</td>
      <td>100</td>
    </tr>
    <tr>
      <th>101.0</th>
      <td>POLYGON ((443213.856 409836.842, 443218.555 40...</td>
      <td>101</td>
    </tr>
    <tr>
      <th>102.0</th>
      <td>POLYGON ((406868.828 366991.443, 406922.429 36...</td>
      <td>102</td>
    </tr>
  </tbody>
</table>
<p>103 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">shapely.geometry</span> <span class="kn">import</span> <span class="n">Point</span>

<span class="n">nhmptn</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">([</span><span class="n">Point</span><span class="p">(</span><span class="o">-</span><span class="mf">0.9087</span><span class="p">,</span> <span class="mf">52.2375</span><span class="p">)],</span> <span class="n">crs</span><span class="o">=</span><span class="mi">4326</span><span class="p">)</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="mi">27700</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chunks</span><span class="p">[</span><span class="n">chunks</span><span class="o">.</span><span class="n">intersects</span><span class="p">(</span><span class="n">nhmptn</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>geometry</th>
      <th>chunkID</th>
    </tr>
    <tr>
      <th>lbls</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8.0</th>
      <td>POLYGON ((496531.705 246753.398, 496484.411 24...</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lon</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">([</span><span class="n">Point</span><span class="p">(</span><span class="o">-</span><span class="mf">0.12807355616611568</span><span class="p">,</span> <span class="mf">51.50604696235029</span><span class="p">)],</span> <span class="n">crs</span><span class="o">=</span><span class="mi">4326</span><span class="p">)</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="mi">27700</span><span class="p">)</span>
<span class="n">chunks</span><span class="p">[</span><span class="n">chunks</span><span class="o">.</span><span class="n">intersects</span><span class="p">(</span><span class="n">lon</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>geometry</th>
      <th>chunkID</th>
    </tr>
    <tr>
      <th>lbls</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>15.0</th>
      <td>POLYGON ((529406.101 170556.868, 529402.220 17...</td>
      <td>15</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/morphometrics/cells/cells_8.pq&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;hindex&#39;, &#39;tessellation&#39;, &#39;buildings&#39;, &#39;sdbAre&#39;, &#39;sdbPer&#39;, &#39;sdbCoA&#39;,
       &#39;ssbCCo&#39;, &#39;ssbCor&#39;, &#39;ssbSqu&#39;, &#39;ssbERI&#39;, &#39;ssbElo&#39;, &#39;ssbCCM&#39;, &#39;ssbCCD&#39;,
       &#39;stbOri&#39;, &#39;sdcLAL&#39;, &#39;sdcAre&#39;, &#39;sscCCo&#39;, &#39;sscERI&#39;, &#39;stcOri&#39;, &#39;sicCAR&#39;,
       &#39;stbCeA&#39;, &#39;mtbAli&#39;, &#39;mtbNDi&#39;, &#39;mtcWNe&#39;, &#39;mdcAre&#39;, &#39;ltcWRE&#39;, &#39;ltbIBD&#39;,
       &#39;nodeID&#39;, &#39;sdsSPW&#39;, &#39;sdsSWD&#39;, &#39;sdsSPO&#39;, &#39;sdsLen&#39;, &#39;sssLin&#39;, &#39;ldsMSL&#39;,
       &#39;mtdDeg&#39;, &#39;lcdMes&#39;, &#39;linP3W&#39;, &#39;linP4W&#39;, &#39;linPDE&#39;, &#39;lcnClo&#39;, &#39;ldsCDL&#39;,
       &#39;xcnSCl&#39;, &#39;mtdMDi&#39;, &#39;lddNDe&#39;, &#39;linWID&#39;, &#39;edgeID_keys&#39;, &#39;edgeID_values&#39;,
       &#39;edgeID_primary&#39;, &#39;stbSAl&#39;, &#39;sddAre&#39;, &#39;sdsAre&#39;, &#39;sisBpM&#39;, &#39;misCel&#39;,
       &#39;mdsAre&#39;, &#39;lisCel&#39;, &#39;ldsAre&#39;, &#39;ltcRea&#39;, &#39;ltcAre&#39;, &#39;ldeAre&#39;, &#39;ldePer&#39;,
       &#39;lseCCo&#39;, &#39;lseERI&#39;, &#39;lseCWA&#39;, &#39;lteOri&#39;, &#39;lteWNB&#39;, &#39;lieWCe&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">characters</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sdbAre&#39;</span><span class="p">,</span> <span class="s1">&#39;sdbPer&#39;</span><span class="p">,</span> <span class="s1">&#39;sdbCoA&#39;</span><span class="p">,</span>
       <span class="s1">&#39;ssbCCo&#39;</span><span class="p">,</span> <span class="s1">&#39;ssbCor&#39;</span><span class="p">,</span> <span class="s1">&#39;ssbSqu&#39;</span><span class="p">,</span> <span class="s1">&#39;ssbERI&#39;</span><span class="p">,</span> <span class="s1">&#39;ssbElo&#39;</span><span class="p">,</span> <span class="s1">&#39;ssbCCM&#39;</span><span class="p">,</span> <span class="s1">&#39;ssbCCD&#39;</span><span class="p">,</span>
       <span class="s1">&#39;stbOri&#39;</span><span class="p">,</span> <span class="s1">&#39;sdcLAL&#39;</span><span class="p">,</span> <span class="s1">&#39;sdcAre&#39;</span><span class="p">,</span> <span class="s1">&#39;sscCCo&#39;</span><span class="p">,</span> <span class="s1">&#39;sscERI&#39;</span><span class="p">,</span> <span class="s1">&#39;stcOri&#39;</span><span class="p">,</span> <span class="s1">&#39;sicCAR&#39;</span><span class="p">,</span>
       <span class="s1">&#39;stbCeA&#39;</span><span class="p">,</span> <span class="s1">&#39;mtbAli&#39;</span><span class="p">,</span> <span class="s1">&#39;mtbNDi&#39;</span><span class="p">,</span> <span class="s1">&#39;mtcWNe&#39;</span><span class="p">,</span> <span class="s1">&#39;mdcAre&#39;</span><span class="p">,</span> <span class="s1">&#39;ltcWRE&#39;</span><span class="p">,</span> <span class="s1">&#39;ltbIBD&#39;</span><span class="p">,</span>
       <span class="s1">&#39;sdsSPW&#39;</span><span class="p">,</span> <span class="s1">&#39;sdsSWD&#39;</span><span class="p">,</span> <span class="s1">&#39;sdsSPO&#39;</span><span class="p">,</span> <span class="s1">&#39;sdsLen&#39;</span><span class="p">,</span> <span class="s1">&#39;sssLin&#39;</span><span class="p">,</span> <span class="s1">&#39;ldsMSL&#39;</span><span class="p">,</span>
       <span class="s1">&#39;mtdDeg&#39;</span><span class="p">,</span> <span class="s1">&#39;lcdMes&#39;</span><span class="p">,</span> <span class="s1">&#39;linP3W&#39;</span><span class="p">,</span> <span class="s1">&#39;linP4W&#39;</span><span class="p">,</span> <span class="s1">&#39;linPDE&#39;</span><span class="p">,</span> <span class="s1">&#39;lcnClo&#39;</span><span class="p">,</span> <span class="s1">&#39;ldsCDL&#39;</span><span class="p">,</span>
       <span class="s1">&#39;xcnSCl&#39;</span><span class="p">,</span> <span class="s1">&#39;mtdMDi&#39;</span><span class="p">,</span> <span class="s1">&#39;lddNDe&#39;</span><span class="p">,</span> <span class="s1">&#39;linWID&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;stbSAl&#39;</span><span class="p">,</span> <span class="s1">&#39;sddAre&#39;</span><span class="p">,</span> <span class="s1">&#39;sdsAre&#39;</span><span class="p">,</span> <span class="s1">&#39;sisBpM&#39;</span><span class="p">,</span> <span class="s1">&#39;misCel&#39;</span><span class="p">,</span>
       <span class="s1">&#39;mdsAre&#39;</span><span class="p">,</span> <span class="s1">&#39;lisCel&#39;</span><span class="p">,</span> <span class="s1">&#39;ldsAre&#39;</span><span class="p">,</span> <span class="s1">&#39;ltcRea&#39;</span><span class="p">,</span> <span class="s1">&#39;ltcAre&#39;</span><span class="p">,</span> <span class="s1">&#39;ldeAre&#39;</span><span class="p">,</span> <span class="s1">&#39;ldePer&#39;</span><span class="p">,</span>
       <span class="s1">&#39;lseCCo&#39;</span><span class="p">,</span> <span class="s1">&#39;lseERI&#39;</span><span class="p">,</span> <span class="s1">&#39;lseCWA&#39;</span><span class="p">,</span> <span class="s1">&#39;lteOri&#39;</span><span class="p">,</span> <span class="s1">&#39;lteWNB&#39;</span><span class="p">,</span> <span class="s1">&#39;lieWCe&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">characters</span><span class="p">],</span> <span class="n">geometry</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">tessellation</span><span class="o">.</span><span class="n">centroid</span><span class="p">)</span>
<span class="o">%</span><span class="k">time</span> W = momepy.sw_high(k=10, weights=libpysal.weights.Queen.from_dataframe(data, geom_col=&#39;tessellation&#39;))
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/libpysal/weights/weights.py:172: UserWarning: The weights matrix is not fully connected: 
 There are 15 disconnected components.
 There are 9 islands with ids: 146559, 147775, 147875, 147883, 147901, 148577, 149323, 149342, 149349.
  warnings.warn(message)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 5min 44s, sys: 10.7 s, total: 5min 55s
Wall time: 5min 55s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">convolutions</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">characters</span><span class="p">:</span>
    <span class="n">convolutions</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># measure convolutions</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">geom</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">gdf</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">iteritems</span><span class="p">(),</span> <span class="n">total</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">neighbours</span> <span class="o">=</span> <span class="n">W</span><span class="o">.</span><span class="n">neighbors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">vicinity</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">neighbours</span><span class="p">]</span>
    <span class="n">distance</span> <span class="o">=</span> <span class="n">vicinity</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">geom</span><span class="p">)</span>
    <span class="n">distance_decay</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">distance</span>
    
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">characters</span><span class="p">:</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">vicinity</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">sorter</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">sorter</span><span class="p">]</span>
        <span class="n">nan_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nan_mask</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
            <span class="n">convolutions</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sample_weight</span> <span class="o">=</span> <span class="n">distance_decay</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">sorter</span><span class="p">][</span><span class="o">~</span><span class="n">nan_mask</span><span class="p">]</span>
            <span class="n">weighted_quantiles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">sample_weight</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">sample_weight</span>
            <span class="n">weighted_quantiles</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">sample_weight</span><span class="p">)</span>
            <span class="n">interpolate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">([</span><span class="mf">.25</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mf">.75</span><span class="p">],</span> <span class="n">weighted_quantiles</span><span class="p">,</span> <span class="n">values</span><span class="p">[</span><span class="o">~</span><span class="n">nan_mask</span><span class="p">])</span>
            <span class="n">convolutions</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">interpolate</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 33%|███▎      | 48833/149525 [04:55&lt;09:24, 178.38it/s]&lt;ipython-input-15-07ef19d7cbf0&gt;:21: RuntimeWarning: invalid value encountered in subtract
  weighted_quantiles = np.cumsum(sample_weight) - 0.5 * sample_weight
&lt;ipython-input-15-07ef19d7cbf0&gt;:22: RuntimeWarning: invalid value encountered in true_divide
  weighted_quantiles /= np.sum(sample_weight)
100%|██████████| 149525/149525 [15:16&lt;00:00, 163.08it/s]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">time</span> conv = pd.DataFrame(convolutions, index=data.index)
<span class="o">%</span><span class="k">time</span> exploded = pd.concat([pd.DataFrame(conv[c].to_list(), columns=[c + &#39;_q1&#39;, c + &#39;_q2&#39;,c + &#39;_q3&#39;]) for c in characters], axis=1)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 1.87 s, sys: 44 ms, total: 1.91 s
Wall time: 1.91 s
CPU times: user 11.9 s, sys: 356 ms, total: 12.3 s
Wall time: 12.3 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scaler</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">StandardScaler</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scaled_data</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">exploded</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mask</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">within</span><span class="p">(</span><span class="n">Point</span><span class="p">(</span><span class="mi">475000</span><span class="p">,</span> <span class="mi">260000</span><span class="p">)</span><span class="o">.</span><span class="n">buffer</span><span class="p">(</span><span class="mi">10000</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nh_data</span> <span class="o">=</span> <span class="n">scaled_data</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nh_data</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(36396, 177)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nulls</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">nh_data</span><span class="p">)</span>
<span class="n">nh_data</span><span class="p">[</span><span class="n">nulls</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cg</span> <span class="o">=</span> <span class="n">Clustergram</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">n_init</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">cg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">nh_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>K=1 fitted in 1.0541980266571045 seconds.
K=2 fitted in 1.1690411567687988 seconds.
K=3 fitted in 1.663944959640503 seconds.
K=4 fitted in 1.7653963565826416 seconds.
K=5 fitted in 2.0640511512756348 seconds.
K=6 fitted in 2.0697145462036133 seconds.
K=7 fitted in 2.2315945625305176 seconds.
K=8 fitted in 2.809513568878174 seconds.
K=9 fitted in 2.948035955429077 seconds.
K=10 fitted in 3.0751941204071045 seconds.
K=11 fitted in 3.4062979221343994 seconds.
K=12 fitted in 3.78933048248291 seconds.
K=13 fitted in 3.949535846710205 seconds.
K=14 fitted in 4.091408967971802 seconds.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">cg</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">cluster_style</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;edgecolor&quot;</span><span class="p">:</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;alpha&quot;</span><span class="p">:</span><span class="mf">.6</span><span class="p">},</span> <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># ax.set_ylim(-10, 50)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/_northhampton_21_0.png" src="../_images/_northhampton_21_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">nh</span><span class="o">.</span><span class="n">set_geometry</span><span class="p">(</span><span class="s1">&#39;buildings&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cg</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">categorical</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;tab10&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/_northhampton_22_0.png" src="../_images/_northhampton_22_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">km</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">n_init</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">nh_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nh</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">nh</span><span class="o">.</span><span class="n">set_geometry</span><span class="p">(</span><span class="s1">&#39;buildings&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">km</span><span class="o">.</span><span class="n">labels_</span><span class="p">,</span> <span class="n">categorical</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;tab10&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/_northhampton_26_0.png" src="../_images/_northhampton_26_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nh</span><span class="p">[</span><span class="s1">&#39;clusters&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">km</span><span class="o">.</span><span class="n">labels_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/geopandas/geodataframe.py:853: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nh</span><span class="o">.</span><span class="n">set_geometry</span><span class="p">(</span><span class="s2">&quot;buildings&quot;</span><span class="p">)[[</span><span class="s1">&#39;clusters&#39;</span><span class="p">,</span> <span class="s1">&#39;buildings&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s1">&#39;north.gpkg&#39;</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="s1">&#39;GPKG&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nh</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>hindex</th>
      <th>tessellation</th>
      <th>buildings</th>
      <th>sdbAre</th>
      <th>sdbPer</th>
      <th>sdbCoA</th>
      <th>ssbCCo</th>
      <th>ssbCor</th>
      <th>ssbSqu</th>
      <th>ssbERI</th>
      <th>...</th>
      <th>ltcAre</th>
      <th>ldeAre</th>
      <th>ldePer</th>
      <th>lseCCo</th>
      <th>lseERI</th>
      <th>lseCWA</th>
      <th>lteOri</th>
      <th>lteWNB</th>
      <th>lieWCe</th>
      <th>clusters</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>84662</th>
      <td>c008e296665t0017</td>
      <td>POLYGON ((475063.154 255443.046, 475060.757 25...</td>
      <td>POLYGON ((475064.670 255467.970, 475056.670 25...</td>
      <td>280.5151</td>
      <td>78.386230</td>
      <td>0.0</td>
      <td>0.469208</td>
      <td>6.0</td>
      <td>1.964106</td>
      <td>0.861559</td>
      <td>...</td>
      <td>1.099443e+05</td>
      <td>230190.13020</td>
      <td>2219.298778</td>
      <td>0.365673</td>
      <td>0.915068</td>
      <td>470.424165</td>
      <td>27.410684</td>
      <td>0.000901</td>
      <td>0.001688</td>
      <td>1</td>
    </tr>
    <tr>
      <th>84663</th>
      <td>c008e296665t0016</td>
      <td>POLYGON ((475077.010 255439.660, 475088.837 25...</td>
      <td>POLYGON ((475068.410 255437.200, 475053.700 25...</td>
      <td>159.2342</td>
      <td>52.583478</td>
      <td>0.0</td>
      <td>0.543714</td>
      <td>4.0</td>
      <td>0.026469</td>
      <td>1.000000</td>
      <td>...</td>
      <td>1.346705e+05</td>
      <td>230190.13020</td>
      <td>2219.298778</td>
      <td>0.365673</td>
      <td>0.915068</td>
      <td>470.424165</td>
      <td>27.410684</td>
      <td>0.000901</td>
      <td>0.001688</td>
      <td>1</td>
    </tr>
    <tr>
      <th>84664</th>
      <td>c008e296665t0007</td>
      <td>POLYGON ((475273.021 255120.606, 475272.310 25...</td>
      <td>POLYGON ((475050.870 255285.670, 475055.950 25...</td>
      <td>32.3360</td>
      <td>22.831995</td>
      <td>0.0</td>
      <td>0.626878</td>
      <td>4.0</td>
      <td>0.021263</td>
      <td>1.000014</td>
      <td>...</td>
      <td>4.332612e+06</td>
      <td>230190.13020</td>
      <td>2219.298778</td>
      <td>0.365673</td>
      <td>0.915068</td>
      <td>470.424165</td>
      <td>27.410684</td>
      <td>0.000901</td>
      <td>0.001688</td>
      <td>1</td>
    </tr>
    <tr>
      <th>84665</th>
      <td>c008e296665t0014</td>
      <td>POLYGON ((475179.665 255349.022, 475193.973 25...</td>
      <td>POLYGON ((475059.420 255334.190, 475069.960 25...</td>
      <td>66.7386</td>
      <td>36.176424</td>
      <td>0.0</td>
      <td>0.438568</td>
      <td>4.0</td>
      <td>0.020433</td>
      <td>1.000031</td>
      <td>...</td>
      <td>2.671080e+06</td>
      <td>230190.13020</td>
      <td>2219.298778</td>
      <td>0.365673</td>
      <td>0.915068</td>
      <td>470.424165</td>
      <td>27.410684</td>
      <td>0.000901</td>
      <td>0.001688</td>
      <td>1</td>
    </tr>
    <tr>
      <th>84666</th>
      <td>c008e296665t0013</td>
      <td>POLYGON ((475083.257 255463.821, 475082.489 25...</td>
      <td>POLYGON ((475082.780 255465.110, 475084.850 25...</td>
      <td>117.5740</td>
      <td>59.514714</td>
      <td>0.0</td>
      <td>0.230033</td>
      <td>4.0</td>
      <td>0.766072</td>
      <td>0.977062</td>
      <td>...</td>
      <td>1.027716e+05</td>
      <td>230190.13020</td>
      <td>2219.298778</td>
      <td>0.365673</td>
      <td>0.915068</td>
      <td>470.424165</td>
      <td>27.410684</td>
      <td>0.000901</td>
      <td>0.001688</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>149391</th>
      <td>c008e289820t0000</td>
      <td>POLYGON ((481527.770 266002.590, 481543.400 26...</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>6.416343e+05</td>
      <td>3604.86495</td>
      <td>268.050518</td>
      <td>0.346579</td>
      <td>0.996149</td>
      <td>54.144738</td>
      <td>10.222169</td>
      <td>0.003731</td>
      <td>0.005447</td>
      <td>4</td>
    </tr>
    <tr>
      <th>149392</th>
      <td>c008e289807t0000</td>
      <td>POLYGON ((481629.110 266057.120, 481642.870 26...</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>1.349538e+06</td>
      <td>16482.09960</td>
      <td>807.206388</td>
      <td>0.241512</td>
      <td>0.685085</td>
      <td>256.016369</td>
      <td>8.639227</td>
      <td>0.001239</td>
      <td>0.001619</td>
      <td>4</td>
    </tr>
    <tr>
      <th>149393</th>
      <td>c008e289821t0000</td>
      <td>POLYGON ((481731.300 266014.740, 481687.610 26...</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>5.025636e+05</td>
      <td>2982.11840</td>
      <td>235.725664</td>
      <td>0.432070</td>
      <td>0.964060</td>
      <td>38.862221</td>
      <td>8.441331</td>
      <td>0.029696</td>
      <td>0.000050</td>
      <td>4</td>
    </tr>
    <tr>
      <th>149394</th>
      <td>c008e289809t0000</td>
      <td>POLYGON ((481577.300 266077.680, 481586.530 26...</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>4.396889e+05</td>
      <td>416.61140</td>
      <td>95.855970</td>
      <td>0.365981</td>
      <td>0.854313</td>
      <td>20.854425</td>
      <td>43.755955</td>
      <td>0.010432</td>
      <td>0.000842</td>
      <td>4</td>
    </tr>
    <tr>
      <th>149395</th>
      <td>c008e289808t0000</td>
      <td>POLYGON ((481656.630 266103.670, 481642.870 26...</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>6.442841e+05</td>
      <td>2246.60580</td>
      <td>202.521973</td>
      <td>0.410472</td>
      <td>0.992831</td>
      <td>33.127702</td>
      <td>9.603040</td>
      <td>0.024689</td>
      <td>0.001155</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
<p>36396 rows × 67 columns</p>
</div></div></div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./clusters"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    

</div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Dani Arribas-Bel, Martin Fleischmann<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>