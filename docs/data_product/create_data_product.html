
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Create a data product &#8212; Urban Grammar AI | WP2 - Spatial Signatures</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/sphinx-book-theme.e8f53015daec13862f6db5e763c41738.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Interpolation of signatures to OA and LSOA" href="oa_interpolation.html" />
    <link rel="prev" title="Overview of the data product" href="overview.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      <img src="../_static/logo.svg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Urban Grammar AI | WP2 - Spatial Signatures</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p class="caption">
 <span class="caption-text">
  Project
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference external" href="http://urbangrammarai.xyz">
   Project homepage
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="http://urbangrammarai.xyz/data_processing">
   WP1 - Data processing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="http://urbangrammarai.xyz/signature_ai">
   WP3 - Signature AI
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Spatial unit
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../spatial_unit/unit.html">
   Exploration of tessellation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../spatial_unit/Parallelized_enclosures.html">
   Generating enclosures (proof of a concept)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../spatial_unit/enclosed_tessellation.html">
   Enclosed tessellation (proof of a concept)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../spatial_unit/Generate_enclosures.html">
   Generate enclosures for the Great Britain
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../spatial_unit/chunk_uk.html">
   Geo-chunking Great Britain
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../spatial_unit/chunked_enclosed_tessellation.html">
   Generate enclosed tessellation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../spatial_unit/hierarchical_ids.html">
   Generate hierarchical unique IDs
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Populating units with data
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../measuring/cross-chunk_indices.html">
   Cross-chunk indices
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../measuring/morphometrics.html">
   Urban morphometrics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../measuring/inscribed_circle.html">
   Create inscribed circles
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../measuring/functional_data.html">
   Functional data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../measuring/accessibility.html">
   Accessibility-based characters
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../measuring/GHS-composite-S2_ndvi.html">
   NDVI
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Cluster analysis
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../clusters/mastermap_openmap_cluster.html">
   Trial of clustering on OpenMap and MasterMap data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../clusters/model_selection.html">
   Clustering model selection matrix
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../clusters/spatial_signatures_gb.html">
   Generate Spatial Signatures across GB
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../clusters/level2_ss.html">
   Second-level signatures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../clusters/signature_labels_data.html">
   Create canonical labels attached to tessellation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../clusters/form_signatures_GB.html">
   Form-based signatures across GB
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../clusters/leve2_form.html">
   Second-level form signatures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../clusters/function_signatures_GB.html">
   Function-based signatures across GB
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../clusters/level2_function.html">
   Second-level function signatures
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Signature exploration
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../clusters/plot_signatures.html">
   Plot signatures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../clusters/exploration_of_signatures.html">
   Exploration of top-level clusters
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../clusters/feature_importance.html">
   Cluster exploration and feature importance
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../clusters/cluster_feature_importance.html">
   Feature importance per signature type
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../clusters/exploration_of_form_signatures.html">
   Exploration of form-based signatures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../clusters/form_feature_importance.html">
   Feature importance per form type
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../clusters/validation.html">
   External validation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../clusters/validation_GHS_BUILT_C_MSZ.html">
   Comparison between Spatial Signatures and GHSL classes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../esda/sizeshape.html">
   Size and shape of signatures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../esda/co-occurence.html">
   Co-occurence analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../esda/ttwa.html">
   Composition of signatures within TTWA boundaries
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../esda/geog_distribution.html">
   Geographical distribution and coverage of signature types
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Data product
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="overview.html">
   Overview of the data product
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Create a data product
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="oa_interpolation.html">
   Interpolation of signatures to OA and LSOA
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="vector_tile.html">
   Generate vector tiles
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/data_product/create_data_product.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/urbangrammarai/spatial_signatures"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/urbangrammarai/spatial_signatures/master?urlpath=tree/data_product/create_data_product.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signature-geometry">
   Signature geometry
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#remove-z-coordinates">
     Remove Z coordinates
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cleanup-sliver-geometries">
     Cleanup sliver geometries
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#link-data">
   Link data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#harmonize-corine-data">
     Harmonize Corine data.
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#join-data">
     Join data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rename-columns">
   Rename columns
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pen-portraits-json">
   Pen portraits JSON
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#use-string-ids">
   Use string IDs
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dump-etcs-to-an-archive-repository-as-a-partitioned-parquet">
   Dump ETCs to an archive repository as a partitioned parquet
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tables-of-characters">
   Tables of characters
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#figure-of-context">
   Figure of context
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#feature-importance">
   Feature importance
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="create-a-data-product">
<h1>Create a data product<a class="headerlink" href="#create-a-data-product" title="Permalink to this headline">¶</a></h1>
<p>Spatial signatures in Great Britain are released as a data product.</p>
<p>This notebook takes the generated results and turn them into clean outputs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># we need the master version of dask geopandas that has sjoin and recent dask</span>
<span class="o">!</span>pip install git+https://github.com/geopandas/dask-geopandas.git
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span>
<span class="kn">import</span> <span class="nn">dask.dataframe</span>
<span class="kn">import</span> <span class="nn">dask</span>
<span class="kn">import</span> <span class="nn">geopandas</span>
<span class="kn">import</span> <span class="nn">dask_geopandas</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dask_geopandas</span><span class="o">.</span><span class="n">__version__</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;v0.1.0a4+16.gf18ae2c&#39;
</pre></div>
</div>
</div>
</div>
<div class="section" id="signature-geometry">
<h2>Signature geometry<a class="headerlink" href="#signature-geometry" title="Permalink to this headline">¶</a></h2>
<p>We create an output with signature geometry and clear columns.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">signatures</span> <span class="o">=</span> <span class="n">geopandas</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/signatures/signatures_combined_levels_orig.pq&quot;</span><span class="p">)</span>
<span class="n">signatures</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>kmeans10gb</th>
      <th>geometry</th>
      <th>level2</th>
      <th>signature_type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>POLYGON Z ((62220.000 798500.000 0.000, 62110....</td>
      <td>0.0</td>
      <td>0_0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>POLYGON Z ((63507.682 796515.169 0.000, 63471....</td>
      <td>0.0</td>
      <td>0_0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>POLYGON Z ((65953.174 802246.172 0.000, 65950....</td>
      <td>0.0</td>
      <td>0_0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>POLYGON Z ((67297.740 803435.800 0.000, 67220....</td>
      <td>0.0</td>
      <td>0_0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>POLYGON Z ((75760.000 852670.000 0.000, 75700....</td>
      <td>0.0</td>
      <td>0_0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">types</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;0_0&quot;</span><span class="p">:</span> <span class="s2">&quot;Countryside agriculture&quot;</span><span class="p">,</span>
    <span class="s2">&quot;1_0&quot;</span><span class="p">:</span> <span class="s2">&quot;Accessible suburbia&quot;</span><span class="p">,</span>
    <span class="s2">&quot;3_0&quot;</span><span class="p">:</span> <span class="s2">&quot;Open sprawl&quot;</span><span class="p">,</span>
    <span class="s2">&quot;4_0&quot;</span><span class="p">:</span> <span class="s2">&quot;Wild countryside&quot;</span><span class="p">,</span>
    <span class="s2">&quot;5_0&quot;</span><span class="p">:</span> <span class="s2">&quot;Warehouse/Park land&quot;</span><span class="p">,</span>
    <span class="s2">&quot;6_0&quot;</span><span class="p">:</span> <span class="s2">&quot;Gridded residential quarters&quot;</span><span class="p">,</span>
    <span class="s2">&quot;7_0&quot;</span><span class="p">:</span> <span class="s2">&quot;Urban buffer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;8_0&quot;</span><span class="p">:</span> <span class="s2">&quot;Disconnected suburbia&quot;</span><span class="p">,</span>
    <span class="s2">&quot;2_0&quot;</span><span class="p">:</span> <span class="s2">&quot;Dense residential neighbourhoods&quot;</span><span class="p">,</span>
    <span class="s2">&quot;2_1&quot;</span><span class="p">:</span> <span class="s2">&quot;Connected residential neighbourhoods&quot;</span><span class="p">,</span>
    <span class="s2">&quot;2_2&quot;</span><span class="p">:</span> <span class="s2">&quot;Dense urban neighbourhoods&quot;</span><span class="p">,</span>
    <span class="s2">&quot;9_0&quot;</span><span class="p">:</span> <span class="s2">&quot;Local urbanity&quot;</span><span class="p">,</span>
    <span class="s2">&quot;9_1&quot;</span><span class="p">:</span> <span class="s2">&quot;Concentrated urbanity&quot;</span><span class="p">,</span>
    <span class="s2">&quot;9_2&quot;</span><span class="p">:</span> <span class="s2">&quot;Regional urbanity&quot;</span><span class="p">,</span>
    <span class="s2">&quot;9_4&quot;</span><span class="p">:</span> <span class="s2">&quot;Metropolitan urbanity&quot;</span><span class="p">,</span>
    <span class="s2">&quot;9_5&quot;</span><span class="p">:</span> <span class="s2">&quot;Hyper concentrated urbanity&quot;</span><span class="p">,</span>
    <span class="s2">&quot;9_3&quot;</span><span class="p">:</span> <span class="s2">&quot;outlier&quot;</span><span class="p">,</span>
    <span class="s2">&quot;9_6&quot;</span><span class="p">:</span> <span class="s2">&quot;outlier&quot;</span><span class="p">,</span>
    <span class="s2">&quot;9_7&quot;</span><span class="p">:</span> <span class="s2">&quot;outlier&quot;</span><span class="p">,</span>
    <span class="s2">&quot;9_8&quot;</span><span class="p">:</span> <span class="s2">&quot;outlier&quot;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">signatures</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">signatures</span><span class="o">.</span><span class="n">signature_type</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">types</span><span class="p">)</span>
<span class="n">signatures</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">signatures</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">signatures</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>kmeans10gb</th>
      <th>geometry</th>
      <th>level2</th>
      <th>signature_type</th>
      <th>type</th>
      <th>id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>POLYGON Z ((62220.000 798500.000 0.000, 62110....</td>
      <td>0.0</td>
      <td>0_0</td>
      <td>Countryside agriculture</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>POLYGON Z ((63507.682 796515.169 0.000, 63471....</td>
      <td>0.0</td>
      <td>0_0</td>
      <td>Countryside agriculture</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>POLYGON Z ((65953.174 802246.172 0.000, 65950....</td>
      <td>0.0</td>
      <td>0_0</td>
      <td>Countryside agriculture</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>POLYGON Z ((67297.740 803435.800 0.000, 67220....</td>
      <td>0.0</td>
      <td>0_0</td>
      <td>Countryside agriculture</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>POLYGON Z ((75760.000 852670.000 0.000, 75700....</td>
      <td>0.0</td>
      <td>0_0</td>
      <td>Countryside agriculture</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">signatures</span> <span class="o">=</span> <span class="n">signatures</span><span class="p">[[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;geometry&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">signatures</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>type</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Countryside agriculture</td>
      <td>POLYGON Z ((62220.000 798500.000 0.000, 62110....</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Countryside agriculture</td>
      <td>POLYGON Z ((63507.682 796515.169 0.000, 63471....</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>Countryside agriculture</td>
      <td>POLYGON Z ((65953.174 802246.172 0.000, 65950....</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>Countryside agriculture</td>
      <td>POLYGON Z ((67297.740 803435.800 0.000, 67220....</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>Countryside agriculture</td>
      <td>POLYGON Z ((75760.000 852670.000 0.000, 75700....</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>96699</th>
      <td>96699</td>
      <td>outlier</td>
      <td>POLYGON ((323321.005 463795.416, 323319.842 46...</td>
    </tr>
    <tr>
      <th>96700</th>
      <td>96700</td>
      <td>outlier</td>
      <td>POLYGON ((325929.840 1008792.061, 325927.377 1...</td>
    </tr>
    <tr>
      <th>96701</th>
      <td>96701</td>
      <td>outlier</td>
      <td>POLYGON ((337804.770 1013422.583, 337800.122 1...</td>
    </tr>
    <tr>
      <th>96702</th>
      <td>96702</td>
      <td>outlier</td>
      <td>POLYGON ((422304.270 1147826.990, 422296.000 1...</td>
    </tr>
    <tr>
      <th>96703</th>
      <td>96703</td>
      <td>outlier</td>
      <td>POLYGON ((525396.260 439215.480, 525360.920 43...</td>
    </tr>
  </tbody>
</table>
<p>96704 rows × 3 columns</p>
</div></div></div>
</div>
<div class="section" id="remove-z-coordinates">
<h3>Remove Z coordinates<a class="headerlink" href="#remove-z-coordinates" title="Permalink to this headline">¶</a></h3>
<p>Some polygons contain Z coordinates that are not needed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pygeos</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">signatures</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygeos</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">signatures</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="n">include_z</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">signatures</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>type</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Countryside agriculture</td>
      <td>POLYGON ((62220.000 798500.000, 62110.000 7985...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Countryside agriculture</td>
      <td>POLYGON ((63507.682 796515.169, 63471.097 7965...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>Countryside agriculture</td>
      <td>POLYGON ((65953.174 802246.172, 65950.620 8022...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>Countryside agriculture</td>
      <td>POLYGON ((67297.740 803435.800, 67220.289 8034...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>Countryside agriculture</td>
      <td>POLYGON ((75760.000 852670.000, 75700.000 8527...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>96699</th>
      <td>96699</td>
      <td>outlier</td>
      <td>POLYGON ((323321.005 463795.416, 323319.842 46...</td>
    </tr>
    <tr>
      <th>96700</th>
      <td>96700</td>
      <td>outlier</td>
      <td>POLYGON ((325929.840 1008792.061, 325927.377 1...</td>
    </tr>
    <tr>
      <th>96701</th>
      <td>96701</td>
      <td>outlier</td>
      <td>POLYGON ((337804.770 1013422.583, 337800.122 1...</td>
    </tr>
    <tr>
      <th>96702</th>
      <td>96702</td>
      <td>outlier</td>
      <td>POLYGON ((422304.270 1147826.990, 422296.000 1...</td>
    </tr>
    <tr>
      <th>96703</th>
      <td>96703</td>
      <td>outlier</td>
      <td>POLYGON ((525396.260 439215.480, 525360.920 43...</td>
    </tr>
  </tbody>
</table>
<p>96704 rows × 3 columns</p>
</div></div></div>
</div>
</div>
<div class="section" id="cleanup-sliver-geometries">
<h3>Cleanup sliver geometries<a class="headerlink" href="#cleanup-sliver-geometries" title="Permalink to this headline">¶</a></h3>
<p>Remove artifacts caused by floating point imprecision in dissolving of ET cells into signature geometries.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">shapely.geometry</span> <span class="kn">import</span> <span class="n">Polygon</span>

<span class="n">signatures_ddf</span> <span class="o">=</span> <span class="n">dask_geopandas</span><span class="o">.</span><span class="n">from_geopandas</span><span class="p">(</span><span class="n">signatures</span><span class="p">,</span> <span class="n">npartitions</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">fix</span><span class="p">(</span><span class="n">gdf</span><span class="p">):</span>
    <span class="n">new</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">poly</span> <span class="ow">in</span> <span class="n">gdf</span><span class="o">.</span><span class="n">geometry</span><span class="p">:</span>
        <span class="n">new</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Polygon</span><span class="p">(</span><span class="n">shell</span><span class="o">=</span><span class="n">poly</span><span class="o">.</span><span class="n">exterior</span><span class="p">,</span> <span class="n">holes</span><span class="o">=</span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">poly</span><span class="o">.</span><span class="n">interiors</span> <span class="k">if</span> <span class="n">Polygon</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">area</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">geopandas</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">(</span><span class="n">new</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">gdf</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="n">gdf</span><span class="o">.</span><span class="n">crs</span><span class="p">)</span>


<span class="n">signatures_ddf</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">signatures_ddf</span><span class="o">.</span><span class="n">map_partitions</span><span class="p">(</span><span class="n">fix</span><span class="p">,</span> <span class="n">meta</span><span class="o">=</span><span class="n">geopandas</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">signatures</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s2">&quot;spatial_signatures_GB.gpkg&quot;</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="s2">&quot;GPKG&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="link-data">
<h2>Link data<a class="headerlink" href="#link-data" title="Permalink to this headline">¶</a></h2>
<p>We also need CSV summarising geometries, but since we want to use the original characters before contextualisation and standardisation, we need to join them to geometry.</p>
<div class="section" id="harmonize-corine-data">
<h3>Harmonize Corine data.<a class="headerlink" href="#harmonize-corine-data" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyarrow.parquet</span> <span class="k">as</span> <span class="nn">pq</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">columns</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">103</span><span class="p">):</span>
    <span class="n">schema</span> <span class="o">=</span> <span class="n">pq</span><span class="o">.</span><span class="n">read_schema</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/functional/corine/corine_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">.pq&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">schema</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
        <span class="n">columns</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">103</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/functional/corine/corine_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">.pq&quot;</span><span class="p">)</span>
    <span class="n">missing</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">columns</span> <span class="k">if</span> <span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
    <span class="n">df</span><span class="p">[</span><span class="n">missing</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">df</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/functional/corine/corine_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">.pq&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="join-data">
<h3>Join data<a class="headerlink" href="#join-data" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dask.distributed</span> <span class="kn">import</span> <span class="n">Client</span><span class="p">,</span> <span class="n">LocalCluster</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">LocalCluster</span><span class="p">(</span><span class="n">n_workers</span><span class="o">=</span><span class="mi">8</span><span class="p">))</span>
<span class="n">client</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
    <div style="width: 24px; height: 24px; background-color: #e1e1e1; border: 3px solid #9D9D9D; border-radius: 5px; position: absolute;"> </div>
    <div style="margin-left: 48px;">
        <h3 style="margin-bottom: 0px;">Client</h3>
        <p style="color: #9D9D9D; margin-bottom: 0px;">Client-b5f9b711-0a6c-11ec-85f9-0242ac110002</p>
        <table style="width: 100%; text-align: left;">

        <tr>

            <td style="text-align: left;"><strong>Connection method:</strong> Cluster object</td>
            <td style="text-align: left;"><strong>Cluster type:</strong> distributed.LocalCluster</td>

        </tr>


            <tr>
                <td style="text-align: left;">
                    <strong>Dashboard: </strong> <a href="http://127.0.0.1:8787/status" target="_blank">http://127.0.0.1:8787/status</a>
                </td>
                <td style="text-align: left;"></td>
            </tr>


        </table>


            <details>
            <summary style="margin-bottom: 20px;"><h3 style="display: inline;">Cluster Info</h3></summary>
            <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-mod-trusted jp-OutputArea-output">
    <div style="width: 24px; height: 24px; background-color: #e1e1e1; border: 3px solid #9D9D9D; border-radius: 5px; position: absolute;">
    </div>
    <div style="margin-left: 48px;">
        <h3 style="margin-bottom: 0px; margin-top: 0px;">LocalCluster</h3>
        <p style="color: #9D9D9D; margin-bottom: 0px;">c364f511</p>
        <table style="width: 100%; text-align: left;">
            <tr>
                <td style="text-align: left;">
                    <strong>Dashboard:</strong> <a href="http://127.0.0.1:8787/status" target="_blank">http://127.0.0.1:8787/status</a>
                </td>
                <td style="text-align: left;">
                    <strong>Workers:</strong> 8
                </td>
            </tr>
            <tr>
                <td style="text-align: left;">
                    <strong>Total threads:</strong> 16
                </td>
                <td style="text-align: left;">
                    <strong>Total memory:</strong> 125.55 GiB
                </td>
            </tr>

            <tr>
    <td style="text-align: left;"><strong>Status:</strong> running</td>
    <td style="text-align: left;"><strong>Using processes:</strong> True</td>
</tr>


        </table>

        <details>
            <summary style="margin-bottom: 20px;">
                <h3 style="display: inline;">Scheduler Info</h3>
            </summary>

            <div style="">
    <div>
        <div style="width: 24px; height: 24px; background-color: #FFF7E5; border: 3px solid #FF6132; border-radius: 5px; position: absolute;"> </div>
        <div style="margin-left: 48px;">
            <h3 style="margin-bottom: 0px;">Scheduler</h3>
            <p style="color: #9D9D9D; margin-bottom: 0px;">Scheduler-7f95868f-38c0-41cc-bef2-91e05d88ddb8</p>
            <table style="width: 100%; text-align: left;">
                <tr>
                    <td style="text-align: left;">
                        <strong>Comm:</strong> tcp://127.0.0.1:37701
                    </td>
                    <td style="text-align: left;">
                        <strong>Workers:</strong> 8
                    </td>
                </tr>
                <tr>
                    <td style="text-align: left;">
                        <strong>Dashboard:</strong> <a href="http://127.0.0.1:8787/status" target="_blank">http://127.0.0.1:8787/status</a>
                    </td>
                    <td style="text-align: left;">
                        <strong>Total threads:</strong> 16
                    </td>
                </tr>
                <tr>
                    <td style="text-align: left;">
                        <strong>Started:</strong> Just now
                    </td>
                    <td style="text-align: left;">
                        <strong>Total memory:</strong> 125.55 GiB
                    </td>
                </tr>
            </table>
        </div>
    </div>

    <details style="margin-left: 48px;">
        <summary style="margin-bottom: 20px;">
            <h3 style="display: inline;">Workers</h3>
        </summary>


        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 0</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:36115
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 2
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="http://127.0.0.1:37581/status" target="_blank">http://127.0.0.1:37581/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 15.69 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:36133
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /home/jovyan/work/spatial_signatures/data_product/dask-worker-space/worker-w6mvf4ot
                        </td>
                    </tr>





                </table>
            </details>
            </div>
        </div>

        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 1</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:34095
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 2
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="http://127.0.0.1:41073/status" target="_blank">http://127.0.0.1:41073/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 15.69 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:42657
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /home/jovyan/work/spatial_signatures/data_product/dask-worker-space/worker-_dgk8ggr
                        </td>
                    </tr>





                </table>
            </details>
            </div>
        </div>

        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 2</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:36553
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 2
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="http://127.0.0.1:46527/status" target="_blank">http://127.0.0.1:46527/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 15.69 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:40465
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /home/jovyan/work/spatial_signatures/data_product/dask-worker-space/worker-w5tfmvxj
                        </td>
                    </tr>





                </table>
            </details>
            </div>
        </div>

        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 3</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:37429
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 2
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="http://127.0.0.1:46297/status" target="_blank">http://127.0.0.1:46297/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 15.69 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:43827
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /home/jovyan/work/spatial_signatures/data_product/dask-worker-space/worker-qq8ve98m
                        </td>
                    </tr>





                </table>
            </details>
            </div>
        </div>

        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 4</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:40931
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 2
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="http://127.0.0.1:36109/status" target="_blank">http://127.0.0.1:36109/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 15.69 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:41977
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /home/jovyan/work/spatial_signatures/data_product/dask-worker-space/worker-o4ibcabn
                        </td>
                    </tr>





                </table>
            </details>
            </div>
        </div>

        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 5</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:38313
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 2
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="http://127.0.0.1:42449/status" target="_blank">http://127.0.0.1:42449/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 15.69 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:44105
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /home/jovyan/work/spatial_signatures/data_product/dask-worker-space/worker-erb1jj_t
                        </td>
                    </tr>





                </table>
            </details>
            </div>
        </div>

        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 6</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:39061
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 2
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="http://127.0.0.1:43121/status" target="_blank">http://127.0.0.1:43121/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 15.69 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:38433
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /home/jovyan/work/spatial_signatures/data_product/dask-worker-space/worker-0uhi0o89
                        </td>
                    </tr>





                </table>
            </details>
            </div>
        </div>

        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 7</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:37331
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 2
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="http://127.0.0.1:35769/status" target="_blank">http://127.0.0.1:35769/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 15.69 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:39703
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /home/jovyan/work/spatial_signatures/data_product/dask-worker-space/worker-plm8h9tl
                        </td>
                    </tr>





                </table>
            </details>
            </div>
        </div>


    </details>
</div>

        </details>
    </div>
</div>
            </details>


    </div>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tessellation</span> <span class="o">=</span> <span class="n">dask_geopandas</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/tessellation/tess_*.pq&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/io/parquet.py:83: FutureWarning: Assigning CRS to a GeoDataFrame without a geometry column is now deprecated and will not be supported in the future.
  meta = geopandas.GeoDataFrame(meta, crs=crs)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tessellation</span> <span class="o">=</span> <span class="n">dask_geopandas</span><span class="o">.</span><span class="n">from_dask_dataframe</span><span class="p">(</span><span class="n">tessellation</span><span class="p">[[</span><span class="s2">&quot;hindex&quot;</span><span class="p">,</span> <span class="s2">&quot;tessellation&quot;</span><span class="p">]])</span><span class="o">.</span><span class="n">set_geometry</span><span class="p">(</span><span class="s2">&quot;tessellation&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">explode</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tessellation</span><span class="p">[</span><span class="s2">&quot;point&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tessellation</span><span class="o">.</span><span class="n">representative_point</span><span class="p">()</span>
<span class="n">tessellation</span> <span class="o">=</span> <span class="n">tessellation</span><span class="o">.</span><span class="n">set_geometry</span><span class="p">(</span><span class="s2">&quot;point&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">joined</span> <span class="o">=</span> <span class="n">dask_geopandas</span><span class="o">.</span><span class="n">sjoin</span><span class="p">(</span><span class="n">tessellation</span><span class="p">,</span> <span class="n">signatures</span><span class="p">,</span> <span class="n">op</span><span class="o">=</span><span class="s2">&quot;within&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/sjoin.py:50: UserWarning: CRS mismatch between the CRS of left geometries and the CRS of right geometries.
Use `to_crs()` to reproject one of the input geometries to match the CRS of the other.

Left CRS: None
Right CRS: EPSG:27700

  meta = geopandas.sjoin(left._meta, right._meta, how=how, op=op)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">joined</span><span class="p">[[</span><span class="s2">&quot;hindex&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/signatures/hindex_to_type&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 17.1 s, sys: 3.16 s, total: 20.3 s
Wall time: 1min 33s
</pre></div>
</div>
</div>
</div>
<p>Second bit.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">joined</span> <span class="o">=</span> <span class="n">dask</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/signatures/hindex_to_type&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pop</span> <span class="o">=</span> <span class="n">dask</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/functional/population/pop_*&quot;</span><span class="p">)</span>
<span class="n">nl</span> <span class="o">=</span> <span class="n">dask</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/functional/night_lights/nl_*&quot;</span><span class="p">)</span>
<span class="n">workplace</span> <span class="o">=</span> <span class="n">dask</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/functional/workplace/pop_*&quot;</span><span class="p">)</span>
<span class="n">corine</span> <span class="o">=</span> <span class="n">dask</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/functional/corine/corine_*.pq&quot;</span><span class="p">)</span>
<span class="n">ndvi</span> <span class="o">=</span> <span class="n">dask</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;../../urbangrammar_samba/functional_data/ndvi/ndvi_tess_*.pq&quot;</span><span class="p">)</span>
<span class="n">pois</span> <span class="o">=</span> <span class="n">dask</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/functional/accessibility/access_*.pq&quot;</span><span class="p">)</span>
<span class="n">water</span> <span class="o">=</span> <span class="n">dask</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;../../urbangrammar_samba/spatial_signatures/functional/water/water_*.pq&#39;</span><span class="p">)</span>
<span class="n">retail_centres</span> <span class="o">=</span> <span class="n">dask</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;../../urbangrammar_samba/spatial_signatures/functional/retail_centre/retail_*.pq&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">function</span> <span class="o">=</span> <span class="n">dask</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">multi</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pop</span><span class="p">,</span> <span class="n">nl</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;hindex&quot;</span><span class="p">),</span> <span class="n">workplace</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;hindex&quot;</span><span class="p">),</span> <span class="n">corine</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;hindex&quot;</span><span class="p">),</span> <span class="n">ndvi</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">pois</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;hindex&quot;</span><span class="p">),</span> <span class="n">water</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;hindex&quot;</span><span class="p">),</span> <span class="n">retail_centres</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;hindex&quot;</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask/dataframe/multi.py:1212: UserWarning: Concatenating dataframes with unknown divisions.
We&#39;re assuming that the indices of each dataframes are 
 aligned. This assumption is not generally safe.
  warnings.warn(
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">function</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/functional/combined_raw&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Another bit</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">function</span> <span class="o">=</span> <span class="n">dask</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/functional/combined_raw&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">function</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><strong>Dask DataFrame Structure:</strong></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>hindex</th>
      <th>population</th>
      <th>night_lights</th>
      <th>A, B, D, E. Agriculture, energy and water</th>
      <th>C. Manufacturing</th>
      <th>F. Construction</th>
      <th>G, I. Distribution, hotels and restaurants</th>
      <th>H, J. Transport and communication</th>
      <th>K, L, M, N. Financial, real estate, professional and administrative activities</th>
      <th>O,P,Q. Public administration, education and health</th>
      <th>R, S, T, U. Other</th>
      <th>Code_18_124</th>
      <th>Code_18_211</th>
      <th>Code_18_121</th>
      <th>Code_18_421</th>
      <th>Code_18_522</th>
      <th>Code_18_142</th>
      <th>Code_18_141</th>
      <th>Code_18_112</th>
      <th>Code_18_231</th>
      <th>Code_18_311</th>
      <th>Code_18_131</th>
      <th>Code_18_123</th>
      <th>Code_18_122</th>
      <th>Code_18_512</th>
      <th>Code_18_243</th>
      <th>Code_18_313</th>
      <th>Code_18_412</th>
      <th>Code_18_321</th>
      <th>Code_18_322</th>
      <th>Code_18_324</th>
      <th>Code_18_111</th>
      <th>Code_18_423</th>
      <th>Code_18_523</th>
      <th>Code_18_133</th>
      <th>Code_18_334</th>
      <th>Code_18_132</th>
      <th>Code_18_242</th>
      <th>Code_18_411</th>
      <th>Code_18_511</th>
      <th>Code_18_312</th>
      <th>Code_18_332</th>
      <th>Code_18_521</th>
      <th>Code_18_331</th>
      <th>Code_18_244</th>
      <th>Code_18_333</th>
      <th>Code_18_222</th>
      <th>mean</th>
      <th>supermarkets_nearest</th>
      <th>supermarkets_counts</th>
      <th>listed_nearest</th>
      <th>listed_counts</th>
      <th>fhrs_nearest</th>
      <th>fhrs_counts</th>
      <th>culture_nearest</th>
      <th>culture_counts</th>
      <th>nearest_water</th>
      <th>nearest_retail_centre</th>
    </tr>
    <tr>
      <th>npartitions=103</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th></th>
      <td>object</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
      <td>float64</td>
      <td>float64</td>
      <td>int64</td>
      <td>float64</td>
      <td>int64</td>
      <td>float64</td>
      <td>int64</td>
      <td>float64</td>
      <td>int64</td>
      <td>float64</td>
      <td>float64</td>
    </tr>
    <tr>
      <th></th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th></th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th></th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
  </tbody>
</table>
</div>
<div>Dask Name: read-parquet, 103 tasks</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">form</span> <span class="o">=</span> <span class="n">dask</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/morphometrics/cells/cells_*.pq&quot;</span><span class="p">)</span>
<span class="n">form</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><strong>Dask DataFrame Structure:</strong></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>hindex</th>
      <th>tessellation</th>
      <th>buildings</th>
      <th>sdbAre</th>
      <th>sdbPer</th>
      <th>sdbCoA</th>
      <th>ssbCCo</th>
      <th>ssbCor</th>
      <th>ssbSqu</th>
      <th>ssbERI</th>
      <th>ssbElo</th>
      <th>ssbCCM</th>
      <th>ssbCCD</th>
      <th>stbOri</th>
      <th>sdcLAL</th>
      <th>sdcAre</th>
      <th>sscCCo</th>
      <th>sscERI</th>
      <th>stcOri</th>
      <th>sicCAR</th>
      <th>stbCeA</th>
      <th>mtbAli</th>
      <th>mtbNDi</th>
      <th>mtcWNe</th>
      <th>mdcAre</th>
      <th>ltcWRE</th>
      <th>ltbIBD</th>
      <th>nodeID</th>
      <th>sdsSPW</th>
      <th>sdsSWD</th>
      <th>sdsSPO</th>
      <th>sdsLen</th>
      <th>sssLin</th>
      <th>ldsMSL</th>
      <th>mtdDeg</th>
      <th>lcdMes</th>
      <th>linP3W</th>
      <th>linP4W</th>
      <th>linPDE</th>
      <th>lcnClo</th>
      <th>ldsCDL</th>
      <th>xcnSCl</th>
      <th>mtdMDi</th>
      <th>lddNDe</th>
      <th>linWID</th>
      <th>edgeID_keys</th>
      <th>edgeID_values</th>
      <th>edgeID_primary</th>
      <th>stbSAl</th>
      <th>sddAre</th>
      <th>sdsAre</th>
      <th>sisBpM</th>
      <th>misCel</th>
      <th>mdsAre</th>
      <th>lisCel</th>
      <th>ldsAre</th>
      <th>ltcRea</th>
      <th>ltcAre</th>
      <th>ldeAre</th>
      <th>ldePer</th>
      <th>lseCCo</th>
      <th>lseERI</th>
      <th>lseCWA</th>
      <th>lteOri</th>
      <th>lteWNB</th>
      <th>lieWCe</th>
    </tr>
    <tr>
      <th>npartitions=103</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th></th>
      <td>object</td>
      <td>object</td>
      <td>object</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>int64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>int64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>object</td>
      <td>object</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>int64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
    </tr>
    <tr>
      <th></th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th></th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th></th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
  </tbody>
</table>
</div>
<div>Dask Name: read-parquet, 103 tasks</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">form</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;tessellation&quot;</span><span class="p">,</span> <span class="s2">&quot;buildings&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;hindex&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">data</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/data_combined_raw&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>distributed.nanny - WARNING - Worker process still alive after 3 seconds, killing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 7min 38s, sys: 44.6 s, total: 8min 23s
Wall time: 37min 11s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">dask</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/data_combined_raw&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged</span> <span class="o">=</span> <span class="n">joined</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;hindex&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>With all data merged together, we can create summaries using groupby.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">per_geometry</span> <span class="o">=</span> <span class="n">merged</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;hindex&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">per_type</span> <span class="o">=</span> <span class="n">merged</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;hindex&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">per_type</span><span class="p">,</span> <span class="n">per_geometry</span> <span class="o">=</span> <span class="n">dask</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">per_type</span><span class="p">,</span> <span class="n">per_geometry</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 1min 1s, sys: 5.53 s, total: 1min 7s
Wall time: 3min 42s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">per_type</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sdbAre</th>
      <th>sdbPer</th>
      <th>sdbCoA</th>
      <th>ssbCCo</th>
      <th>ssbCor</th>
      <th>ssbSqu</th>
      <th>ssbERI</th>
      <th>ssbElo</th>
      <th>ssbCCM</th>
      <th>ssbCCD</th>
      <th>...</th>
      <th>supermarkets_nearest</th>
      <th>supermarkets_counts</th>
      <th>listed_nearest</th>
      <th>listed_counts</th>
      <th>fhrs_nearest</th>
      <th>fhrs_counts</th>
      <th>culture_nearest</th>
      <th>culture_counts</th>
      <th>nearest_water</th>
      <th>nearest_retail_centre</th>
    </tr>
    <tr>
      <th>type</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Accessible suburbia</th>
      <td>176.949135</td>
      <td>53.902697</td>
      <td>0.476838</td>
      <td>0.534856</td>
      <td>4.253845</td>
      <td>0.775272</td>
      <td>0.987707</td>
      <td>0.642271</td>
      <td>9.604873</td>
      <td>0.364329</td>
      <td>...</td>
      <td>828.822261</td>
      <td>1.890519</td>
      <td>744.223994</td>
      <td>11.273578</td>
      <td>218.460768</td>
      <td>334.434991</td>
      <td>5384.638746</td>
      <td>0.059113</td>
      <td>542.613661</td>
      <td>849.447871</td>
    </tr>
    <tr>
      <th>Connected residential neighbourhoods</th>
      <td>272.522220</td>
      <td>69.119967</td>
      <td>1.069872</td>
      <td>0.480941</td>
      <td>4.445515</td>
      <td>1.466426</td>
      <td>0.979415</td>
      <td>0.555468</td>
      <td>12.406840</td>
      <td>0.707494</td>
      <td>...</td>
      <td>679.958940</td>
      <td>2.855980</td>
      <td>596.613654</td>
      <td>24.279146</td>
      <td>152.479922</td>
      <td>692.664050</td>
      <td>3946.052517</td>
      <td>0.129197</td>
      <td>555.964942</td>
      <td>536.469155</td>
    </tr>
    <tr>
      <th>Countryside agriculture</th>
      <td>204.100400</td>
      <td>56.048984</td>
      <td>0.505831</td>
      <td>0.506275</td>
      <td>4.371156</td>
      <td>0.809087</td>
      <td>0.977789</td>
      <td>0.600065</td>
      <td>9.791869</td>
      <td>0.556915</td>
      <td>...</td>
      <td>4751.226429</td>
      <td>0.089042</td>
      <td>557.936276</td>
      <td>11.223066</td>
      <td>725.690643</td>
      <td>44.465529</td>
      <td>13156.203765</td>
      <td>0.003804</td>
      <td>304.488181</td>
      <td>4943.972107</td>
    </tr>
    <tr>
      <th>Dense residential neighbourhoods</th>
      <td>375.598290</td>
      <td>80.558473</td>
      <td>2.127340</td>
      <td>0.472554</td>
      <td>4.694714</td>
      <td>1.863620</td>
      <td>0.969912</td>
      <td>0.557054</td>
      <td>13.961420</td>
      <td>1.070784</td>
      <td>...</td>
      <td>661.765594</td>
      <td>3.127412</td>
      <td>506.614715</td>
      <td>37.474705</td>
      <td>144.021617</td>
      <td>860.927102</td>
      <td>3497.511181</td>
      <td>0.259194</td>
      <td>483.124139</td>
      <td>421.093530</td>
    </tr>
    <tr>
      <th>Dense urban neighbourhoods</th>
      <td>588.359559</td>
      <td>107.362849</td>
      <td>5.034084</td>
      <td>0.435714</td>
      <td>5.208242</td>
      <td>3.278419</td>
      <td>0.950431</td>
      <td>0.519821</td>
      <td>17.999101</td>
      <td>1.877968</td>
      <td>...</td>
      <td>587.276810</td>
      <td>4.436632</td>
      <td>350.890339</td>
      <td>62.783422</td>
      <td>106.084358</td>
      <td>1568.443597</td>
      <td>2287.432199</td>
      <td>0.476118</td>
      <td>528.850109</td>
      <td>224.326713</td>
    </tr>
    <tr>
      <th>Disconnected suburbia</th>
      <td>212.713958</td>
      <td>61.631662</td>
      <td>0.519372</td>
      <td>0.491588</td>
      <td>4.347900</td>
      <td>1.019293</td>
      <td>0.981779</td>
      <td>0.573786</td>
      <td>11.114826</td>
      <td>0.539407</td>
      <td>...</td>
      <td>761.858373</td>
      <td>2.067315</td>
      <td>729.608517</td>
      <td>24.181257</td>
      <td>217.945624</td>
      <td>342.081722</td>
      <td>5831.523433</td>
      <td>0.077958</td>
      <td>523.050240</td>
      <td>725.573382</td>
    </tr>
    <tr>
      <th>Distilled urbanity</th>
      <td>3713.379427</td>
      <td>376.300388</td>
      <td>159.087608</td>
      <td>0.425186</td>
      <td>12.484667</td>
      <td>18.589482</td>
      <td>0.776950</td>
      <td>0.594314</td>
      <td>35.927794</td>
      <td>9.034682</td>
      <td>...</td>
      <td>229.903096</td>
      <td>22.510563</td>
      <td>31.732228</td>
      <td>685.156338</td>
      <td>16.219050</td>
      <td>6297.607746</td>
      <td>702.750880</td>
      <td>10.392254</td>
      <td>565.248203</td>
      <td>29.803442</td>
    </tr>
    <tr>
      <th>Gridded residential quarters</th>
      <td>283.892607</td>
      <td>69.667245</td>
      <td>0.749026</td>
      <td>0.491754</td>
      <td>4.506685</td>
      <td>1.663151</td>
      <td>0.976842</td>
      <td>0.584548</td>
      <td>12.411805</td>
      <td>0.799002</td>
      <td>...</td>
      <td>577.683974</td>
      <td>3.409903</td>
      <td>516.197376</td>
      <td>31.771826</td>
      <td>129.244204</td>
      <td>1081.376510</td>
      <td>4094.915253</td>
      <td>0.240503</td>
      <td>522.087434</td>
      <td>445.518972</td>
    </tr>
    <tr>
      <th>Hyper distilled urbanity</th>
      <td>3358.099586</td>
      <td>330.818576</td>
      <td>90.819544</td>
      <td>0.446292</td>
      <td>9.273438</td>
      <td>22.513954</td>
      <td>0.802892</td>
      <td>0.617669</td>
      <td>37.220199</td>
      <td>7.696910</td>
      <td>...</td>
      <td>324.416312</td>
      <td>18.791045</td>
      <td>69.749236</td>
      <td>1142.567164</td>
      <td>14.101269</td>
      <td>9213.145522</td>
      <td>351.325110</td>
      <td>34.197761</td>
      <td>759.604208</td>
      <td>32.544669</td>
    </tr>
    <tr>
      <th>Local urbanity</th>
      <td>823.354285</td>
      <td>135.543919</td>
      <td>12.666729</td>
      <td>0.409310</td>
      <td>6.014239</td>
      <td>5.071848</td>
      <td>0.919085</td>
      <td>0.506415</td>
      <td>20.711500</td>
      <td>2.976781</td>
      <td>...</td>
      <td>483.017862</td>
      <td>6.848327</td>
      <td>216.858599</td>
      <td>140.031073</td>
      <td>82.468961</td>
      <td>2167.909991</td>
      <td>1273.226897</td>
      <td>1.129622</td>
      <td>507.706457</td>
      <td>161.854989</td>
    </tr>
    <tr>
      <th>Metropolitan urbanity</th>
      <td>2413.938716</td>
      <td>283.935149</td>
      <td>118.946949</td>
      <td>0.395862</td>
      <td>9.717504</td>
      <td>12.406894</td>
      <td>0.820142</td>
      <td>0.527758</td>
      <td>29.677259</td>
      <td>6.780030</td>
      <td>...</td>
      <td>299.930496</td>
      <td>17.271958</td>
      <td>51.874364</td>
      <td>456.529630</td>
      <td>40.063982</td>
      <td>4490.949206</td>
      <td>644.531259</td>
      <td>4.446825</td>
      <td>467.713631</td>
      <td>66.318054</td>
    </tr>
    <tr>
      <th>Open sprawl</th>
      <td>226.715098</td>
      <td>59.639780</td>
      <td>0.900478</td>
      <td>0.518531</td>
      <td>4.371939</td>
      <td>0.985729</td>
      <td>0.982452</td>
      <td>0.622301</td>
      <td>10.488328</td>
      <td>0.547552</td>
      <td>...</td>
      <td>948.025914</td>
      <td>1.469023</td>
      <td>760.257254</td>
      <td>18.171441</td>
      <td>267.238602</td>
      <td>253.875226</td>
      <td>6309.753341</td>
      <td>0.061560</td>
      <td>378.356187</td>
      <td>1002.663064</td>
    </tr>
    <tr>
      <th>Regional urbanity</th>
      <td>1480.260902</td>
      <td>195.978660</td>
      <td>43.190998</td>
      <td>0.393035</td>
      <td>7.776863</td>
      <td>8.844805</td>
      <td>0.869514</td>
      <td>0.512959</td>
      <td>25.254583</td>
      <td>4.980199</td>
      <td>...</td>
      <td>331.067781</td>
      <td>12.531123</td>
      <td>115.004786</td>
      <td>324.500752</td>
      <td>56.865240</td>
      <td>3163.829678</td>
      <td>850.254487</td>
      <td>2.233070</td>
      <td>461.415859</td>
      <td>90.874497</td>
    </tr>
    <tr>
      <th>Urban buffer</th>
      <td>209.421858</td>
      <td>55.941702</td>
      <td>0.743395</td>
      <td>0.523632</td>
      <td>4.340540</td>
      <td>0.859973</td>
      <td>0.982904</td>
      <td>0.630125</td>
      <td>9.808575</td>
      <td>0.492953</td>
      <td>...</td>
      <td>1752.873479</td>
      <td>0.654018</td>
      <td>673.931399</td>
      <td>16.138833</td>
      <td>379.169823</td>
      <td>132.661846</td>
      <td>8939.647136</td>
      <td>0.024052</td>
      <td>345.790747</td>
      <td>2102.455609</td>
    </tr>
    <tr>
      <th>Warehouse land</th>
      <td>393.216097</td>
      <td>75.680270</td>
      <td>3.263039</td>
      <td>0.469466</td>
      <td>4.564890</td>
      <td>1.352536</td>
      <td>0.976102</td>
      <td>0.542256</td>
      <td>13.200176</td>
      <td>0.876237</td>
      <td>...</td>
      <td>1043.835409</td>
      <td>1.427596</td>
      <td>934.001152</td>
      <td>10.570084</td>
      <td>256.220805</td>
      <td>271.092537</td>
      <td>5121.469150</td>
      <td>0.058667</td>
      <td>417.431851</td>
      <td>898.174463</td>
    </tr>
    <tr>
      <th>Wild countryside</th>
      <td>209.855382</td>
      <td>57.122052</td>
      <td>0.223542</td>
      <td>0.501939</td>
      <td>4.381272</td>
      <td>0.706130</td>
      <td>0.976522</td>
      <td>0.589908</td>
      <td>9.947378</td>
      <td>0.601808</td>
      <td>...</td>
      <td>9854.123937</td>
      <td>0.028975</td>
      <td>1324.025044</td>
      <td>4.212720</td>
      <td>1699.169649</td>
      <td>33.073293</td>
      <td>20695.290665</td>
      <td>0.001680</td>
      <td>236.730324</td>
      <td>11041.324478</td>
    </tr>
    <tr>
      <th>outlier</th>
      <td>500.238760</td>
      <td>64.310418</td>
      <td>2.870285</td>
      <td>0.775186</td>
      <td>11.563107</td>
      <td>44.142680</td>
      <td>1.057249</td>
      <td>0.822132</td>
      <td>10.632181</td>
      <td>0.282117</td>
      <td>...</td>
      <td>3337.054736</td>
      <td>0.017857</td>
      <td>1795.228633</td>
      <td>1.285714</td>
      <td>2303.176980</td>
      <td>7.848214</td>
      <td>7388.413122</td>
      <td>0.000000</td>
      <td>10.618568</td>
      <td>2876.467504</td>
    </tr>
  </tbody>
</table>
<p>17 rows × 118 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">per_geometry</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sdbAre</th>
      <th>sdbPer</th>
      <th>sdbCoA</th>
      <th>ssbCCo</th>
      <th>ssbCor</th>
      <th>ssbSqu</th>
      <th>ssbERI</th>
      <th>ssbElo</th>
      <th>ssbCCM</th>
      <th>ssbCCD</th>
      <th>...</th>
      <th>supermarkets_nearest</th>
      <th>supermarkets_counts</th>
      <th>listed_nearest</th>
      <th>listed_counts</th>
      <th>fhrs_nearest</th>
      <th>fhrs_counts</th>
      <th>culture_nearest</th>
      <th>culture_counts</th>
      <th>nearest_water</th>
      <th>nearest_retail_centre</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>129.933434</td>
      <td>45.146514</td>
      <td>0.202279</td>
      <td>0.540968</td>
      <td>4.172237</td>
      <td>0.524401</td>
      <td>0.993543</td>
      <td>0.622563</td>
      <td>8.027774</td>
      <td>0.234288</td>
      <td>...</td>
      <td>1444.935973</td>
      <td>0.454774</td>
      <td>890.196235</td>
      <td>3.572864</td>
      <td>341.152792</td>
      <td>77.364322</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>136.483329</td>
      <td>93403.761607</td>
    </tr>
    <tr>
      <th>4</th>
      <td>258.461742</td>
      <td>65.650654</td>
      <td>5.278706</td>
      <td>0.500917</td>
      <td>4.376384</td>
      <td>0.558092</td>
      <td>0.975591</td>
      <td>0.571528</td>
      <td>11.094158</td>
      <td>0.675784</td>
      <td>...</td>
      <td>9034.336389</td>
      <td>0.000000</td>
      <td>736.182262</td>
      <td>1.718412</td>
      <td>642.509775</td>
      <td>126.115523</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>139.419780</td>
      <td>58846.096367</td>
    </tr>
    <tr>
      <th>9</th>
      <td>122.655396</td>
      <td>46.888304</td>
      <td>0.000000</td>
      <td>0.509570</td>
      <td>4.336957</td>
      <td>0.606492</td>
      <td>0.981817</td>
      <td>0.578105</td>
      <td>8.168939</td>
      <td>0.342824</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>112.232624</td>
      <td>4.935484</td>
      <td>309.115193</td>
      <td>61.000000</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>80.087762</td>
      <td>4762.653237</td>
    </tr>
    <tr>
      <th>11</th>
      <td>190.308946</td>
      <td>59.022824</td>
      <td>0.764543</td>
      <td>0.494519</td>
      <td>4.541985</td>
      <td>0.997673</td>
      <td>0.967397</td>
      <td>0.598092</td>
      <td>10.134862</td>
      <td>0.665047</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>281.289369</td>
      <td>8.043478</td>
      <td>198.296841</td>
      <td>4.326087</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>74.377682</td>
      <td>4378.879114</td>
    </tr>
    <tr>
      <th>14</th>
      <td>146.477816</td>
      <td>50.308964</td>
      <td>0.229756</td>
      <td>0.509439</td>
      <td>4.382090</td>
      <td>0.769455</td>
      <td>0.974591</td>
      <td>0.607979</td>
      <td>8.836870</td>
      <td>0.504590</td>
      <td>...</td>
      <td>2296.657968</td>
      <td>0.023599</td>
      <td>519.019717</td>
      <td>7.519174</td>
      <td>281.737308</td>
      <td>24.020649</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>199.544381</td>
      <td>1698.769041</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>94815</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>967.354980</td>
      <td>1.000000</td>
      <td>733.508972</td>
      <td>18.000000</td>
      <td>294.217987</td>
      <td>62.000000</td>
      <td>4342.378906</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>731.905179</td>
    </tr>
    <tr>
      <th>94853</th>
      <td>542.697500</td>
      <td>98.334230</td>
      <td>0.000000</td>
      <td>0.518628</td>
      <td>4.000000</td>
      <td>0.078285</td>
      <td>0.999855</td>
      <td>0.516309</td>
      <td>18.248347</td>
      <td>0.009636</td>
      <td>...</td>
      <td>547.687012</td>
      <td>3.000000</td>
      <td>97.226997</td>
      <td>77.000000</td>
      <td>112.362999</td>
      <td>1346.000000</td>
      <td>1062.750000</td>
      <td>1.0</td>
      <td>160.527776</td>
      <td>213.305247</td>
    </tr>
    <tr>
      <th>94892</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>457.170990</td>
      <td>5.000000</td>
      <td>0.000000</td>
      <td>515.000000</td>
      <td>38.470001</td>
      <td>2364.000000</td>
      <td>401.411011</td>
      <td>2.0</td>
      <td>410.039048</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>96021</th>
      <td>180.378400</td>
      <td>57.278130</td>
      <td>0.000000</td>
      <td>0.499708</td>
      <td>4.000000</td>
      <td>0.025284</td>
      <td>1.000037</td>
      <td>0.484826</td>
      <td>10.717266</td>
      <td>0.001857</td>
      <td>...</td>
      <td>327.584015</td>
      <td>4.000000</td>
      <td>251.115005</td>
      <td>3.000000</td>
      <td>153.737000</td>
      <td>301.000000</td>
      <td>2968.321045</td>
      <td>0.0</td>
      <td>710.912280</td>
      <td>317.166726</td>
    </tr>
    <tr>
      <th>96702</th>
      <td>54.747100</td>
      <td>29.614573</td>
      <td>0.000000</td>
      <td>0.634613</td>
      <td>4.000000</td>
      <td>0.048043</td>
      <td>1.000000</td>
      <td>0.932525</td>
      <td>5.238355</td>
      <td>0.002229</td>
      <td>...</td>
      <td>41921.593750</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>4.000000</td>
      <td>1227.026001</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>25185.139279</td>
    </tr>
  </tbody>
</table>
<p>96704 rows × 118 columns</p>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="rename-columns">
<h2>Rename columns<a class="headerlink" href="#rename-columns" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coded</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;population&#39;</span><span class="p">:</span> <span class="s1">&#39;func_population&#39;</span><span class="p">,</span>
    <span class="s1">&#39;night_lights&#39;</span><span class="p">:</span> <span class="s1">&#39;func_night_lights&#39;</span><span class="p">,</span>
    <span class="s1">&#39;A, B, D, E. Agriculture, energy and water&#39;</span><span class="p">:</span> <span class="s1">&#39;func_workplace_abde&#39;</span><span class="p">,</span>
    <span class="s1">&#39;C. Manufacturing&#39;</span><span class="p">:</span> <span class="s1">&#39;func_workplace_c&#39;</span><span class="p">,</span>
    <span class="s1">&#39;F. Construction&#39;</span><span class="p">:</span> <span class="s1">&#39;func_workplace_f&#39;</span><span class="p">,</span>
    <span class="s1">&#39;G, I. Distribution, hotels and restaurants&#39;</span><span class="p">:</span> <span class="s1">&#39;func_workplace_gi&#39;</span><span class="p">,</span>
    <span class="s1">&#39;H, J. Transport and communication&#39;</span><span class="p">:</span> <span class="s1">&#39;func_workplace_hj&#39;</span><span class="p">,</span>
    <span class="s1">&#39;K, L, M, N. Financial, real estate, professional and administrative activities&#39;</span><span class="p">:</span> <span class="s1">&#39;func_workplace_klmn&#39;</span><span class="p">,</span>
    <span class="s1">&#39;O,P,Q. Public administration, education and health&#39;</span><span class="p">:</span> <span class="s1">&#39;func_workplace_opq&#39;</span><span class="p">,</span>
    <span class="s1">&#39;R, S, T, U. Other&#39;</span><span class="p">:</span> <span class="s1">&#39;func_workplace_rstu&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_124&#39;</span><span class="p">:</span> <span class="s1">&#39;func_corine_124&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_211&#39;</span><span class="p">:</span> <span class="s1">&#39;func_corine_211&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_121&#39;</span><span class="p">:</span> <span class="s1">&#39;func_corine_121&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_421&#39;</span><span class="p">:</span> <span class="s1">&#39;func_corine_421&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_522&#39;</span><span class="p">:</span> <span class="s1">&#39;func_corine_522&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_142&#39;</span><span class="p">:</span> <span class="s1">&#39;func_corine_142&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_141&#39;</span><span class="p">:</span> <span class="s1">&#39;func_corine_141&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_112&#39;</span><span class="p">:</span> <span class="s1">&#39;func_corine_112&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_231&#39;</span><span class="p">:</span> <span class="s1">&#39;func_corine_231&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_311&#39;</span><span class="p">:</span> <span class="s1">&#39;func_corine_311&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_131&#39;</span><span class="p">:</span> <span class="s1">&#39;func_corine_131&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_123&#39;</span><span class="p">:</span> <span class="s1">&#39;func_corine_123&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_122&#39;</span><span class="p">:</span> <span class="s1">&#39;func_corine_122&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_512&#39;</span><span class="p">:</span> <span class="s1">&#39;func_corine_512&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_243&#39;</span><span class="p">:</span> <span class="s1">&#39;func_corine_243&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_313&#39;</span><span class="p">:</span> <span class="s1">&#39;func_corine_313&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_412&#39;</span><span class="p">:</span> <span class="s1">&#39;func_corine_412&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_321&#39;</span><span class="p">:</span> <span class="s1">&#39;func_corine_321&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_322&#39;</span><span class="p">:</span> <span class="s1">&#39;func_corine_322&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_324&#39;</span><span class="p">:</span> <span class="s1">&#39;func_corine_324&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_111&#39;</span><span class="p">:</span> <span class="s1">&#39;func_corine_111&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_423&#39;</span><span class="p">:</span> <span class="s1">&#39;func_corine_423&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_523&#39;</span><span class="p">:</span> <span class="s1">&#39;func_corine_523&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_312&#39;</span><span class="p">:</span> <span class="s1">&#39;func_corine_312&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_133&#39;</span><span class="p">:</span> <span class="s1">&#39;func_corine_133&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_333&#39;</span><span class="p">:</span> <span class="s1">&#39;func_corine_333&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_332&#39;</span><span class="p">:</span> <span class="s1">&#39;func_corine_332&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_411&#39;</span><span class="p">:</span> <span class="s1">&#39;func_corine_411&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_132&#39;</span><span class="p">:</span> <span class="s1">&#39;func_corine_132&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_222&#39;</span><span class="p">:</span> <span class="s1">&#39;func_corine_222&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_242&#39;</span><span class="p">:</span> <span class="s1">&#39;func_corine_242&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_331&#39;</span><span class="p">:</span> <span class="s1">&#39;func_corine_331&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_511&#39;</span><span class="p">:</span> <span class="s1">&#39;func_corine_511&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_334&#39;</span><span class="p">:</span> <span class="s1">&#39;func_corine_334&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_244&#39;</span><span class="p">:</span> <span class="s1">&#39;func_corine_244&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_521&#39;</span><span class="p">:</span> <span class="s1">&#39;func_corine_521&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mean&#39;</span><span class="p">:</span> <span class="s1">&#39;ndvi&#39;</span><span class="p">,</span>
    <span class="s1">&#39;supermarkets_nearest&#39;</span><span class="p">:</span> <span class="s1">&#39;func_supermarkets_nearest&#39;</span><span class="p">,</span>
    <span class="s1">&#39;supermarkets_counts&#39;</span><span class="p">:</span> <span class="s1">&#39;func_supermarkets_counts&#39;</span><span class="p">,</span>
    <span class="s1">&#39;listed_nearest&#39;</span><span class="p">:</span> <span class="s1">&#39;func_listed_nearest&#39;</span><span class="p">,</span>
    <span class="s1">&#39;listed_counts&#39;</span><span class="p">:</span> <span class="s1">&#39;func_listed_counts&#39;</span><span class="p">,</span>
    <span class="s1">&#39;fhrs_nearest&#39;</span><span class="p">:</span> <span class="s1">&#39;func_fhrs_nearest&#39;</span><span class="p">,</span>
    <span class="s1">&#39;fhrs_counts&#39;</span><span class="p">:</span> <span class="s1">&#39;func_fhrs_counts&#39;</span><span class="p">,</span>
    <span class="s1">&#39;culture_nearest&#39;</span><span class="p">:</span> <span class="s1">&#39;func_culture_nearest&#39;</span><span class="p">,</span>
    <span class="s1">&#39;culture_counts&#39;</span><span class="p">:</span> <span class="s1">&#39;func_culture_counts&#39;</span><span class="p">,</span>
    <span class="s1">&#39;nearest_water&#39;</span><span class="p">:</span> <span class="s1">&#39;func_water_nearest&#39;</span><span class="p">,</span>
    <span class="s1">&#39;nearest_retail_centre&#39;</span><span class="p">:</span> <span class="s1">&#39;func_retail_centrenearest&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sdbAre&#39;</span><span class="p">:</span> <span class="s1">&#39;form_sdbAre&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sdbPer&#39;</span><span class="p">:</span> <span class="s1">&#39;form_sdbPer&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sdbCoA&#39;</span><span class="p">:</span> <span class="s1">&#39;form_sdbCoA&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ssbCCo&#39;</span><span class="p">:</span> <span class="s1">&#39;form_ssbCCo&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ssbCor&#39;</span><span class="p">:</span> <span class="s1">&#39;form_ssbCor&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ssbSqu&#39;</span><span class="p">:</span> <span class="s1">&#39;form_ssbSqu&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ssbERI&#39;</span><span class="p">:</span> <span class="s1">&#39;form_ssbERI&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ssbElo&#39;</span><span class="p">:</span> <span class="s1">&#39;form_ssbElo&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ssbCCM&#39;</span><span class="p">:</span> <span class="s1">&#39;form_ssbCCM&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ssbCCD&#39;</span><span class="p">:</span> <span class="s1">&#39;form_ssbCCD&#39;</span><span class="p">,</span>
    <span class="s1">&#39;stbOri&#39;</span><span class="p">:</span> <span class="s1">&#39;form_stbOri&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sdcLAL&#39;</span><span class="p">:</span> <span class="s1">&#39;form_sdcLAL&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sdcAre&#39;</span><span class="p">:</span> <span class="s1">&#39;form_sdcAre&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sscCCo&#39;</span><span class="p">:</span> <span class="s1">&#39;form_sscCCo&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sscERI&#39;</span><span class="p">:</span> <span class="s1">&#39;form_sscERI&#39;</span><span class="p">,</span>
    <span class="s1">&#39;stcOri&#39;</span><span class="p">:</span> <span class="s1">&#39;form_stcOri&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sicCAR&#39;</span><span class="p">:</span> <span class="s1">&#39;form_sicCAR&#39;</span><span class="p">,</span>
    <span class="s1">&#39;stbCeA&#39;</span><span class="p">:</span> <span class="s1">&#39;form_stbCeA&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mtbAli&#39;</span><span class="p">:</span> <span class="s1">&#39;form_mtbAli&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mtbNDi&#39;</span><span class="p">:</span> <span class="s1">&#39;form_mtbNDi&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mtcWNe&#39;</span><span class="p">:</span> <span class="s1">&#39;form_mtcWNe&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mdcAre&#39;</span><span class="p">:</span> <span class="s1">&#39;form_mdcAre&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ltcWRE&#39;</span><span class="p">:</span> <span class="s1">&#39;form_ltcWRE&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ltbIBD&#39;</span><span class="p">:</span> <span class="s1">&#39;form_ltbIBD&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sdsSPW&#39;</span><span class="p">:</span> <span class="s1">&#39;form_sdsSPW&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sdsSWD&#39;</span><span class="p">:</span> <span class="s1">&#39;form_sdsSWD&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sdsSPO&#39;</span><span class="p">:</span> <span class="s1">&#39;form_sdsSPO&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sdsLen&#39;</span><span class="p">:</span> <span class="s1">&#39;form_sdsLen&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sssLin&#39;</span><span class="p">:</span> <span class="s1">&#39;form_sssLin&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ldsMSL&#39;</span><span class="p">:</span> <span class="s1">&#39;form_ldsMSL&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mtdDeg&#39;</span><span class="p">:</span> <span class="s1">&#39;form_mtdDeg&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lcdMes&#39;</span><span class="p">:</span> <span class="s1">&#39;form_lcdMes&#39;</span><span class="p">,</span>
    <span class="s1">&#39;linP3W&#39;</span><span class="p">:</span> <span class="s1">&#39;form_linP3W&#39;</span><span class="p">,</span>
    <span class="s1">&#39;linP4W&#39;</span><span class="p">:</span> <span class="s1">&#39;form_linP4W&#39;</span><span class="p">,</span>
    <span class="s1">&#39;linPDE&#39;</span><span class="p">:</span> <span class="s1">&#39;form_linPDE&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lcnClo&#39;</span><span class="p">:</span> <span class="s1">&#39;form_lcnClo&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ldsCDL&#39;</span><span class="p">:</span> <span class="s1">&#39;form_ldsCDL&#39;</span><span class="p">,</span>
    <span class="s1">&#39;xcnSCl&#39;</span><span class="p">:</span> <span class="s1">&#39;form_xcnSCl&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mtdMDi&#39;</span><span class="p">:</span> <span class="s1">&#39;form_mtdMDi&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lddNDe&#39;</span><span class="p">:</span> <span class="s1">&#39;form_lddNDe&#39;</span><span class="p">,</span>
    <span class="s1">&#39;linWID&#39;</span><span class="p">:</span> <span class="s1">&#39;form_linWID&#39;</span><span class="p">,</span>
    <span class="s1">&#39;stbSAl&#39;</span><span class="p">:</span> <span class="s1">&#39;form_stbSAl&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sddAre&#39;</span><span class="p">:</span> <span class="s1">&#39;form_sddAre&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sdsAre&#39;</span><span class="p">:</span> <span class="s1">&#39;form_sdsAre&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sisBpM&#39;</span><span class="p">:</span> <span class="s1">&#39;form_sisBpM&#39;</span><span class="p">,</span>
    <span class="s1">&#39;misCel&#39;</span><span class="p">:</span> <span class="s1">&#39;form_misCel&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mdsAre&#39;</span><span class="p">:</span> <span class="s1">&#39;form_mdsAre&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lisCel&#39;</span><span class="p">:</span> <span class="s1">&#39;form_lisCel&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ldsAre&#39;</span><span class="p">:</span> <span class="s1">&#39;form_ldsAre&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ltcRea&#39;</span><span class="p">:</span> <span class="s1">&#39;form_ltcRea&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ltcAre&#39;</span><span class="p">:</span> <span class="s1">&#39;form_ltcAre&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ldeAre&#39;</span><span class="p">:</span> <span class="s1">&#39;form_ldeAre&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ldePer&#39;</span><span class="p">:</span> <span class="s1">&#39;form_ldePer&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lseCCo&#39;</span><span class="p">:</span> <span class="s1">&#39;form_lseCCo&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lseERI&#39;</span><span class="p">:</span> <span class="s1">&#39;form_lseERI&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lseCWA&#39;</span><span class="p">:</span> <span class="s1">&#39;form_lseCWA&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lteOri&#39;</span><span class="p">:</span> <span class="s1">&#39;form_lteOri&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lteWNB&#39;</span><span class="p">:</span> <span class="s1">&#39;form_lteWNB&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lieWCe&#39;</span><span class="p">:</span> <span class="s1">&#39;form_lieWCe&#39;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">key</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;func_population&#39;</span><span class="p">:</span> <span class="s1">&#39;Population&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_night_lights&#39;</span><span class="p">:</span> <span class="s1">&#39;Night lights&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_workplace_abde&#39;</span><span class="p">:</span> <span class="s1">&#39;Workplace population [Agriculture, energy and water]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_workplace_c&#39;</span><span class="p">:</span> <span class="s1">&#39;Workplace population [Manufacturing]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_workplace_f&#39;</span><span class="p">:</span> <span class="s1">&#39;Workplace population [Construction]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_workplace_gi&#39;</span><span class="p">:</span> <span class="s1">&#39;Workplace population [Distribution, hotels and restaurants]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_workplace_hj&#39;</span><span class="p">:</span> <span class="s1">&#39;Workplace population [Transport and communication]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_workplace_klmn&#39;</span><span class="p">:</span> <span class="s1">&#39;Workplace population [Financial, real estate, professional and administrative activities]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_workplace_opq&#39;</span><span class="p">:</span> <span class="s1">&#39;Workplace population [Public administration, education and health]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_workplace_rstu&#39;</span><span class="p">:</span> <span class="s1">&#39;Workplace population [Other]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_corine_124&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Airports]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_corine_211&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Non-irrigated arable land]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_corine_121&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Industrial or commercial units]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_corine_421&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Salt marshes]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_corine_522&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Estuaries]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_corine_142&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Sport and leisure facilities]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_corine_141&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Green urban areas]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_corine_112&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Discontinuous urban fabric]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_corine_231&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Pastures]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_corine_311&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Broad-leaved forest]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_corine_131&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Mineral extraction sites]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_corine_123&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Port areas]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_corine_122&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Road and rail networks and associated land]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_corine_512&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Water bodies]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_corine_243&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Land principally occupied by agriculture, with significant areas of natural vegetation]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_corine_313&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Mixed forest]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_corine_412&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Peat bogs]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_corine_321&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Natural grasslands]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_corine_322&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Moors and heathland]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_corine_324&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Transitional woodland-shrub]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_corine_111&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Continuous urban fabric]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_corine_423&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Intertidal flats]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_corine_523&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Sea and ocean]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_corine_312&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Coniferous forest]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_corine_133&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Construction sites]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_corine_333&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Sparsely vegetated areas]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_corine_332&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Bare rocks]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_corine_411&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Inland marshes]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_corine_132&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Dump sites]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_corine_222&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Fruit trees and berry plantations]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_corine_242&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Complex cultivation patterns]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_corine_331&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Beaches, dunes, sands]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_corine_511&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Water courses]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_corine_334&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Burnt areas]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_corine_244&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Agro-forestry areas]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_corine_521&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Coastal lagoons]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ndvi&#39;</span><span class="p">:</span> <span class="s1">&#39;NDVI&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_supermarkets_nearest&#39;</span><span class="p">:</span> <span class="s1">&#39;Supermarkets [distance to nearest]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_supermarkets_counts&#39;</span><span class="p">:</span> <span class="s1">&#39;Supermarkets [counts within 1200m]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_listed_nearest&#39;</span><span class="p">:</span> <span class="s1">&#39;Listed buildings [distance to nearest]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_listed_counts&#39;</span><span class="p">:</span> <span class="s1">&#39;Listed buildings [counts within 1200m]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_fhrs_nearest&#39;</span><span class="p">:</span> <span class="s1">&#39;FHRS points [distance to nearest]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_fhrs_counts&#39;</span><span class="p">:</span> <span class="s1">&#39;FHRS points [counts within 1200m]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_culture_nearest&#39;</span><span class="p">:</span> <span class="s1">&#39;Cultural venues [distance to nearest]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_culture_counts&#39;</span><span class="p">:</span> <span class="s1">&#39;Cultural venues [counts within 1200m]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_water_nearest&#39;</span><span class="p">:</span> <span class="s1">&#39;Water bodies [distance to nearest]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;func_retail_centrenearest&#39;</span><span class="p">:</span> <span class="s1">&#39;Retail centres [distance to nearest]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_sdbAre&#39;</span><span class="p">:</span> <span class="s1">&#39;area of building&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_sdbPer&#39;</span><span class="p">:</span> <span class="s1">&#39;perimeter of building&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_sdbCoA&#39;</span><span class="p">:</span> <span class="s1">&#39;courtyard area of building&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_ssbCCo&#39;</span><span class="p">:</span> <span class="s1">&#39;circular compactness of building&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_ssbCor&#39;</span><span class="p">:</span> <span class="s1">&#39;corners of building&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_ssbSqu&#39;</span><span class="p">:</span> <span class="s1">&#39;squareness of building&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_ssbERI&#39;</span><span class="p">:</span> <span class="s1">&#39;equivalent rectangular index of building&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_ssbElo&#39;</span><span class="p">:</span> <span class="s1">&#39;elongation of building&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_ssbCCM&#39;</span><span class="p">:</span> <span class="s1">&#39;centroid - corner mean distance of building&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_ssbCCD&#39;</span><span class="p">:</span> <span class="s1">&#39;centroid - corner distance deviation of building&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_stbOri&#39;</span><span class="p">:</span> <span class="s1">&#39;orientation of building&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_sdcLAL&#39;</span><span class="p">:</span> <span class="s1">&#39;longest axis length of ETC&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_sdcAre&#39;</span><span class="p">:</span> <span class="s1">&#39;area of ETC&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_sscCCo&#39;</span><span class="p">:</span> <span class="s1">&#39;circular compactness of ETC&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_sscERI&#39;</span><span class="p">:</span> <span class="s1">&#39;equivalent rectangular index of ETC&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_stcOri&#39;</span><span class="p">:</span> <span class="s1">&#39;orientation of ETC&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_sicCAR&#39;</span><span class="p">:</span> <span class="s1">&#39;covered area ratio of ETC&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_stbCeA&#39;</span><span class="p">:</span> <span class="s1">&#39;cell alignment of building&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_mtbAli&#39;</span><span class="p">:</span> <span class="s1">&#39;alignment of neighbouring buildings&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_mtbNDi&#39;</span><span class="p">:</span> <span class="s1">&#39;mean distance between neighbouring buildings&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_mtcWNe&#39;</span><span class="p">:</span> <span class="s1">&#39;perimeter-weighted neighbours of ETC&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_mdcAre&#39;</span><span class="p">:</span> <span class="s1">&#39;area covered by neighbouring cells&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_ltcWRE&#39;</span><span class="p">:</span> <span class="s1">&#39;weighted reached enclosures of ETC&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_ltbIBD&#39;</span><span class="p">:</span> <span class="s1">&#39;mean inter-building distance&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_sdsSPW&#39;</span><span class="p">:</span> <span class="s1">&#39;width of street profile&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_sdsSWD&#39;</span><span class="p">:</span> <span class="s1">&#39;width deviation of street profile&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_sdsSPO&#39;</span><span class="p">:</span> <span class="s1">&#39;openness of street profile&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_sdsLen&#39;</span><span class="p">:</span> <span class="s1">&#39;length of street segment&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_sssLin&#39;</span><span class="p">:</span> <span class="s1">&#39;linearity of street segment&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_ldsMSL&#39;</span><span class="p">:</span> <span class="s1">&#39;mean segment length within 3 steps&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_mtdDeg&#39;</span><span class="p">:</span> <span class="s1">&#39;node degree of junction&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_lcdMes&#39;</span><span class="p">:</span> <span class="s1">&#39;local meshedness of street network&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_linP3W&#39;</span><span class="p">:</span> <span class="s1">&#39;local proportion of 3-way intersections of street network&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_linP4W&#39;</span><span class="p">:</span> <span class="s1">&#39;local proportion of 4-way intersections of street network&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_linPDE&#39;</span><span class="p">:</span> <span class="s1">&#39;local proportion of cul-de-sacs of street network&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_lcnClo&#39;</span><span class="p">:</span> <span class="s1">&#39;local closeness of street network&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_ldsCDL&#39;</span><span class="p">:</span> <span class="s1">&#39;local cul-de-sac length of street network&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_xcnSCl&#39;</span><span class="p">:</span> <span class="s1">&#39;square clustering of street network&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_mtdMDi&#39;</span><span class="p">:</span> <span class="s1">&#39;mean distance to neighbouring nodes of street network&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_lddNDe&#39;</span><span class="p">:</span> <span class="s1">&#39;local node density of street network&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_linWID&#39;</span><span class="p">:</span> <span class="s1">&#39;local degree weighted node density of street network&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_stbSAl&#39;</span><span class="p">:</span> <span class="s1">&#39;street alignment of building&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_sddAre&#39;</span><span class="p">:</span> <span class="s1">&#39;area covered by node-attached ETCs&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_sdsAre&#39;</span><span class="p">:</span> <span class="s1">&#39;area covered by edge-attached ETCs&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_sisBpM&#39;</span><span class="p">:</span> <span class="s1">&#39;buildings per meter of street segment&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_misCel&#39;</span><span class="p">:</span> <span class="s1">&#39;reached ETCs by neighbouring segments&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_mdsAre&#39;</span><span class="p">:</span> <span class="s1">&#39;reached area by neighbouring segments&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_lisCel&#39;</span><span class="p">:</span> <span class="s1">&#39;reached ETCs by local street network&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_ldsAre&#39;</span><span class="p">:</span> <span class="s1">&#39;reached area by local street network&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_ltcRea&#39;</span><span class="p">:</span> <span class="s1">&#39;reached ETCs by tessellation contiguity&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_ltcAre&#39;</span><span class="p">:</span> <span class="s1">&#39;reached area by tessellation contiguity&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_ldeAre&#39;</span><span class="p">:</span> <span class="s1">&#39;area of enclosure&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_ldePer&#39;</span><span class="p">:</span> <span class="s1">&#39;perimeter of enclosure&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_lseCCo&#39;</span><span class="p">:</span> <span class="s1">&#39;circular compactness of enclosure&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_lseERI&#39;</span><span class="p">:</span> <span class="s1">&#39;equivalent rectangular index of enclosure&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_lseCWA&#39;</span><span class="p">:</span> <span class="s1">&#39;compactness-weighted axis of enclosure&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_lteOri&#39;</span><span class="p">:</span> <span class="s1">&#39;orientation of enclosure&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_lteWNB&#39;</span><span class="p">:</span> <span class="s1">&#39;perimeter-weighted neighbours of enclosure&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form_lieWCe&#39;</span><span class="p">:</span> <span class="s1">&#39;area-weighted ETCs of enclosure&#39;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>Assing new column names</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">per_type</span> <span class="o">=</span> <span class="n">per_type</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">coded</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">per_type</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;outlier&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;per_type.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">per_geometry</span> <span class="o">=</span> <span class="n">per_geometry</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">coded</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">per_geometry</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;per_geometry.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pandas</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;key.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="pen-portraits-json">
<h2>Pen portraits JSON<a class="headerlink" href="#pen-portraits-json" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>
    
<span class="n">portraits</span> <span class="o">=</span><span class="p">{</span>
    <span class="s2">&quot;Wild countryside&quot;</span><span class="p">:</span> <span class="s2">&quot;In “Wild countryside”, human influence is the least intensive. This signature covers large open spaces in the countryside where no urbanisation happens apart from occasional roads, cottages, and pastures. You can find it across the Scottish Highlands, numerous national parks such as Lake District, or in the majority of Wales.&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Countryside agriculture&quot;</span><span class="p">:</span> <span class="s2">&quot;“Countryside agriculture” features much of the English countryside and displays a high degree of agriculture including both fields and pastures. There are a few buildings scattered across the area but, for the most part, it is green space.&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Urban buffer&quot;</span><span class="p">:</span> <span class="s2">&quot;“Urban buffer” can be characterised as a green belt around cities. This signature includes mostly agricultural land in the immediate adjacency of towns and cities, often including edge development. It still feels more like countryside than urban, but these signatures are much smaller compared to other countryside types.&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Open sprawl&quot;</span><span class="p">:</span> <span class="s2">&quot;“Open sprawl” represents the transition between countryside and urbanised land. It is located in the outskirts of cities or around smaller towns and is typically made up of large open space areas intertwined with different kinds of human development, from highways to smaller neighbourhoods.&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Disconnected suburbia&quot;</span><span class="p">:</span> <span class="s2">&quot;“Disconnected suburbia” includes residential developments in the outskirts of cities or even towns and villages with convoluted, disconnected street networks, low built-up and population densities, and lack of jobs and services. This signature type is entirely car-dependent.&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Accessible suburbia&quot;</span><span class="p">:</span> <span class="s2">&quot;“Accessible suburbia” covers residential development on the urban periphery with a relatively legible and connected street network, albeit less so than other more urban signature types. Areas in this signature feature low density, both in terms of population and built-up area, lack of jobs and services. For these reasons, “accessible suburbia” largely acts as dormitories.&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Warehouse/Park land&quot;</span><span class="p">:</span> <span class="s2">&quot;“Warehouse/Park land” covers predominantly industrial areas and other work-related developments made of box-like buildings with large footprints. It contains many jobs of manual nature such as manufacturing or construction, and very little population live here compared to the rest of urban areas. Occasionally this type also covers areas of parks with large scale green open areas.&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Gridded residential quarters&quot;</span><span class="p">:</span> <span class="s2">&quot;“Gridded residential quarters” are areas with street networks forming a well-connected grid-like (high density of 4-way intersections) pattern, resulting in places with smaller blocks and higher granularity. This signature is mostly residential but includes some services and jobs, and it tends to be located away from city centres.&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Connected residential neighbourhoods&quot;</span><span class="p">:</span> <span class="s2">&quot;“Connected residential neighbourhoods” are relatively dense urban areas, both in terms of population and built-up area, that tend to be formed around well-connected street networks. They have access to services and some jobs but may be further away from city centres leading to higher dependency on cars and public transport for their residents.&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Dense residential neighbourhoods&quot;</span><span class="p">:</span> <span class="s2">&quot;A “dense residential neighbourhood” is an abundant signature often covering large parts of cities outside of their centres. It has primarily residential purpose and high population density, varied street network patterns, and some services and jobs but not in high intensity.&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Dense urban neighbourhoods&quot;</span><span class="p">:</span> <span class="s2">&quot;“Dense urban neighbourhoods” are areas of inner-city with high population and built-up density of a predominantly residential nature but with direct access to jobs and services. This signature type tends to be relatively walkable and, in the case of some towns, may even form their centres.&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Local urbanity&quot;</span><span class="p">:</span> <span class="s2">&quot;“Local urbanity” reflects town centres, outer parts of city centres or even district centres. In all cases, this signature is very much urban in essence, combining high population and built-up density, access to amenities and jobs. Yet, it is on the lower end of the hierarchy of signature types denoting urban centres with only a local significance.&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Regional urbanity&quot;</span><span class="p">:</span> <span class="s2">&quot;“Regional urbanity” captures centres of mid-size cities with regional importance such as Liverpool, Plymouth or Newcastle upon Tyne. It is often encircled by “Local urbanity” signatures and can form outer rings of city centres in large cities. It features high population density, as well as a high number of jobs and amenities within walkable distance.&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Metropolitan urbanity&quot;</span><span class="p">:</span> <span class="s2">&quot;Signature type “Metropolitan urbanity” captures the centre of the largest cities in Great Britain such as Glasgow, Birmingham or Manchester. It is characterised by a very high number of jobs in the area, high built-up density and often high population density. This type serves as the core centre of the entire metropolitan areas.&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Concentrated urbanity&quot;</span><span class="p">:</span> <span class="s2">&quot;Concentrated urbanity” is a signature type found in the city centre of London and nowhere else in Great Britain. It reflects the uniqueness of London in the British context with an extremely high number of jobs and amenities located nearby, as well as high built-up and population densities. Buildings in this signature are large and tightly packed, forming complex shapes with courtyards and little green space.&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Hyper concentrated urbanity&quot;</span><span class="p">:</span> <span class="s2">&quot;The epitome of urbanity in the British context. “Hyper concentrated urbanity” is a signature type present only in the centre of London, around the Soho district, and covering Oxford and Regent streets. This signature is the result of centuries of urban primacy, with a multitude of historical layers interwoven, very high built-up and population density, and extreme abundance of amenities, services and jobs.&quot;</span><span class="p">,</span>
<span class="p">}</span>
    
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;pen_portraits.json&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">portraits</span><span class="p">,</span> <span class="n">outfile</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="use-string-ids">
<h2>Use string IDs<a class="headerlink" href="#use-string-ids" title="Permalink to this headline">¶</a></h2>
<p>Change integer ID for string.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">signatures</span> <span class="o">=</span> <span class="n">geopandas</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/data_product/spatial_signatures_GB.gpkg&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/geopandas/geodataframe.py:577: RuntimeWarning: Sequential read of iterator was interrupted. Resetting iterator. This can negatively impact the performance.
  for feature in features_lst:
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">signatures</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>type</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Countryside agriculture</td>
      <td>POLYGON ((62220.000 798500.000, 62110.000 7985...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Countryside agriculture</td>
      <td>POLYGON ((63507.682 796515.169, 63471.097 7965...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>Countryside agriculture</td>
      <td>POLYGON ((65953.174 802246.172, 65950.620 8022...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>Countryside agriculture</td>
      <td>POLYGON ((67297.740 803435.800, 67220.289 8034...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>Countryside agriculture</td>
      <td>POLYGON ((75760.000 852670.000, 75700.000 8527...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>96699</th>
      <td>96699</td>
      <td>outlier</td>
      <td>POLYGON ((323321.005 463795.416, 323319.842 46...</td>
    </tr>
    <tr>
      <th>96700</th>
      <td>96700</td>
      <td>outlier</td>
      <td>POLYGON ((325929.840 1008792.061, 325927.377 1...</td>
    </tr>
    <tr>
      <th>96701</th>
      <td>96701</td>
      <td>outlier</td>
      <td>POLYGON ((337804.770 1013422.583, 337800.122 1...</td>
    </tr>
    <tr>
      <th>96702</th>
      <td>96702</td>
      <td>outlier</td>
      <td>POLYGON ((422304.270 1147826.990, 422296.000 1...</td>
    </tr>
    <tr>
      <th>96703</th>
      <td>96703</td>
      <td>outlier</td>
      <td>POLYGON ((525396.260 439215.480, 525360.920 43...</td>
    </tr>
  </tbody>
</table>
<p>96704 rows × 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">signatures</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Countryside agriculture&#39;, &#39;Accessible suburbia&#39;, &#39;Open sprawl&#39;,
       &#39;Wild countryside&#39;, &#39;Warehouse land&#39;,
       &#39;Gridded residential quarters&#39;, &#39;Urban buffer&#39;,
       &#39;Disconnected suburbia&#39;, &#39;Dense residential neighbourhoods&#39;,
       &#39;Connected residential neighbourhoods&#39;,
       &#39;Dense urban neighbourhoods&#39;, &#39;Local urbanity&#39;,
       &#39;Distilled urbanity&#39;, &#39;Regional urbanity&#39;, &#39;outlier&#39;,
       &#39;Metropolitan urbanity&#39;, &#39;Hyper distilled urbanity&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">type_ids</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Countryside agriculture&#39;</span><span class="p">:</span> <span class="s2">&quot;COA&quot;</span><span class="p">,</span> 
    <span class="s1">&#39;Accessible suburbia&#39;</span><span class="p">:</span> <span class="s2">&quot;ACS&quot;</span><span class="p">,</span> 
    <span class="s1">&#39;Open sprawl&#39;</span><span class="p">:</span> <span class="s2">&quot;OPS&quot;</span><span class="p">,</span>
    <span class="s1">&#39;Wild countryside&#39;</span><span class="p">:</span> <span class="s2">&quot;WIC&quot;</span><span class="p">,</span> 
    <span class="s1">&#39;Warehouse land&#39;</span><span class="p">:</span> <span class="s2">&quot;WAL&quot;</span><span class="p">,</span>
    <span class="s1">&#39;Gridded residential quarters&#39;</span><span class="p">:</span> <span class="s2">&quot;GRQ&quot;</span><span class="p">,</span> 
    <span class="s1">&#39;Urban buffer&#39;</span><span class="p">:</span> <span class="s2">&quot;URB&quot;</span><span class="p">,</span>
    <span class="s1">&#39;Disconnected suburbia&#39;</span><span class="p">:</span> <span class="s2">&quot;DIS&quot;</span><span class="p">,</span> 
    <span class="s1">&#39;Dense residential neighbourhoods&#39;</span><span class="p">:</span> <span class="s2">&quot;DRN&quot;</span><span class="p">,</span>
    <span class="s1">&#39;Connected residential neighbourhoods&#39;</span><span class="p">:</span> <span class="s2">&quot;CRN&quot;</span><span class="p">,</span>
    <span class="s1">&#39;Dense urban neighbourhoods&#39;</span><span class="p">:</span> <span class="s2">&quot;DUN&quot;</span><span class="p">,</span> 
    <span class="s1">&#39;Local urbanity&#39;</span><span class="p">:</span> <span class="s2">&quot;LOU&quot;</span><span class="p">,</span>
    <span class="s1">&#39;Distilled urbanity&#39;</span><span class="p">:</span> <span class="s2">&quot;DIU&quot;</span><span class="p">,</span> 
    <span class="s1">&#39;Regional urbanity&#39;</span><span class="p">:</span> <span class="s2">&quot;REU&quot;</span><span class="p">,</span> 
    <span class="s1">&#39;Metropolitan urbanity&#39;</span><span class="p">:</span> <span class="s2">&quot;MEU&quot;</span><span class="p">,</span> 
    <span class="s1">&#39;Hyper distilled urbanity&#39;</span><span class="p">:</span> <span class="s2">&quot;HDU&quot;</span><span class="p">,</span>
    <span class="s1">&#39;outlier&#39;</span><span class="p">:</span> <span class="s2">&quot;OUT&quot;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">string_id</span> <span class="o">=</span> <span class="n">signatures</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">signatures</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">type_ids</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">signatures</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">string_id</span>
<span class="n">signatures</span><span class="p">[</span><span class="s2">&quot;code&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">signatures</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">type_ids</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">signatures</span><span class="p">[[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;code&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;geometry&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s2">&quot;spatial_signatures_GB.gpkg&quot;</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="s2">&quot;GPKG&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">per_type</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/data_product/per_type.csv&quot;</span><span class="p">)</span>
<span class="n">per_type</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>type</th>
      <th>form_sdbAre</th>
      <th>form_sdbPer</th>
      <th>form_sdbCoA</th>
      <th>form_ssbCCo</th>
      <th>form_ssbCor</th>
      <th>form_ssbSqu</th>
      <th>form_ssbERI</th>
      <th>form_ssbElo</th>
      <th>form_ssbCCM</th>
      <th>...</th>
      <th>func_supermarkets_nearest</th>
      <th>func_supermarkets_counts</th>
      <th>func_listed_nearest</th>
      <th>func_listed_counts</th>
      <th>func_fhrs_nearest</th>
      <th>func_fhrs_counts</th>
      <th>func_culture_nearest</th>
      <th>func_culture_counts</th>
      <th>func_water_nearest</th>
      <th>func_retail_centrenearest</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Accessible suburbia</td>
      <td>176.949135</td>
      <td>53.902697</td>
      <td>0.476838</td>
      <td>0.534856</td>
      <td>4.253845</td>
      <td>0.775272</td>
      <td>0.987707</td>
      <td>0.642271</td>
      <td>9.604873</td>
      <td>...</td>
      <td>828.822261</td>
      <td>1.890519</td>
      <td>744.223994</td>
      <td>11.273578</td>
      <td>218.460768</td>
      <td>334.434991</td>
      <td>5384.638746</td>
      <td>0.059113</td>
      <td>542.613661</td>
      <td>849.447871</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Connected residential neighbourhoods</td>
      <td>272.522220</td>
      <td>69.119967</td>
      <td>1.069872</td>
      <td>0.480941</td>
      <td>4.445515</td>
      <td>1.466426</td>
      <td>0.979415</td>
      <td>0.555468</td>
      <td>12.406840</td>
      <td>...</td>
      <td>679.958940</td>
      <td>2.855980</td>
      <td>596.613654</td>
      <td>24.279146</td>
      <td>152.479922</td>
      <td>692.664050</td>
      <td>3946.052517</td>
      <td>0.129197</td>
      <td>555.964942</td>
      <td>536.469155</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Countryside agriculture</td>
      <td>204.100400</td>
      <td>56.048984</td>
      <td>0.505831</td>
      <td>0.506275</td>
      <td>4.371156</td>
      <td>0.809087</td>
      <td>0.977789</td>
      <td>0.600065</td>
      <td>9.791869</td>
      <td>...</td>
      <td>4751.226429</td>
      <td>0.089042</td>
      <td>557.936276</td>
      <td>11.223066</td>
      <td>725.690643</td>
      <td>44.465529</td>
      <td>13156.203765</td>
      <td>0.003804</td>
      <td>304.488181</td>
      <td>4943.972107</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Dense residential neighbourhoods</td>
      <td>375.598290</td>
      <td>80.558473</td>
      <td>2.127340</td>
      <td>0.472554</td>
      <td>4.694714</td>
      <td>1.863620</td>
      <td>0.969912</td>
      <td>0.557054</td>
      <td>13.961420</td>
      <td>...</td>
      <td>661.765594</td>
      <td>3.127412</td>
      <td>506.614715</td>
      <td>37.474705</td>
      <td>144.021617</td>
      <td>860.927102</td>
      <td>3497.511181</td>
      <td>0.259194</td>
      <td>483.124139</td>
      <td>421.093530</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Dense urban neighbourhoods</td>
      <td>588.359559</td>
      <td>107.362849</td>
      <td>5.034084</td>
      <td>0.435714</td>
      <td>5.208242</td>
      <td>3.278419</td>
      <td>0.950431</td>
      <td>0.519821</td>
      <td>17.999101</td>
      <td>...</td>
      <td>587.276810</td>
      <td>4.436632</td>
      <td>350.890339</td>
      <td>62.783422</td>
      <td>106.084358</td>
      <td>1568.443597</td>
      <td>2287.432199</td>
      <td>0.476118</td>
      <td>528.850109</td>
      <td>224.326713</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Disconnected suburbia</td>
      <td>212.713958</td>
      <td>61.631662</td>
      <td>0.519372</td>
      <td>0.491588</td>
      <td>4.347900</td>
      <td>1.019293</td>
      <td>0.981779</td>
      <td>0.573786</td>
      <td>11.114826</td>
      <td>...</td>
      <td>761.858373</td>
      <td>2.067315</td>
      <td>729.608517</td>
      <td>24.181257</td>
      <td>217.945624</td>
      <td>342.081722</td>
      <td>5831.523433</td>
      <td>0.077958</td>
      <td>523.050240</td>
      <td>725.573382</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Distilled urbanity</td>
      <td>3713.379427</td>
      <td>376.300388</td>
      <td>159.087608</td>
      <td>0.425186</td>
      <td>12.484667</td>
      <td>18.589482</td>
      <td>0.776950</td>
      <td>0.594314</td>
      <td>35.927794</td>
      <td>...</td>
      <td>229.903096</td>
      <td>22.510563</td>
      <td>31.732228</td>
      <td>685.156338</td>
      <td>16.219050</td>
      <td>6297.607746</td>
      <td>702.750880</td>
      <td>10.392254</td>
      <td>565.248203</td>
      <td>29.803442</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Gridded residential quarters</td>
      <td>283.892607</td>
      <td>69.667245</td>
      <td>0.749026</td>
      <td>0.491754</td>
      <td>4.506685</td>
      <td>1.663151</td>
      <td>0.976842</td>
      <td>0.584548</td>
      <td>12.411805</td>
      <td>...</td>
      <td>577.683974</td>
      <td>3.409903</td>
      <td>516.197376</td>
      <td>31.771826</td>
      <td>129.244204</td>
      <td>1081.376510</td>
      <td>4094.915253</td>
      <td>0.240503</td>
      <td>522.087434</td>
      <td>445.518972</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Hyper distilled urbanity</td>
      <td>3358.099586</td>
      <td>330.818576</td>
      <td>90.819544</td>
      <td>0.446292</td>
      <td>9.273438</td>
      <td>22.513954</td>
      <td>0.802892</td>
      <td>0.617669</td>
      <td>37.220199</td>
      <td>...</td>
      <td>324.416312</td>
      <td>18.791045</td>
      <td>69.749236</td>
      <td>1142.567164</td>
      <td>14.101269</td>
      <td>9213.145522</td>
      <td>351.325110</td>
      <td>34.197761</td>
      <td>759.604208</td>
      <td>32.544669</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Local urbanity</td>
      <td>823.354285</td>
      <td>135.543919</td>
      <td>12.666729</td>
      <td>0.409310</td>
      <td>6.014239</td>
      <td>5.071848</td>
      <td>0.919085</td>
      <td>0.506415</td>
      <td>20.711500</td>
      <td>...</td>
      <td>483.017862</td>
      <td>6.848327</td>
      <td>216.858599</td>
      <td>140.031073</td>
      <td>82.468961</td>
      <td>2167.909991</td>
      <td>1273.226897</td>
      <td>1.129622</td>
      <td>507.706457</td>
      <td>161.854989</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Metropolitan urbanity</td>
      <td>2413.938716</td>
      <td>283.935149</td>
      <td>118.946949</td>
      <td>0.395862</td>
      <td>9.717504</td>
      <td>12.406894</td>
      <td>0.820142</td>
      <td>0.527758</td>
      <td>29.677259</td>
      <td>...</td>
      <td>299.930496</td>
      <td>17.271958</td>
      <td>51.874364</td>
      <td>456.529630</td>
      <td>40.063982</td>
      <td>4490.949206</td>
      <td>644.531259</td>
      <td>4.446825</td>
      <td>467.713631</td>
      <td>66.318054</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Open sprawl</td>
      <td>226.715098</td>
      <td>59.639780</td>
      <td>0.900478</td>
      <td>0.518531</td>
      <td>4.371939</td>
      <td>0.985729</td>
      <td>0.982452</td>
      <td>0.622301</td>
      <td>10.488328</td>
      <td>...</td>
      <td>948.025914</td>
      <td>1.469023</td>
      <td>760.257254</td>
      <td>18.171441</td>
      <td>267.238602</td>
      <td>253.875226</td>
      <td>6309.753341</td>
      <td>0.061560</td>
      <td>378.356187</td>
      <td>1002.663064</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Regional urbanity</td>
      <td>1480.260902</td>
      <td>195.978660</td>
      <td>43.190998</td>
      <td>0.393035</td>
      <td>7.776863</td>
      <td>8.844805</td>
      <td>0.869514</td>
      <td>0.512959</td>
      <td>25.254583</td>
      <td>...</td>
      <td>331.067781</td>
      <td>12.531123</td>
      <td>115.004786</td>
      <td>324.500752</td>
      <td>56.865240</td>
      <td>3163.829678</td>
      <td>850.254487</td>
      <td>2.233070</td>
      <td>461.415859</td>
      <td>90.874497</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Urban buffer</td>
      <td>209.421858</td>
      <td>55.941702</td>
      <td>0.743395</td>
      <td>0.523632</td>
      <td>4.340540</td>
      <td>0.859973</td>
      <td>0.982904</td>
      <td>0.630125</td>
      <td>9.808575</td>
      <td>...</td>
      <td>1752.873479</td>
      <td>0.654018</td>
      <td>673.931399</td>
      <td>16.138833</td>
      <td>379.169823</td>
      <td>132.661846</td>
      <td>8939.647136</td>
      <td>0.024052</td>
      <td>345.790747</td>
      <td>2102.455609</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Warehouse land</td>
      <td>393.216097</td>
      <td>75.680270</td>
      <td>3.263039</td>
      <td>0.469466</td>
      <td>4.564890</td>
      <td>1.352536</td>
      <td>0.976102</td>
      <td>0.542256</td>
      <td>13.200176</td>
      <td>...</td>
      <td>1043.835409</td>
      <td>1.427596</td>
      <td>934.001152</td>
      <td>10.570084</td>
      <td>256.220805</td>
      <td>271.092537</td>
      <td>5121.469150</td>
      <td>0.058667</td>
      <td>417.431851</td>
      <td>898.174463</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Wild countryside</td>
      <td>209.855382</td>
      <td>57.122052</td>
      <td>0.223542</td>
      <td>0.501939</td>
      <td>4.381272</td>
      <td>0.706130</td>
      <td>0.976522</td>
      <td>0.589908</td>
      <td>9.947378</td>
      <td>...</td>
      <td>9854.123937</td>
      <td>0.028975</td>
      <td>1324.025044</td>
      <td>4.212720</td>
      <td>1699.169649</td>
      <td>33.073293</td>
      <td>20695.290665</td>
      <td>0.001680</td>
      <td>236.730324</td>
      <td>11041.324478</td>
    </tr>
  </tbody>
</table>
<p>16 rows × 119 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">per_type</span><span class="p">[</span><span class="s2">&quot;code&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">per_type</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">type_ids</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;code&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">per_type</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">columns</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;nodeID&quot;</span><span class="p">)</span>
<span class="n">columns</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;edgeID_primary&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">per_type</span><span class="p">[</span><span class="n">columns</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>code</th>
      <th>type</th>
      <th>form_sdbAre</th>
      <th>form_sdbPer</th>
      <th>form_sdbCoA</th>
      <th>form_ssbCCo</th>
      <th>form_ssbCor</th>
      <th>form_ssbSqu</th>
      <th>form_ssbERI</th>
      <th>form_ssbElo</th>
      <th>...</th>
      <th>func_supermarkets_nearest</th>
      <th>func_supermarkets_counts</th>
      <th>func_listed_nearest</th>
      <th>func_listed_counts</th>
      <th>func_fhrs_nearest</th>
      <th>func_fhrs_counts</th>
      <th>func_culture_nearest</th>
      <th>func_culture_counts</th>
      <th>func_water_nearest</th>
      <th>func_retail_centrenearest</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ACS</td>
      <td>Accessible suburbia</td>
      <td>176.949135</td>
      <td>53.902697</td>
      <td>0.476838</td>
      <td>0.534856</td>
      <td>4.253845</td>
      <td>0.775272</td>
      <td>0.987707</td>
      <td>0.642271</td>
      <td>...</td>
      <td>828.822261</td>
      <td>1.890519</td>
      <td>744.223994</td>
      <td>11.273578</td>
      <td>218.460768</td>
      <td>334.434991</td>
      <td>5384.638746</td>
      <td>0.059113</td>
      <td>542.613661</td>
      <td>849.447871</td>
    </tr>
    <tr>
      <th>1</th>
      <td>CRN</td>
      <td>Connected residential neighbourhoods</td>
      <td>272.522220</td>
      <td>69.119967</td>
      <td>1.069872</td>
      <td>0.480941</td>
      <td>4.445515</td>
      <td>1.466426</td>
      <td>0.979415</td>
      <td>0.555468</td>
      <td>...</td>
      <td>679.958940</td>
      <td>2.855980</td>
      <td>596.613654</td>
      <td>24.279146</td>
      <td>152.479922</td>
      <td>692.664050</td>
      <td>3946.052517</td>
      <td>0.129197</td>
      <td>555.964942</td>
      <td>536.469155</td>
    </tr>
    <tr>
      <th>2</th>
      <td>COA</td>
      <td>Countryside agriculture</td>
      <td>204.100400</td>
      <td>56.048984</td>
      <td>0.505831</td>
      <td>0.506275</td>
      <td>4.371156</td>
      <td>0.809087</td>
      <td>0.977789</td>
      <td>0.600065</td>
      <td>...</td>
      <td>4751.226429</td>
      <td>0.089042</td>
      <td>557.936276</td>
      <td>11.223066</td>
      <td>725.690643</td>
      <td>44.465529</td>
      <td>13156.203765</td>
      <td>0.003804</td>
      <td>304.488181</td>
      <td>4943.972107</td>
    </tr>
    <tr>
      <th>3</th>
      <td>DRN</td>
      <td>Dense residential neighbourhoods</td>
      <td>375.598290</td>
      <td>80.558473</td>
      <td>2.127340</td>
      <td>0.472554</td>
      <td>4.694714</td>
      <td>1.863620</td>
      <td>0.969912</td>
      <td>0.557054</td>
      <td>...</td>
      <td>661.765594</td>
      <td>3.127412</td>
      <td>506.614715</td>
      <td>37.474705</td>
      <td>144.021617</td>
      <td>860.927102</td>
      <td>3497.511181</td>
      <td>0.259194</td>
      <td>483.124139</td>
      <td>421.093530</td>
    </tr>
    <tr>
      <th>4</th>
      <td>DUN</td>
      <td>Dense urban neighbourhoods</td>
      <td>588.359559</td>
      <td>107.362849</td>
      <td>5.034084</td>
      <td>0.435714</td>
      <td>5.208242</td>
      <td>3.278419</td>
      <td>0.950431</td>
      <td>0.519821</td>
      <td>...</td>
      <td>587.276810</td>
      <td>4.436632</td>
      <td>350.890339</td>
      <td>62.783422</td>
      <td>106.084358</td>
      <td>1568.443597</td>
      <td>2287.432199</td>
      <td>0.476118</td>
      <td>528.850109</td>
      <td>224.326713</td>
    </tr>
    <tr>
      <th>5</th>
      <td>DIS</td>
      <td>Disconnected suburbia</td>
      <td>212.713958</td>
      <td>61.631662</td>
      <td>0.519372</td>
      <td>0.491588</td>
      <td>4.347900</td>
      <td>1.019293</td>
      <td>0.981779</td>
      <td>0.573786</td>
      <td>...</td>
      <td>761.858373</td>
      <td>2.067315</td>
      <td>729.608517</td>
      <td>24.181257</td>
      <td>217.945624</td>
      <td>342.081722</td>
      <td>5831.523433</td>
      <td>0.077958</td>
      <td>523.050240</td>
      <td>725.573382</td>
    </tr>
    <tr>
      <th>6</th>
      <td>DIU</td>
      <td>Distilled urbanity</td>
      <td>3713.379427</td>
      <td>376.300388</td>
      <td>159.087608</td>
      <td>0.425186</td>
      <td>12.484667</td>
      <td>18.589482</td>
      <td>0.776950</td>
      <td>0.594314</td>
      <td>...</td>
      <td>229.903096</td>
      <td>22.510563</td>
      <td>31.732228</td>
      <td>685.156338</td>
      <td>16.219050</td>
      <td>6297.607746</td>
      <td>702.750880</td>
      <td>10.392254</td>
      <td>565.248203</td>
      <td>29.803442</td>
    </tr>
    <tr>
      <th>7</th>
      <td>GRQ</td>
      <td>Gridded residential quarters</td>
      <td>283.892607</td>
      <td>69.667245</td>
      <td>0.749026</td>
      <td>0.491754</td>
      <td>4.506685</td>
      <td>1.663151</td>
      <td>0.976842</td>
      <td>0.584548</td>
      <td>...</td>
      <td>577.683974</td>
      <td>3.409903</td>
      <td>516.197376</td>
      <td>31.771826</td>
      <td>129.244204</td>
      <td>1081.376510</td>
      <td>4094.915253</td>
      <td>0.240503</td>
      <td>522.087434</td>
      <td>445.518972</td>
    </tr>
    <tr>
      <th>8</th>
      <td>HDU</td>
      <td>Hyper distilled urbanity</td>
      <td>3358.099586</td>
      <td>330.818576</td>
      <td>90.819544</td>
      <td>0.446292</td>
      <td>9.273438</td>
      <td>22.513954</td>
      <td>0.802892</td>
      <td>0.617669</td>
      <td>...</td>
      <td>324.416312</td>
      <td>18.791045</td>
      <td>69.749236</td>
      <td>1142.567164</td>
      <td>14.101269</td>
      <td>9213.145522</td>
      <td>351.325110</td>
      <td>34.197761</td>
      <td>759.604208</td>
      <td>32.544669</td>
    </tr>
    <tr>
      <th>9</th>
      <td>LOU</td>
      <td>Local urbanity</td>
      <td>823.354285</td>
      <td>135.543919</td>
      <td>12.666729</td>
      <td>0.409310</td>
      <td>6.014239</td>
      <td>5.071848</td>
      <td>0.919085</td>
      <td>0.506415</td>
      <td>...</td>
      <td>483.017862</td>
      <td>6.848327</td>
      <td>216.858599</td>
      <td>140.031073</td>
      <td>82.468961</td>
      <td>2167.909991</td>
      <td>1273.226897</td>
      <td>1.129622</td>
      <td>507.706457</td>
      <td>161.854989</td>
    </tr>
    <tr>
      <th>10</th>
      <td>MEU</td>
      <td>Metropolitan urbanity</td>
      <td>2413.938716</td>
      <td>283.935149</td>
      <td>118.946949</td>
      <td>0.395862</td>
      <td>9.717504</td>
      <td>12.406894</td>
      <td>0.820142</td>
      <td>0.527758</td>
      <td>...</td>
      <td>299.930496</td>
      <td>17.271958</td>
      <td>51.874364</td>
      <td>456.529630</td>
      <td>40.063982</td>
      <td>4490.949206</td>
      <td>644.531259</td>
      <td>4.446825</td>
      <td>467.713631</td>
      <td>66.318054</td>
    </tr>
    <tr>
      <th>11</th>
      <td>OPS</td>
      <td>Open sprawl</td>
      <td>226.715098</td>
      <td>59.639780</td>
      <td>0.900478</td>
      <td>0.518531</td>
      <td>4.371939</td>
      <td>0.985729</td>
      <td>0.982452</td>
      <td>0.622301</td>
      <td>...</td>
      <td>948.025914</td>
      <td>1.469023</td>
      <td>760.257254</td>
      <td>18.171441</td>
      <td>267.238602</td>
      <td>253.875226</td>
      <td>6309.753341</td>
      <td>0.061560</td>
      <td>378.356187</td>
      <td>1002.663064</td>
    </tr>
    <tr>
      <th>12</th>
      <td>REU</td>
      <td>Regional urbanity</td>
      <td>1480.260902</td>
      <td>195.978660</td>
      <td>43.190998</td>
      <td>0.393035</td>
      <td>7.776863</td>
      <td>8.844805</td>
      <td>0.869514</td>
      <td>0.512959</td>
      <td>...</td>
      <td>331.067781</td>
      <td>12.531123</td>
      <td>115.004786</td>
      <td>324.500752</td>
      <td>56.865240</td>
      <td>3163.829678</td>
      <td>850.254487</td>
      <td>2.233070</td>
      <td>461.415859</td>
      <td>90.874497</td>
    </tr>
    <tr>
      <th>13</th>
      <td>URB</td>
      <td>Urban buffer</td>
      <td>209.421858</td>
      <td>55.941702</td>
      <td>0.743395</td>
      <td>0.523632</td>
      <td>4.340540</td>
      <td>0.859973</td>
      <td>0.982904</td>
      <td>0.630125</td>
      <td>...</td>
      <td>1752.873479</td>
      <td>0.654018</td>
      <td>673.931399</td>
      <td>16.138833</td>
      <td>379.169823</td>
      <td>132.661846</td>
      <td>8939.647136</td>
      <td>0.024052</td>
      <td>345.790747</td>
      <td>2102.455609</td>
    </tr>
    <tr>
      <th>14</th>
      <td>WAL</td>
      <td>Warehouse land</td>
      <td>393.216097</td>
      <td>75.680270</td>
      <td>3.263039</td>
      <td>0.469466</td>
      <td>4.564890</td>
      <td>1.352536</td>
      <td>0.976102</td>
      <td>0.542256</td>
      <td>...</td>
      <td>1043.835409</td>
      <td>1.427596</td>
      <td>934.001152</td>
      <td>10.570084</td>
      <td>256.220805</td>
      <td>271.092537</td>
      <td>5121.469150</td>
      <td>0.058667</td>
      <td>417.431851</td>
      <td>898.174463</td>
    </tr>
    <tr>
      <th>15</th>
      <td>WIC</td>
      <td>Wild countryside</td>
      <td>209.855382</td>
      <td>57.122052</td>
      <td>0.223542</td>
      <td>0.501939</td>
      <td>4.381272</td>
      <td>0.706130</td>
      <td>0.976522</td>
      <td>0.589908</td>
      <td>...</td>
      <td>9854.123937</td>
      <td>0.028975</td>
      <td>1324.025044</td>
      <td>4.212720</td>
      <td>1699.169649</td>
      <td>33.073293</td>
      <td>20695.290665</td>
      <td>0.001680</td>
      <td>236.730324</td>
      <td>11041.324478</td>
    </tr>
  </tbody>
</table>
<p>16 rows × 118 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">per_type</span><span class="p">[</span><span class="n">columns</span><span class="p">]</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/data_product/per_type.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">per_geometry</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/data_product/per_geometry.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">per_geometry</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>form_sdbAre</th>
      <th>form_sdbPer</th>
      <th>form_sdbCoA</th>
      <th>form_ssbCCo</th>
      <th>form_ssbCor</th>
      <th>form_ssbSqu</th>
      <th>form_ssbERI</th>
      <th>form_ssbElo</th>
      <th>form_ssbCCM</th>
      <th>...</th>
      <th>func_supermarkets_nearest</th>
      <th>func_supermarkets_counts</th>
      <th>func_listed_nearest</th>
      <th>func_listed_counts</th>
      <th>func_fhrs_nearest</th>
      <th>func_fhrs_counts</th>
      <th>func_culture_nearest</th>
      <th>func_culture_counts</th>
      <th>func_water_nearest</th>
      <th>func_retail_centrenearest</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>129.933434</td>
      <td>45.146514</td>
      <td>0.202279</td>
      <td>0.540968</td>
      <td>4.172237</td>
      <td>0.524401</td>
      <td>0.993543</td>
      <td>0.622563</td>
      <td>8.027774</td>
      <td>...</td>
      <td>1444.935973</td>
      <td>0.454774</td>
      <td>890.196235</td>
      <td>3.572864</td>
      <td>341.152792</td>
      <td>77.364322</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>136.483329</td>
      <td>93403.761607</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>258.461742</td>
      <td>65.650654</td>
      <td>5.278706</td>
      <td>0.500917</td>
      <td>4.376384</td>
      <td>0.558092</td>
      <td>0.975591</td>
      <td>0.571528</td>
      <td>11.094158</td>
      <td>...</td>
      <td>9034.336389</td>
      <td>0.000000</td>
      <td>736.182262</td>
      <td>1.718412</td>
      <td>642.509775</td>
      <td>126.115523</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>139.419780</td>
      <td>58846.096367</td>
    </tr>
    <tr>
      <th>2</th>
      <td>9</td>
      <td>122.655396</td>
      <td>46.888304</td>
      <td>0.000000</td>
      <td>0.509570</td>
      <td>4.336957</td>
      <td>0.606492</td>
      <td>0.981817</td>
      <td>0.578105</td>
      <td>8.168939</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>112.232624</td>
      <td>4.935484</td>
      <td>309.115193</td>
      <td>61.000000</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>80.087762</td>
      <td>4762.653237</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11</td>
      <td>190.308946</td>
      <td>59.022824</td>
      <td>0.764543</td>
      <td>0.494519</td>
      <td>4.541985</td>
      <td>0.997673</td>
      <td>0.967397</td>
      <td>0.598092</td>
      <td>10.134862</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>281.289369</td>
      <td>8.043478</td>
      <td>198.296841</td>
      <td>4.326087</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>74.377682</td>
      <td>4378.879114</td>
    </tr>
    <tr>
      <th>4</th>
      <td>14</td>
      <td>146.477816</td>
      <td>50.308964</td>
      <td>0.229756</td>
      <td>0.509439</td>
      <td>4.382090</td>
      <td>0.769455</td>
      <td>0.974591</td>
      <td>0.607979</td>
      <td>8.836870</td>
      <td>...</td>
      <td>2296.657968</td>
      <td>0.023599</td>
      <td>519.019717</td>
      <td>7.519174</td>
      <td>281.737308</td>
      <td>24.020649</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>199.544381</td>
      <td>1698.769041</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>96699</th>
      <td>94815</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>967.354980</td>
      <td>1.000000</td>
      <td>733.508972</td>
      <td>18.000000</td>
      <td>294.217987</td>
      <td>62.000000</td>
      <td>4342.378906</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>731.905179</td>
    </tr>
    <tr>
      <th>96700</th>
      <td>94853</td>
      <td>542.697500</td>
      <td>98.334230</td>
      <td>0.000000</td>
      <td>0.518628</td>
      <td>4.000000</td>
      <td>0.078285</td>
      <td>0.999855</td>
      <td>0.516309</td>
      <td>18.248347</td>
      <td>...</td>
      <td>547.687012</td>
      <td>3.000000</td>
      <td>97.226997</td>
      <td>77.000000</td>
      <td>112.362999</td>
      <td>1346.000000</td>
      <td>1062.750000</td>
      <td>1.0</td>
      <td>160.527776</td>
      <td>213.305247</td>
    </tr>
    <tr>
      <th>96701</th>
      <td>94892</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>457.170990</td>
      <td>5.000000</td>
      <td>0.000000</td>
      <td>515.000000</td>
      <td>38.470001</td>
      <td>2364.000000</td>
      <td>401.411011</td>
      <td>2.0</td>
      <td>410.039048</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>96702</th>
      <td>96021</td>
      <td>180.378400</td>
      <td>57.278130</td>
      <td>0.000000</td>
      <td>0.499708</td>
      <td>4.000000</td>
      <td>0.025284</td>
      <td>1.000037</td>
      <td>0.484826</td>
      <td>10.717266</td>
      <td>...</td>
      <td>327.584015</td>
      <td>4.000000</td>
      <td>251.115005</td>
      <td>3.000000</td>
      <td>153.737000</td>
      <td>301.000000</td>
      <td>2968.321045</td>
      <td>0.0</td>
      <td>710.912280</td>
      <td>317.166726</td>
    </tr>
    <tr>
      <th>96703</th>
      <td>96702</td>
      <td>54.747100</td>
      <td>29.614573</td>
      <td>0.000000</td>
      <td>0.634613</td>
      <td>4.000000</td>
      <td>0.048043</td>
      <td>1.000000</td>
      <td>0.932525</td>
      <td>5.238355</td>
      <td>...</td>
      <td>41921.593750</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>4.000000</td>
      <td>1227.026001</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>25185.139279</td>
    </tr>
  </tbody>
</table>
<p>96704 rows × 119 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">signatures</span><span class="p">[</span><span class="s2">&quot;intid&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">signatures</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merge</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">signatures</span><span class="p">[</span><span class="s2">&quot;intid&quot;</span><span class="p">],</span> <span class="n">signatures</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">per_geometry</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">per_geometry</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">merge</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">per_geometry</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;nodeID&quot;</span><span class="p">,</span> <span class="s2">&quot;edgeID_primary&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/data_product/per_geometry.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pandas</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">type_ids</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;type_code&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/data_product/type_code.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lsoa</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/data_product/lsoa_estimates.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lsoa</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">lsoa</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lsoa</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">type_ids</span><span class="p">)[</span><span class="mi">2</span><span class="p">:])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lsoa</span><span class="p">[</span><span class="s2">&quot;primary_code&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lsoa</span><span class="p">[</span><span class="s2">&quot;primary_type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">type_ids</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lsoa</span><span class="p">[[</span><span class="s2">&quot;LSOA11CD&quot;</span><span class="p">,</span> <span class="s2">&quot;primary_code&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">lsoa</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])]</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/data_product/lsoa_estimates.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">oa</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/data_product/output_area_estimates.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">oa</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">oa</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">oa</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">type_ids</span><span class="p">)[</span><span class="mi">2</span><span class="p">:])</span>
<span class="n">oa</span><span class="p">[</span><span class="s2">&quot;primary_code&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">oa</span><span class="p">[</span><span class="s2">&quot;primary_type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">type_ids</span><span class="p">)</span>
<span class="n">oa</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>OA11CD</th>
      <th>primary_type</th>
      <th>NaN</th>
      <th>NaN</th>
      <th>NaN</th>
      <th>NaN</th>
      <th>NaN</th>
      <th>NaN</th>
      <th>NaN</th>
      <th>NaN</th>
      <th>...</th>
      <th>NaN</th>
      <th>NaN</th>
      <th>NaN</th>
      <th>NaN</th>
      <th>NaN</th>
      <th>NaN</th>
      <th>NaN</th>
      <th>NaN</th>
      <th>NaN</th>
      <th>primary_code</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>E00000001</td>
      <td>Distilled urbanity</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>DIU</td>
      <td>DIU</td>
      <td>DIU</td>
      <td>DIU</td>
    </tr>
    <tr>
      <th>1</th>
      <td>E00000003</td>
      <td>Distilled urbanity</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>DIU</td>
      <td>DIU</td>
      <td>DIU</td>
      <td>DIU</td>
    </tr>
    <tr>
      <th>2</th>
      <td>E00000005</td>
      <td>Distilled urbanity</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>DIU</td>
      <td>DIU</td>
      <td>DIU</td>
      <td>DIU</td>
    </tr>
    <tr>
      <th>3</th>
      <td>E00000007</td>
      <td>Distilled urbanity</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>DIU</td>
      <td>DIU</td>
      <td>DIU</td>
      <td>DIU</td>
    </tr>
    <tr>
      <th>4</th>
      <td>E00000010</td>
      <td>Distilled urbanity</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>DIU</td>
      <td>DIU</td>
      <td>DIU</td>
      <td>DIU</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>227754</th>
      <td>S00094726</td>
      <td>Wild countryside</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.965738</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>WIC</td>
      <td>WIC</td>
      <td>WIC</td>
      <td>WIC</td>
    </tr>
    <tr>
      <th>227755</th>
      <td>S00102583</td>
      <td>Urban buffer</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.076019</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.923981</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>URB</td>
      <td>URB</td>
      <td>URB</td>
      <td>URB</td>
    </tr>
    <tr>
      <th>227756</th>
      <td>S00119179</td>
      <td>Wild countryside</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.995102</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000594</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>WIC</td>
      <td>WIC</td>
      <td>WIC</td>
      <td>WIC</td>
    </tr>
    <tr>
      <th>227757</th>
      <td>S00119262</td>
      <td>Wild countryside</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.982881</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>WIC</td>
      <td>WIC</td>
      <td>WIC</td>
      <td>WIC</td>
    </tr>
    <tr>
      <th>227758</th>
      <td>S00126169</td>
      <td>Countryside agriculture</td>
      <td>0.999624</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000377</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>COA</td>
      <td>COA</td>
      <td>COA</td>
      <td>COA</td>
    </tr>
  </tbody>
</table>
<p>227759 rows × 23 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">oa</span> <span class="o">=</span> <span class="n">oa</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">oa</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="mi">19</span><span class="p">])</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;primary_code&quot;</span><span class="p">]]</span>
<span class="n">oa</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">oa</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">lsoa</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">oa</span><span class="p">[[</span><span class="s2">&quot;OA11CD&quot;</span><span class="p">,</span> <span class="s2">&quot;primary_code&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">oa</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])]</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/data_product/output_area_estimates.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Not needed in this notebook but it is good to have them all at one place.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">key_for_all</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;population_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Population (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;population_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Population (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;population_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Population (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;night_lights_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Night lights (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;night_lights_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Night lights (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;night_lights_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Night lights (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;A, B, D, E. Agriculture, energy and water_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Workplace population [Agriculture, energy and water] (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;A, B, D, E. Agriculture, energy and water_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Workplace population [Agriculture, energy and water] (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;A, B, D, E. Agriculture, energy and water_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Workplace population [Agriculture, energy and water] (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;C. Manufacturing_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Workplace population [Manufacturing] (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;C. Manufacturing_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Workplace population [Manufacturing] (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;C. Manufacturing_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Workplace population [Manufacturing] (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;F. Construction_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Workplace population [Construction] (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;F. Construction_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Workplace population [Construction] (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;F. Construction_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Workplace population [Construction] (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;G, I. Distribution, hotels and restaurants_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Workplace population [Distribution, hotels and restaurants] (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;G, I. Distribution, hotels and restaurants_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Workplace population [Distribution, hotels and restaurants] (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;G, I. Distribution, hotels and restaurants_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Workplace population [Distribution, hotels and restaurants] (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;H, J. Transport and communication_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Workplace population [Transport and communication] (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;H, J. Transport and communication_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Workplace population [Transport and communication] (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;H, J. Transport and communication_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Workplace population [Transport and communication] (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;K, L, M, N. Financial, real estate, professional and administrative activities_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Workplace population [Financial, real estate, professional and administrative activities] (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;K, L, M, N. Financial, real estate, professional and administrative activities_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Workplace population [Financial, real estate, professional and administrative activities] (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;K, L, M, N. Financial, real estate, professional and administrative activities_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Workplace population [Financial, real estate, professional and administrative activities] (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;O,P,Q. Public administration, education and health_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Workplace population [Public administration, education and health] (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;O,P,Q. Public administration, education and health_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Workplace population [Public administration, education and health] (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;O,P,Q. Public administration, education and health_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Workplace population [Public administration, education and health] (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;R, S, T, U. Other_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Workplace population [Other] (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;R, S, T, U. Other_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Workplace population [Other] (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;R, S, T, U. Other_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Workplace population [Other] (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_124_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Airports] (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_124_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Airports] (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_124_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Airports] (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_211_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Non-irrigated arable land] (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_211_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Non-irrigated arable land] (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_211_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Non-irrigated arable land] (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_121_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Industrial or commercial units] (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_121_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Industrial or commercial units] (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_121_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Industrial or commercial units] (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_421_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Salt marshes] (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_421_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Salt marshes] (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_421_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Salt marshes] (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_522_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Estuaries] (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_522_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Estuaries] (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_522_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Estuaries] (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_142_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Sport and leisure facilities] (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_142_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Sport and leisure facilities] (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_142_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Sport and leisure facilities] (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_141_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Green urban areas] (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_141_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Green urban areas] (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_141_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Green urban areas] (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_112_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Discontinuous urban fabric] (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_112_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Discontinuous urban fabric] (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_112_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Discontinuous urban fabric] (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_231_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Pastures] (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_231_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Pastures] (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_231_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Pastures] (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_311_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Broad-leaved forest] (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_311_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Broad-leaved forest] (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_311_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Broad-leaved forest] (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_131_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Mineral extraction sites] (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_131_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Mineral extraction sites] (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_131_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Mineral extraction sites] (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_123_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Port areas] (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_123_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Port areas] (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_123_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Port areas] (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_122_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Road and rail networks and associated land] (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_122_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Road and rail networks and associated land] (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_122_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Road and rail networks and associated land] (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_512_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Water bodies] (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_512_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Water bodies] (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_512_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Water bodies] (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_243_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Land principally occupied by agriculture, with significant areas of natural vegetation] (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_243_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Land principally occupied by agriculture, with significant areas of natural vegetation] (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_243_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Land principally occupied by agriculture, with significant areas of natural vegetation] (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_313_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Mixed forest] (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_313_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Mixed forest] (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_313_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Mixed forest] (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_412_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Peat bogs] (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_412_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Peat bogs] (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_412_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Peat bogs] (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_321_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Natural grasslands] (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_321_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Natural grasslands] (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_321_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Natural grasslands] (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_322_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Moors and heathland] (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_322_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Moors and heathland] (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_322_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Moors and heathland] (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_324_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Transitional woodland-shrub] (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_324_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Transitional woodland-shrub] (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_324_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Transitional woodland-shrub] (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_111_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Continuous urban fabric] (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_111_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Continuous urban fabric] (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_111_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Continuous urban fabric] (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_423_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Intertidal flats] (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_423_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Intertidal flats] (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_423_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Intertidal flats] (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_523_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Sea and ocean] (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_523_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Sea and ocean] (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_523_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Sea and ocean] (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_312_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Coniferous forest] (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_312_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Coniferous forest] (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_312_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Coniferous forest] (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_133_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Construction sites] (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_133_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Construction sites] (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_133_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Construction sites] (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_333_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Sparsely vegetated areas] (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_333_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Sparsely vegetated areas] (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_333_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Sparsely vegetated areas] (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_332_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Bare rocks] (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_332_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Bare rocks] (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_332_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Bare rocks] (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_411_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Inland marshes] (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_411_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Inland marshes] (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_411_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Inland marshes] (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_132_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Dump sites] (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_331_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Beaches, dunes, sands] (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_222_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Fruit trees and berry plantations] (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_511_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Water courses] (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_242_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Complex cultivation patterns] (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_511_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Water courses] (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_242_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Complex cultivation patterns] (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_331_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Beaches, dunes, sands] (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_334_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Burnt areas] (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_511_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Water courses] (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_334_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Burnt areas] (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_222_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Fruit trees and berry plantations] (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_242_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Complex cultivation patterns] (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_244_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Agro-forestry areas] (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_521_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Coastal lagoons] (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_334_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Burnt areas] (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_244_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Agro-forestry areas] (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_244_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Agro-forestry areas] (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_331_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Beaches, dunes, sands] (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_132_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Dump sites] (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_132_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Dump sites] (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_521_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Coastal lagoons] (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_222_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Fruit trees and berry plantations] (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Code_18_521_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Coastal lagoons] (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mean_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;NDVI (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mean_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;NDVI (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mean_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;NDVI (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;supermarkets_nearest&#39;</span><span class="p">:</span> <span class="s1">&#39;Supermarkets [distance to nearest]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;supermarkets_counts&#39;</span><span class="p">:</span> <span class="s1">&#39;Supermarkets [counts within 1200m]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;listed_nearest&#39;</span><span class="p">:</span> <span class="s1">&#39;Listed buildings [distance to nearest]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;listed_counts&#39;</span><span class="p">:</span> <span class="s1">&#39;Listed buildings [counts within 1200m]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;fhrs_nearest&#39;</span><span class="p">:</span> <span class="s1">&#39;FHRS points [distance to nearest]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;fhrs_counts&#39;</span><span class="p">:</span> <span class="s1">&#39;FHRS points [counts within 1200m]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;culture_nearest&#39;</span><span class="p">:</span> <span class="s1">&#39;Cultural venues [distance to nearest]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;culture_counts&#39;</span><span class="p">:</span> <span class="s1">&#39;Cultural venues [counts within 1200m]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;nearest_water&#39;</span><span class="p">:</span> <span class="s1">&#39;Water bodies [distance to nearest]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;nearest_retail_centre&#39;</span><span class="p">:</span> <span class="s1">&#39;Retail centres [distance to nearest]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sdbAre_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;area of building (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sdbAre_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;area of building (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sdbAre_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;area of building (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sdbPer_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;perimeter of building (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sdbPer_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;perimeter of building (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sdbPer_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;perimeter of building (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sdbCoA_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;courtyard area of building (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sdbCoA_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;courtyard area of building (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sdbCoA_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;courtyard area of building (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ssbCCo_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;circular compactness of building (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ssbCCo_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;circular compactness of building (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ssbCCo_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;circular compactness of building (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ssbCor_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;corners of building (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ssbCor_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;corners of building (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ssbCor_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;corners of building (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ssbSqu_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;squareness of building (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ssbSqu_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;squareness of building (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ssbSqu_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;squareness of building (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ssbERI_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;equivalent rectangular index of building (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ssbERI_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;equivalent rectangular index of building (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ssbERI_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;equivalent rectangular index of building (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ssbElo_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;elongation of building (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ssbElo_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;elongation of building (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ssbElo_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;elongation of building (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ssbCCM_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;centroid - corner mean distance of building (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ssbCCM_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;centroid - corner mean distance of building (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ssbCCM_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;centroid - corner mean distance of building (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ssbCCD_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;centroid - corner distance deviation of building (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ssbCCD_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;centroid - corner distance deviation of building (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ssbCCD_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;centroid - corner distance deviation of building (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;stbOri_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;orientation of building (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;stbOri_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;orientation of building (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;stbOri_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;orientation of building (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sdcLAL_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;longest axis length of ETC (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sdcLAL_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;longest axis length of ETC (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sdcLAL_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;longest axis length of ETC (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sdcAre_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;area of ETC (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sdcAre_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;area of ETC (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sdcAre_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;area of ETC (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sscCCo_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;circular compactness of ETC (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sscCCo_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;circular compactness of ETC (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sscCCo_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;circular compactness of ETC (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sscERI_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;equivalent rectangular index of ETC (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sscERI_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;equivalent rectangular index of ETC (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sscERI_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;equivalent rectangular index of ETC (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;stcOri_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;orientation of ETC (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;stcOri_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;orientation of ETC (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;stcOri_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;orientation of ETC (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sicCAR_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;covered area ratio of ETC (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sicCAR_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;covered area ratio of ETC (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sicCAR_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;covered area ratio of ETC (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;stbCeA_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;cell alignment of building (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;stbCeA_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;cell alignment of building (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;stbCeA_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;cell alignment of building (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mtbAli_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;alignment of neighbouring buildings (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mtbAli_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;alignment of neighbouring buildings (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mtbAli_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;alignment of neighbouring buildings (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mtbNDi_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;mean distance between neighbouring buildings (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mtbNDi_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;mean distance between neighbouring buildings (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mtbNDi_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;mean distance between neighbouring buildings (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mtcWNe_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;perimeter-weighted neighbours of ETC (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mtcWNe_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;perimeter-weighted neighbours of ETC (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mtcWNe_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;perimeter-weighted neighbours of ETC (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mdcAre_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;area covered by neighbouring cells (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mdcAre_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;area covered by neighbouring cells (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mdcAre_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;area covered by neighbouring cells (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ltcWRE_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;weighted reached enclosures of ETC (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ltcWRE_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;weighted reached enclosures of ETC (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ltcWRE_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;weighted reached enclosures of ETC (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ltbIBD_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;mean inter-building distance (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ltbIBD_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;mean inter-building distance (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ltbIBD_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;mean inter-building distance (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sdsSPW_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;width of street profile (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sdsSPW_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;width of street profile (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sdsSPW_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;width of street profile (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sdsSWD_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;width deviation of street profile (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sdsSWD_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;width deviation of street profile (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sdsSWD_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;width deviation of street profile (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sdsSPO_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;openness of street profile (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sdsSPO_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;openness of street profile (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sdsSPO_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;openness of street profile (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sdsLen_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;length of street segment (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sdsLen_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;length of street segment (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sdsLen_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;length of street segment (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sssLin_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;linearity of street segment (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sssLin_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;linearity of street segment (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sssLin_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;linearity of street segment (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ldsMSL_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;mean segment length within 3 steps (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ldsMSL_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;mean segment length within 3 steps (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ldsMSL_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;mean segment length within 3 steps (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mtdDeg_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;node degree of junction (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mtdDeg_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;node degree of junction (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mtdDeg_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;node degree of junction (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lcdMes_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;local meshedness of street network (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lcdMes_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;local meshedness of street network (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lcdMes_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;local meshedness of street network (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;linP3W_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;local proportion of 3-way intersections of street network (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;linP3W_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;local proportion of 3-way intersections of street network (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;linP3W_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;local proportion of 3-way intersections of street network (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;linP4W_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;local proportion of 4-way intersections of street network (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;linP4W_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;local proportion of 4-way intersections of street network (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;linP4W_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;local proportion of 4-way intersections of street network (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;linPDE_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;local proportion of cul-de-sacs of street network (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;linPDE_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;local proportion of cul-de-sacs of street network (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;linPDE_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;local proportion of cul-de-sacs of street network (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lcnClo_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;local closeness of street network (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lcnClo_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;local closeness of street network (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lcnClo_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;local closeness of street network (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ldsCDL_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;local cul-de-sac length of street network (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ldsCDL_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;local cul-de-sac length of street network (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ldsCDL_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;local cul-de-sac length of street network (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;xcnSCl_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;square clustering of street network (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;xcnSCl_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;square clustering of street network (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;xcnSCl_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;square clustering of street network (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mtdMDi_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;mean distance to neighbouring nodes of street network (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mtdMDi_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;mean distance to neighbouring nodes of street network (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mtdMDi_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;mean distance to neighbouring nodes of street network (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lddNDe_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;local node density of street network (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lddNDe_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;local node density of street network (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lddNDe_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;local node density of street network (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;linWID_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;local degree weighted node density of street network (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;linWID_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;local degree weighted node density of street network (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;linWID_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;local degree weighted node density of street network (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;stbSAl_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;street alignment of building (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;stbSAl_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;street alignment of building (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;stbSAl_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;street alignment of building (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sddAre_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;area covered by node-attached ETCs (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sddAre_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;area covered by node-attached ETCs (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sddAre_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;area covered by node-attached ETCs (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sdsAre_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;area covered by edge-attached ETCs (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sdsAre_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;area covered by edge-attached ETCs (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sdsAre_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;area covered by edge-attached ETCs (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sisBpM_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;buildings per meter of street segment (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sisBpM_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;buildings per meter of street segment (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sisBpM_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;buildings per meter of street segment (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;misCel_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;reached ETCs by neighbouring segments (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;misCel_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;reached ETCs by neighbouring segments (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;misCel_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;reached ETCs by neighbouring segments (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mdsAre_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;reached area by neighbouring segments (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mdsAre_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;reached area by neighbouring segments (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mdsAre_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;reached area by neighbouring segments (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lisCel_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;reached ETCs by local street network (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lisCel_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;reached ETCs by local street network (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lisCel_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;reached ETCs by local street network (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ldsAre_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;reached area by local street network (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ldsAre_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;reached area by local street network (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ldsAre_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;reached area by local street network (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ltcRea_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;reached ETCs by tessellation contiguity (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ltcRea_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;reached ETCs by tessellation contiguity (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ltcRea_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;reached ETCs by tessellation contiguity (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ltcAre_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;reached area by tessellation contiguity (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ltcAre_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;reached area by tessellation contiguity (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ltcAre_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;reached area by tessellation contiguity (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ldeAre_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;area of enclosure (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ldeAre_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;area of enclosure (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ldeAre_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;area of enclosure (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ldePer_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;perimeter of enclosure (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ldePer_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;perimeter of enclosure (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ldePer_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;perimeter of enclosure (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lseCCo_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;circular compactness of enclosure (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lseCCo_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;circular compactness of enclosure (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lseCCo_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;circular compactness of enclosure (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lseERI_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;equivalent rectangular index of enclosure (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lseERI_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;equivalent rectangular index of enclosure (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lseERI_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;equivalent rectangular index of enclosure (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lseCWA_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;compactness-weighted axis of enclosure (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lseCWA_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;compactness-weighted axis of enclosure (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lseCWA_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;compactness-weighted axis of enclosure (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lteOri_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;orientation of enclosure (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lteOri_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;orientation of enclosure (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lteOri_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;orientation of enclosure (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lteWNB_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;perimeter-weighted neighbours of enclosure (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lteWNB_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;perimeter-weighted neighbours of enclosure (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lteWNB_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;perimeter-weighted neighbours of enclosure (Q3)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lieWCe_q1&#39;</span><span class="p">:</span> <span class="s1">&#39;area-weighted ETCs of enclosure (Q1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lieWCe_q2&#39;</span><span class="p">:</span> <span class="s1">&#39;area-weighted ETCs of enclosure (Q2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lieWCe_q3&#39;</span><span class="p">:</span> <span class="s1">&#39;area-weighted ETCs of enclosure (Q3)&#39;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="dump-etcs-to-an-archive-repository-as-a-partitioned-parquet">
<h2>Dump ETCs to an archive repository as a partitioned parquet<a class="headerlink" href="#dump-etcs-to-an-archive-repository-as-a-partitioned-parquet" title="Permalink to this headline">¶</a></h2>
<p>Create partitioned ETC-level datasets to be stored in an archival GitHub repository.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dask.distributed</span> <span class="kn">import</span> <span class="n">Client</span><span class="p">,</span> <span class="n">LocalCluster</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">LocalCluster</span><span class="p">(</span><span class="n">n_workers</span><span class="o">=</span><span class="mi">8</span><span class="p">))</span>
<span class="n">client</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
    <div style="width: 24px; height: 24px; background-color: #e1e1e1; border: 3px solid #9D9D9D; border-radius: 5px; position: absolute;"> </div>
    <div style="margin-left: 48px;">
        <h3 style="margin-bottom: 0px;">Client</h3>
        <p style="color: #9D9D9D; margin-bottom: 0px;">Client-8c657e0b-94bf-11ec-840d-115a56b33b25</p>
        <table style="width: 100%; text-align: left;">

        <tr>

            <td style="text-align: left;"><strong>Connection method:</strong> Cluster object</td>
            <td style="text-align: left;"><strong>Cluster type:</strong> distributed.LocalCluster</td>

        </tr>


            <tr>
                <td style="text-align: left;">
                    <strong>Dashboard: </strong> <a href="http://127.0.0.1:8787/status" target="_blank">http://127.0.0.1:8787/status</a>
                </td>
                <td style="text-align: left;"></td>
            </tr>


        </table>


            <details>
            <summary style="margin-bottom: 20px;"><h3 style="display: inline;">Cluster Info</h3></summary>
            <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-mod-trusted jp-OutputArea-output">
    <div style="width: 24px; height: 24px; background-color: #e1e1e1; border: 3px solid #9D9D9D; border-radius: 5px; position: absolute;">
    </div>
    <div style="margin-left: 48px;">
        <h3 style="margin-bottom: 0px; margin-top: 0px;">LocalCluster</h3>
        <p style="color: #9D9D9D; margin-bottom: 0px;">077353cd</p>
        <table style="width: 100%; text-align: left;">
            <tr>
                <td style="text-align: left;">
                    <strong>Dashboard:</strong> <a href="http://127.0.0.1:8787/status" target="_blank">http://127.0.0.1:8787/status</a>
                </td>
                <td style="text-align: left;">
                    <strong>Workers:</strong> 8
                </td>
            </tr>
            <tr>
                <td style="text-align: left;">
                    <strong>Total threads:</strong> 16
                </td>
                <td style="text-align: left;">
                    <strong>Total memory:</strong> 125.54 GiB
                </td>
            </tr>

            <tr>
    <td style="text-align: left;"><strong>Status:</strong> running</td>
    <td style="text-align: left;"><strong>Using processes:</strong> True</td>
</tr>


        </table>

        <details>
            <summary style="margin-bottom: 20px;">
                <h3 style="display: inline;">Scheduler Info</h3>
            </summary>

            <div style="">
    <div>
        <div style="width: 24px; height: 24px; background-color: #FFF7E5; border: 3px solid #FF6132; border-radius: 5px; position: absolute;"> </div>
        <div style="margin-left: 48px;">
            <h3 style="margin-bottom: 0px;">Scheduler</h3>
            <p style="color: #9D9D9D; margin-bottom: 0px;">Scheduler-6c5cf5f9-8b46-49f3-92f3-a146dc26f205</p>
            <table style="width: 100%; text-align: left;">
                <tr>
                    <td style="text-align: left;">
                        <strong>Comm:</strong> tcp://127.0.0.1:41533
                    </td>
                    <td style="text-align: left;">
                        <strong>Workers:</strong> 8
                    </td>
                </tr>
                <tr>
                    <td style="text-align: left;">
                        <strong>Dashboard:</strong> <a href="http://127.0.0.1:8787/status" target="_blank">http://127.0.0.1:8787/status</a>
                    </td>
                    <td style="text-align: left;">
                        <strong>Total threads:</strong> 16
                    </td>
                </tr>
                <tr>
                    <td style="text-align: left;">
                        <strong>Started:</strong> Just now
                    </td>
                    <td style="text-align: left;">
                        <strong>Total memory:</strong> 125.54 GiB
                    </td>
                </tr>
            </table>
        </div>
    </div>

    <details style="margin-left: 48px;">
        <summary style="margin-bottom: 20px;">
            <h3 style="display: inline;">Workers</h3>
        </summary>


        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 0</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:45761
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 2
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="http://127.0.0.1:45937/status" target="_blank">http://127.0.0.1:45937/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 15.69 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:46555
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /home/jovyan/work/spatial_signatures/data_product/dask-worker-space/worker-bi7gc9f7
                        </td>
                    </tr>





                </table>
            </details>
            </div>
        </div>

        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 1</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:43561
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 2
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="http://127.0.0.1:42629/status" target="_blank">http://127.0.0.1:42629/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 15.69 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:37275
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /home/jovyan/work/spatial_signatures/data_product/dask-worker-space/worker-6nb7xvam
                        </td>
                    </tr>





                </table>
            </details>
            </div>
        </div>

        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 2</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:34809
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 2
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="http://127.0.0.1:42191/status" target="_blank">http://127.0.0.1:42191/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 15.69 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:40163
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /home/jovyan/work/spatial_signatures/data_product/dask-worker-space/worker-6eu74kse
                        </td>
                    </tr>





                </table>
            </details>
            </div>
        </div>

        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 3</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:42791
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 2
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="http://127.0.0.1:46581/status" target="_blank">http://127.0.0.1:46581/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 15.69 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:35041
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /home/jovyan/work/spatial_signatures/data_product/dask-worker-space/worker-2q93e4x0
                        </td>
                    </tr>





                </table>
            </details>
            </div>
        </div>

        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 4</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:45789
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 2
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="http://127.0.0.1:39645/status" target="_blank">http://127.0.0.1:39645/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 15.69 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:32919
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /home/jovyan/work/spatial_signatures/data_product/dask-worker-space/worker-2p6xt4ln
                        </td>
                    </tr>





                </table>
            </details>
            </div>
        </div>

        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 5</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:34877
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 2
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="http://127.0.0.1:46445/status" target="_blank">http://127.0.0.1:46445/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 15.69 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:44617
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /home/jovyan/work/spatial_signatures/data_product/dask-worker-space/worker-0mi2h2tv
                        </td>
                    </tr>





                </table>
            </details>
            </div>
        </div>

        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 6</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:46809
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 2
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="http://127.0.0.1:46797/status" target="_blank">http://127.0.0.1:46797/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 15.69 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:38497
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /home/jovyan/work/spatial_signatures/data_product/dask-worker-space/worker-l5q90poh
                        </td>
                    </tr>





                </table>
            </details>
            </div>
        </div>

        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 7</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:44479
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 2
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="http://127.0.0.1:35383/status" target="_blank">http://127.0.0.1:35383/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 15.69 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:43407
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /home/jovyan/work/spatial_signatures/data_product/dask-worker-space/worker-gfz82bz3
                        </td>
                    </tr>





                </table>
            </details>
            </div>
        </div>


    </details>
</div>

        </details>
    </div>
</div>
            </details>


    </div>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">include</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;hindex&#39;</span><span class="p">,</span> <span class="s1">&#39;tessellation&#39;</span><span class="p">,</span> <span class="s1">&#39;sdbAre&#39;</span><span class="p">,</span> <span class="s1">&#39;sdbPer&#39;</span><span class="p">,</span> <span class="s1">&#39;sdbCoA&#39;</span><span class="p">,</span> <span class="s1">&#39;ssbCCo&#39;</span><span class="p">,</span> <span class="s1">&#39;ssbCor&#39;</span><span class="p">,</span> <span class="s1">&#39;ssbSqu&#39;</span><span class="p">,</span> <span class="s1">&#39;ssbERI&#39;</span><span class="p">,</span> <span class="s1">&#39;ssbElo&#39;</span><span class="p">,</span> 
             <span class="s1">&#39;ssbCCM&#39;</span><span class="p">,</span> <span class="s1">&#39;ssbCCD&#39;</span><span class="p">,</span> <span class="s1">&#39;stbOri&#39;</span><span class="p">,</span> <span class="s1">&#39;sdcLAL&#39;</span><span class="p">,</span> <span class="s1">&#39;sdcAre&#39;</span><span class="p">,</span> <span class="s1">&#39;sscCCo&#39;</span><span class="p">,</span> <span class="s1">&#39;sscERI&#39;</span><span class="p">,</span> <span class="s1">&#39;stcOri&#39;</span><span class="p">,</span> 
             <span class="s1">&#39;sicCAR&#39;</span><span class="p">,</span> <span class="s1">&#39;stbCeA&#39;</span><span class="p">,</span> <span class="s1">&#39;mtbAli&#39;</span><span class="p">,</span> <span class="s1">&#39;mtbNDi&#39;</span><span class="p">,</span> <span class="s1">&#39;mtcWNe&#39;</span><span class="p">,</span> <span class="s1">&#39;mdcAre&#39;</span><span class="p">,</span> <span class="s1">&#39;ltcWRE&#39;</span><span class="p">,</span> <span class="s1">&#39;ltbIBD&#39;</span><span class="p">,</span> 
             <span class="s1">&#39;sdsSPW&#39;</span><span class="p">,</span> <span class="s1">&#39;sdsSWD&#39;</span><span class="p">,</span> <span class="s1">&#39;sdsSPO&#39;</span><span class="p">,</span> <span class="s1">&#39;sdsLen&#39;</span><span class="p">,</span> <span class="s1">&#39;sssLin&#39;</span><span class="p">,</span> <span class="s1">&#39;ldsMSL&#39;</span><span class="p">,</span> <span class="s1">&#39;mtdDeg&#39;</span><span class="p">,</span> <span class="s1">&#39;lcdMes&#39;</span><span class="p">,</span> 
             <span class="s1">&#39;linP3W&#39;</span><span class="p">,</span> <span class="s1">&#39;linP4W&#39;</span><span class="p">,</span> <span class="s1">&#39;linPDE&#39;</span><span class="p">,</span> <span class="s1">&#39;lcnClo&#39;</span><span class="p">,</span> <span class="s1">&#39;ldsCDL&#39;</span><span class="p">,</span> <span class="s1">&#39;xcnSCl&#39;</span><span class="p">,</span> <span class="s1">&#39;mtdMDi&#39;</span><span class="p">,</span> <span class="s1">&#39;lddNDe&#39;</span><span class="p">,</span> 
             <span class="s1">&#39;linWID&#39;</span><span class="p">,</span> <span class="s1">&#39;stbSAl&#39;</span><span class="p">,</span> <span class="s1">&#39;sddAre&#39;</span><span class="p">,</span> <span class="s1">&#39;sdsAre&#39;</span><span class="p">,</span> <span class="s1">&#39;sisBpM&#39;</span><span class="p">,</span> <span class="s1">&#39;misCel&#39;</span><span class="p">,</span> <span class="s1">&#39;mdsAre&#39;</span><span class="p">,</span> <span class="s1">&#39;lisCel&#39;</span><span class="p">,</span> 
             <span class="s1">&#39;ldsAre&#39;</span><span class="p">,</span> <span class="s1">&#39;ltcRea&#39;</span><span class="p">,</span> <span class="s1">&#39;ltcAre&#39;</span><span class="p">,</span> <span class="s1">&#39;ldeAre&#39;</span><span class="p">,</span> <span class="s1">&#39;ldePer&#39;</span><span class="p">,</span> <span class="s1">&#39;lseCCo&#39;</span><span class="p">,</span> <span class="s1">&#39;lseERI&#39;</span><span class="p">,</span> <span class="s1">&#39;lseCWA&#39;</span><span class="p">,</span> 
             <span class="s1">&#39;lteOri&#39;</span><span class="p">,</span> <span class="s1">&#39;lteWNB&#39;</span><span class="p">,</span> <span class="s1">&#39;lieWCe&#39;</span>
            <span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">primary</span> <span class="o">=</span> <span class="n">dask_geopandas</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/morphometrics/cells/*&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">include</span><span class="p">)</span>
<span class="n">primary</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><strong>Dask-GeoPandas GeoDataFrame Structure:</strong></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>hindex</th>
      <th>tessellation</th>
      <th>sdbAre</th>
      <th>sdbPer</th>
      <th>sdbCoA</th>
      <th>ssbCCo</th>
      <th>ssbCor</th>
      <th>ssbSqu</th>
      <th>ssbERI</th>
      <th>ssbElo</th>
      <th>ssbCCM</th>
      <th>ssbCCD</th>
      <th>stbOri</th>
      <th>sdcLAL</th>
      <th>sdcAre</th>
      <th>sscCCo</th>
      <th>sscERI</th>
      <th>stcOri</th>
      <th>sicCAR</th>
      <th>stbCeA</th>
      <th>mtbAli</th>
      <th>mtbNDi</th>
      <th>mtcWNe</th>
      <th>mdcAre</th>
      <th>ltcWRE</th>
      <th>ltbIBD</th>
      <th>sdsSPW</th>
      <th>sdsSWD</th>
      <th>sdsSPO</th>
      <th>sdsLen</th>
      <th>sssLin</th>
      <th>ldsMSL</th>
      <th>mtdDeg</th>
      <th>lcdMes</th>
      <th>linP3W</th>
      <th>linP4W</th>
      <th>linPDE</th>
      <th>lcnClo</th>
      <th>ldsCDL</th>
      <th>xcnSCl</th>
      <th>mtdMDi</th>
      <th>lddNDe</th>
      <th>linWID</th>
      <th>stbSAl</th>
      <th>sddAre</th>
      <th>sdsAre</th>
      <th>sisBpM</th>
      <th>misCel</th>
      <th>mdsAre</th>
      <th>lisCel</th>
      <th>ldsAre</th>
      <th>ltcRea</th>
      <th>ltcAre</th>
      <th>ldeAre</th>
      <th>ldePer</th>
      <th>lseCCo</th>
      <th>lseERI</th>
      <th>lseCWA</th>
      <th>lteOri</th>
      <th>lteWNB</th>
      <th>lieWCe</th>
    </tr>
    <tr>
      <th>npartitions=103</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th></th>
      <td>object</td>
      <td>geometry</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>int64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>int64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
    </tr>
    <tr>
      <th></th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th></th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th></th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
  </tbody>
</table>
</div>
<div>Dask Name: read-parquet, 103 tasks</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">conv</span> <span class="o">=</span> <span class="n">dask</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/morphometrics/convolutions/*&quot;</span><span class="p">)</span>
<span class="n">conv</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><strong>Dask DataFrame Structure:</strong></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sdbAre_q1</th>
      <th>sdbAre_q2</th>
      <th>sdbAre_q3</th>
      <th>sdbPer_q1</th>
      <th>sdbPer_q2</th>
      <th>sdbPer_q3</th>
      <th>sdbCoA_q1</th>
      <th>sdbCoA_q2</th>
      <th>sdbCoA_q3</th>
      <th>ssbCCo_q1</th>
      <th>ssbCCo_q2</th>
      <th>ssbCCo_q3</th>
      <th>ssbCor_q1</th>
      <th>ssbCor_q2</th>
      <th>ssbCor_q3</th>
      <th>ssbSqu_q1</th>
      <th>ssbSqu_q2</th>
      <th>ssbSqu_q3</th>
      <th>ssbERI_q1</th>
      <th>ssbERI_q2</th>
      <th>ssbERI_q3</th>
      <th>ssbElo_q1</th>
      <th>ssbElo_q2</th>
      <th>ssbElo_q3</th>
      <th>ssbCCM_q1</th>
      <th>ssbCCM_q2</th>
      <th>ssbCCM_q3</th>
      <th>ssbCCD_q1</th>
      <th>ssbCCD_q2</th>
      <th>ssbCCD_q3</th>
      <th>stbOri_q1</th>
      <th>stbOri_q2</th>
      <th>stbOri_q3</th>
      <th>sdcLAL_q1</th>
      <th>sdcLAL_q2</th>
      <th>sdcLAL_q3</th>
      <th>sdcAre_q1</th>
      <th>sdcAre_q2</th>
      <th>sdcAre_q3</th>
      <th>sscCCo_q1</th>
      <th>sscCCo_q2</th>
      <th>sscCCo_q3</th>
      <th>sscERI_q1</th>
      <th>sscERI_q2</th>
      <th>sscERI_q3</th>
      <th>stcOri_q1</th>
      <th>stcOri_q2</th>
      <th>stcOri_q3</th>
      <th>sicCAR_q1</th>
      <th>sicCAR_q2</th>
      <th>sicCAR_q3</th>
      <th>stbCeA_q1</th>
      <th>stbCeA_q2</th>
      <th>stbCeA_q3</th>
      <th>mtbAli_q1</th>
      <th>mtbAli_q2</th>
      <th>mtbAli_q3</th>
      <th>mtbNDi_q1</th>
      <th>mtbNDi_q2</th>
      <th>mtbNDi_q3</th>
      <th>mtcWNe_q1</th>
      <th>mtcWNe_q2</th>
      <th>mtcWNe_q3</th>
      <th>mdcAre_q1</th>
      <th>mdcAre_q2</th>
      <th>mdcAre_q3</th>
      <th>ltcWRE_q1</th>
      <th>ltcWRE_q2</th>
      <th>ltcWRE_q3</th>
      <th>ltbIBD_q1</th>
      <th>ltbIBD_q2</th>
      <th>ltbIBD_q3</th>
      <th>sdsSPW_q1</th>
      <th>sdsSPW_q2</th>
      <th>sdsSPW_q3</th>
      <th>sdsSWD_q1</th>
      <th>sdsSWD_q2</th>
      <th>sdsSWD_q3</th>
      <th>sdsSPO_q1</th>
      <th>sdsSPO_q2</th>
      <th>sdsSPO_q3</th>
      <th>sdsLen_q1</th>
      <th>sdsLen_q2</th>
      <th>sdsLen_q3</th>
      <th>sssLin_q1</th>
      <th>sssLin_q2</th>
      <th>sssLin_q3</th>
      <th>ldsMSL_q1</th>
      <th>ldsMSL_q2</th>
      <th>ldsMSL_q3</th>
      <th>mtdDeg_q1</th>
      <th>mtdDeg_q2</th>
      <th>mtdDeg_q3</th>
      <th>lcdMes_q1</th>
      <th>lcdMes_q2</th>
      <th>lcdMes_q3</th>
      <th>linP3W_q1</th>
      <th>linP3W_q2</th>
      <th>linP3W_q3</th>
      <th>linP4W_q1</th>
      <th>linP4W_q2</th>
      <th>linP4W_q3</th>
      <th>linPDE_q1</th>
      <th>linPDE_q2</th>
      <th>linPDE_q3</th>
      <th>lcnClo_q1</th>
      <th>lcnClo_q2</th>
      <th>lcnClo_q3</th>
      <th>ldsCDL_q1</th>
      <th>ldsCDL_q2</th>
      <th>ldsCDL_q3</th>
      <th>xcnSCl_q1</th>
      <th>xcnSCl_q2</th>
      <th>xcnSCl_q3</th>
      <th>mtdMDi_q1</th>
      <th>mtdMDi_q2</th>
      <th>mtdMDi_q3</th>
      <th>lddNDe_q1</th>
      <th>lddNDe_q2</th>
      <th>lddNDe_q3</th>
      <th>linWID_q1</th>
      <th>linWID_q2</th>
      <th>linWID_q3</th>
      <th>stbSAl_q1</th>
      <th>stbSAl_q2</th>
      <th>stbSAl_q3</th>
      <th>sddAre_q1</th>
      <th>sddAre_q2</th>
      <th>sddAre_q3</th>
      <th>sdsAre_q1</th>
      <th>sdsAre_q2</th>
      <th>sdsAre_q3</th>
      <th>sisBpM_q1</th>
      <th>sisBpM_q2</th>
      <th>sisBpM_q3</th>
      <th>misCel_q1</th>
      <th>misCel_q2</th>
      <th>misCel_q3</th>
      <th>mdsAre_q1</th>
      <th>mdsAre_q2</th>
      <th>mdsAre_q3</th>
      <th>lisCel_q1</th>
      <th>lisCel_q2</th>
      <th>lisCel_q3</th>
      <th>ldsAre_q1</th>
      <th>ldsAre_q2</th>
      <th>ldsAre_q3</th>
      <th>ltcRea_q1</th>
      <th>ltcRea_q2</th>
      <th>ltcRea_q3</th>
      <th>ltcAre_q1</th>
      <th>ltcAre_q2</th>
      <th>ltcAre_q3</th>
      <th>ldeAre_q1</th>
      <th>ldeAre_q2</th>
      <th>ldeAre_q3</th>
      <th>ldePer_q1</th>
      <th>ldePer_q2</th>
      <th>ldePer_q3</th>
      <th>lseCCo_q1</th>
      <th>lseCCo_q2</th>
      <th>lseCCo_q3</th>
      <th>lseERI_q1</th>
      <th>lseERI_q2</th>
      <th>lseERI_q3</th>
      <th>lseCWA_q1</th>
      <th>lseCWA_q2</th>
      <th>lseCWA_q3</th>
      <th>lteOri_q1</th>
      <th>lteOri_q2</th>
      <th>lteOri_q3</th>
      <th>lteWNB_q1</th>
      <th>lteWNB_q2</th>
      <th>lteWNB_q3</th>
      <th>lieWCe_q1</th>
      <th>lieWCe_q2</th>
      <th>lieWCe_q3</th>
    </tr>
    <tr>
      <th>npartitions=103</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th></th>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
    </tr>
    <tr>
      <th></th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th></th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th></th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
  </tbody>
</table>
</div>
<div>Dask Name: read-parquet, 103 tasks</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">renamer</span>  <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="p">{</span><span class="n">k</span><span class="p">:</span><span class="n">key</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">coded</span><span class="o">.</span><span class="n">items</span><span class="p">()},</span> <span class="o">**</span><span class="n">key_for_all</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dask</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">multi</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">primary</span><span class="p">,</span> <span class="n">conv</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">renamer</span><span class="p">)</span><span class="o">.</span><span class="n">repartition</span><span class="p">(</span><span class="n">npartitions</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="s2">&quot;../../signatures_gb/form&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">function</span> <span class="o">=</span> <span class="n">dask</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/functional/combined_raw&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">function</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><strong>Dask DataFrame Structure:</strong></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>hindex</th>
      <th>population</th>
      <th>night_lights</th>
      <th>A, B, D, E. Agriculture, energy and water</th>
      <th>C. Manufacturing</th>
      <th>F. Construction</th>
      <th>G, I. Distribution, hotels and restaurants</th>
      <th>H, J. Transport and communication</th>
      <th>K, L, M, N. Financial, real estate, professional and administrative activities</th>
      <th>O,P,Q. Public administration, education and health</th>
      <th>R, S, T, U. Other</th>
      <th>Code_18_124</th>
      <th>Code_18_211</th>
      <th>Code_18_121</th>
      <th>Code_18_421</th>
      <th>Code_18_522</th>
      <th>Code_18_142</th>
      <th>Code_18_141</th>
      <th>Code_18_112</th>
      <th>Code_18_231</th>
      <th>Code_18_311</th>
      <th>Code_18_131</th>
      <th>Code_18_123</th>
      <th>Code_18_122</th>
      <th>Code_18_512</th>
      <th>Code_18_243</th>
      <th>Code_18_313</th>
      <th>Code_18_412</th>
      <th>Code_18_321</th>
      <th>Code_18_322</th>
      <th>Code_18_324</th>
      <th>Code_18_111</th>
      <th>Code_18_423</th>
      <th>Code_18_523</th>
      <th>Code_18_133</th>
      <th>Code_18_334</th>
      <th>Code_18_132</th>
      <th>Code_18_242</th>
      <th>Code_18_411</th>
      <th>Code_18_511</th>
      <th>Code_18_312</th>
      <th>Code_18_332</th>
      <th>Code_18_521</th>
      <th>Code_18_331</th>
      <th>Code_18_244</th>
      <th>Code_18_333</th>
      <th>Code_18_222</th>
      <th>mean</th>
      <th>supermarkets_nearest</th>
      <th>supermarkets_counts</th>
      <th>listed_nearest</th>
      <th>listed_counts</th>
      <th>fhrs_nearest</th>
      <th>fhrs_counts</th>
      <th>culture_nearest</th>
      <th>culture_counts</th>
      <th>nearest_water</th>
      <th>nearest_retail_centre</th>
    </tr>
    <tr>
      <th>npartitions=103</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th></th>
      <td>object</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
      <td>float64</td>
      <td>float64</td>
      <td>int64</td>
      <td>float64</td>
      <td>int64</td>
      <td>float64</td>
      <td>int64</td>
      <td>float64</td>
      <td>int64</td>
      <td>float64</td>
      <td>float64</td>
    </tr>
    <tr>
      <th></th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th></th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th></th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
  </tbody>
</table>
</div>
<div>Dask Name: reset_index, 206 tasks</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fn_conv</span> <span class="o">=</span> <span class="n">dask</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/functional/functional/*&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;supermarkets_nearest&quot;</span><span class="p">,</span><span class="s2">&quot;supermarkets_counts&quot;</span><span class="p">,</span><span class="s2">&quot;listed_nearest&quot;</span><span class="p">,</span> <span class="s2">&quot;listed_counts&quot;</span><span class="p">,</span> <span class="s2">&quot;fhrs_nearest&quot;</span><span class="p">,</span> <span class="s2">&quot;fhrs_counts&quot;</span><span class="p">,</span> <span class="s2">&quot;culture_nearest&quot;</span><span class="p">,</span> <span class="s2">&quot;culture_counts&quot;</span><span class="p">,</span> <span class="s2">&quot;nearest_water&quot;</span><span class="p">,</span><span class="s2">&quot;nearest_retail_centre&quot;</span><span class="p">,</span> <span class="s2">&quot;keep_q1&quot;</span><span class="p">,</span>  <span class="s2">&quot;keep_q2&quot;</span><span class="p">,</span>  <span class="s2">&quot;keep_q3&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fn_conv</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><strong>Dask DataFrame Structure:</strong></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>population_q1</th>
      <th>population_q2</th>
      <th>population_q3</th>
      <th>night_lights_q1</th>
      <th>night_lights_q2</th>
      <th>night_lights_q3</th>
      <th>A, B, D, E. Agriculture, energy and water_q1</th>
      <th>A, B, D, E. Agriculture, energy and water_q2</th>
      <th>A, B, D, E. Agriculture, energy and water_q3</th>
      <th>C. Manufacturing_q1</th>
      <th>C. Manufacturing_q2</th>
      <th>C. Manufacturing_q3</th>
      <th>F. Construction_q1</th>
      <th>F. Construction_q2</th>
      <th>F. Construction_q3</th>
      <th>G, I. Distribution, hotels and restaurants_q1</th>
      <th>G, I. Distribution, hotels and restaurants_q2</th>
      <th>G, I. Distribution, hotels and restaurants_q3</th>
      <th>H, J. Transport and communication_q1</th>
      <th>H, J. Transport and communication_q2</th>
      <th>H, J. Transport and communication_q3</th>
      <th>K, L, M, N. Financial, real estate, professional and administrative activities_q1</th>
      <th>K, L, M, N. Financial, real estate, professional and administrative activities_q2</th>
      <th>K, L, M, N. Financial, real estate, professional and administrative activities_q3</th>
      <th>O,P,Q. Public administration, education and health_q1</th>
      <th>O,P,Q. Public administration, education and health_q2</th>
      <th>O,P,Q. Public administration, education and health_q3</th>
      <th>R, S, T, U. Other_q1</th>
      <th>R, S, T, U. Other_q2</th>
      <th>R, S, T, U. Other_q3</th>
      <th>Code_18_124_q1</th>
      <th>Code_18_124_q2</th>
      <th>Code_18_124_q3</th>
      <th>Code_18_211_q1</th>
      <th>Code_18_211_q2</th>
      <th>Code_18_211_q3</th>
      <th>Code_18_121_q1</th>
      <th>Code_18_121_q2</th>
      <th>Code_18_121_q3</th>
      <th>Code_18_421_q1</th>
      <th>Code_18_421_q2</th>
      <th>Code_18_421_q3</th>
      <th>Code_18_522_q1</th>
      <th>Code_18_522_q2</th>
      <th>Code_18_522_q3</th>
      <th>Code_18_142_q1</th>
      <th>Code_18_142_q2</th>
      <th>Code_18_142_q3</th>
      <th>Code_18_141_q1</th>
      <th>Code_18_141_q2</th>
      <th>Code_18_141_q3</th>
      <th>Code_18_112_q1</th>
      <th>Code_18_112_q2</th>
      <th>Code_18_112_q3</th>
      <th>Code_18_231_q1</th>
      <th>Code_18_231_q2</th>
      <th>Code_18_231_q3</th>
      <th>Code_18_311_q1</th>
      <th>Code_18_311_q2</th>
      <th>Code_18_311_q3</th>
      <th>Code_18_131_q1</th>
      <th>Code_18_131_q2</th>
      <th>Code_18_131_q3</th>
      <th>Code_18_123_q1</th>
      <th>Code_18_123_q2</th>
      <th>Code_18_123_q3</th>
      <th>Code_18_122_q1</th>
      <th>Code_18_122_q2</th>
      <th>Code_18_122_q3</th>
      <th>Code_18_512_q1</th>
      <th>Code_18_512_q2</th>
      <th>Code_18_512_q3</th>
      <th>Code_18_243_q1</th>
      <th>Code_18_243_q2</th>
      <th>Code_18_243_q3</th>
      <th>Code_18_313_q1</th>
      <th>Code_18_313_q2</th>
      <th>Code_18_313_q3</th>
      <th>Code_18_412_q1</th>
      <th>Code_18_412_q2</th>
      <th>Code_18_412_q3</th>
      <th>Code_18_321_q1</th>
      <th>Code_18_321_q2</th>
      <th>Code_18_321_q3</th>
      <th>Code_18_322_q1</th>
      <th>Code_18_322_q2</th>
      <th>Code_18_322_q3</th>
      <th>Code_18_324_q1</th>
      <th>Code_18_324_q2</th>
      <th>Code_18_324_q3</th>
      <th>Code_18_111_q1</th>
      <th>Code_18_111_q2</th>
      <th>Code_18_111_q3</th>
      <th>Code_18_423_q1</th>
      <th>Code_18_423_q2</th>
      <th>Code_18_423_q3</th>
      <th>Code_18_523_q1</th>
      <th>Code_18_523_q2</th>
      <th>Code_18_523_q3</th>
      <th>mean_q1</th>
      <th>mean_q2</th>
      <th>mean_q3</th>
      <th>Code_18_312_q1</th>
      <th>Code_18_312_q2</th>
      <th>Code_18_312_q3</th>
      <th>Code_18_133_q1</th>
      <th>Code_18_133_q2</th>
      <th>Code_18_133_q3</th>
      <th>Code_18_333_q1</th>
      <th>Code_18_333_q2</th>
      <th>Code_18_333_q3</th>
      <th>Code_18_332_q1</th>
      <th>Code_18_332_q2</th>
      <th>Code_18_332_q3</th>
      <th>Code_18_411_q1</th>
      <th>Code_18_411_q2</th>
      <th>Code_18_411_q3</th>
      <th>Code_18_132_q1</th>
      <th>Code_18_331_q2</th>
      <th>Code_18_222_q1</th>
      <th>Code_18_511_q3</th>
      <th>Code_18_242_q1</th>
      <th>Code_18_511_q2</th>
      <th>Code_18_242_q3</th>
      <th>Code_18_331_q1</th>
      <th>Code_18_334_q2</th>
      <th>Code_18_511_q1</th>
      <th>Code_18_334_q1</th>
      <th>Code_18_222_q3</th>
      <th>Code_18_242_q2</th>
      <th>Code_18_244_q3</th>
      <th>Code_18_521_q2</th>
      <th>Code_18_334_q3</th>
      <th>Code_18_244_q1</th>
      <th>Code_18_244_q2</th>
      <th>Code_18_331_q3</th>
      <th>Code_18_132_q2</th>
      <th>Code_18_132_q3</th>
      <th>Code_18_521_q1</th>
      <th>Code_18_222_q2</th>
      <th>Code_18_521_q3</th>
    </tr>
    <tr>
      <th>npartitions=103</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th></th>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
    </tr>
    <tr>
      <th></th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th></th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th></th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
  </tbody>
</table>
</div>
<div>Dask Name: reset_index, 310 tasks</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fn</span> <span class="o">=</span> <span class="n">dask</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">multi</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">function</span><span class="p">,</span> <span class="n">fn_conv</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">renamer</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.9/site-packages/dask/dataframe/multi.py:1222: UserWarning: Concatenating dataframes with unknown divisions.
We&#39;re assuming that the indices of each dataframes are 
 aligned. This assumption is not generally safe.
  warnings.warn(
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyarrow</span> <span class="k">as</span> <span class="nn">pa</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">schema</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">pa</span><span class="o">.</span><span class="n">float64</span><span class="p">()</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">fn</span><span class="o">.</span><span class="n">columns</span><span class="p">}</span>
<span class="n">schema</span><span class="p">[</span><span class="s2">&quot;hindex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">string</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fn</span><span class="o">.</span><span class="n">repartition</span><span class="p">(</span><span class="n">npartitions</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="s2">&quot;../../signatures_gb/function&quot;</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="n">schema</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[None]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">client</span><span class="o">.</span><span class="n">restart</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
    <div style="width: 24px; height: 24px; background-color: #e1e1e1; border: 3px solid #9D9D9D; border-radius: 5px; position: absolute;"> </div>
    <div style="margin-left: 48px;">
        <h3 style="margin-bottom: 0px;">Client</h3>
        <p style="color: #9D9D9D; margin-bottom: 0px;">Client-5d4fe926-94ba-11ec-827f-6774297aa622</p>
        <table style="width: 100%; text-align: left;">

        <tr>

            <td style="text-align: left;"><strong>Connection method:</strong> Cluster object</td>
            <td style="text-align: left;"><strong>Cluster type:</strong> distributed.LocalCluster</td>

        </tr>


            <tr>
                <td style="text-align: left;">
                    <strong>Dashboard: </strong> <a href="http://127.0.0.1:8787/status" target="_blank">http://127.0.0.1:8787/status</a>
                </td>
                <td style="text-align: left;"></td>
            </tr>


        </table>


            <details>
            <summary style="margin-bottom: 20px;"><h3 style="display: inline;">Cluster Info</h3></summary>
            <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-mod-trusted jp-OutputArea-output">
    <div style="width: 24px; height: 24px; background-color: #e1e1e1; border: 3px solid #9D9D9D; border-radius: 5px; position: absolute;">
    </div>
    <div style="margin-left: 48px;">
        <h3 style="margin-bottom: 0px; margin-top: 0px;">LocalCluster</h3>
        <p style="color: #9D9D9D; margin-bottom: 0px;">25452591</p>
        <table style="width: 100%; text-align: left;">
            <tr>
                <td style="text-align: left;">
                    <strong>Dashboard:</strong> <a href="http://127.0.0.1:8787/status" target="_blank">http://127.0.0.1:8787/status</a>
                </td>
                <td style="text-align: left;">
                    <strong>Workers:</strong> 8
                </td>
            </tr>
            <tr>
                <td style="text-align: left;">
                    <strong>Total threads:</strong> 16
                </td>
                <td style="text-align: left;">
                    <strong>Total memory:</strong> 125.54 GiB
                </td>
            </tr>

            <tr>
    <td style="text-align: left;"><strong>Status:</strong> running</td>
    <td style="text-align: left;"><strong>Using processes:</strong> True</td>
</tr>


        </table>

        <details>
            <summary style="margin-bottom: 20px;">
                <h3 style="display: inline;">Scheduler Info</h3>
            </summary>

            <div style="">
    <div>
        <div style="width: 24px; height: 24px; background-color: #FFF7E5; border: 3px solid #FF6132; border-radius: 5px; position: absolute;"> </div>
        <div style="margin-left: 48px;">
            <h3 style="margin-bottom: 0px;">Scheduler</h3>
            <p style="color: #9D9D9D; margin-bottom: 0px;">Scheduler-b7325f1b-c6cd-4c23-9a2c-b642314528a7</p>
            <table style="width: 100%; text-align: left;">
                <tr>
                    <td style="text-align: left;">
                        <strong>Comm:</strong> tcp://127.0.0.1:39497
                    </td>
                    <td style="text-align: left;">
                        <strong>Workers:</strong> 8
                    </td>
                </tr>
                <tr>
                    <td style="text-align: left;">
                        <strong>Dashboard:</strong> <a href="http://127.0.0.1:8787/status" target="_blank">http://127.0.0.1:8787/status</a>
                    </td>
                    <td style="text-align: left;">
                        <strong>Total threads:</strong> 16
                    </td>
                </tr>
                <tr>
                    <td style="text-align: left;">
                        <strong>Started:</strong> 26 minutes ago
                    </td>
                    <td style="text-align: left;">
                        <strong>Total memory:</strong> 125.54 GiB
                    </td>
                </tr>
            </table>
        </div>
    </div>

    <details style="margin-left: 48px;">
        <summary style="margin-bottom: 20px;">
            <h3 style="display: inline;">Workers</h3>
        </summary>


        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 0</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:38377
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 2
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="http://127.0.0.1:40007/status" target="_blank">http://127.0.0.1:40007/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 15.69 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:44439
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /home/jovyan/work/spatial_signatures/data_product/dask-worker-space/worker-eowefyf5
                        </td>
                    </tr>





                </table>
            </details>
            </div>
        </div>

        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 1</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:44561
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 2
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="http://127.0.0.1:45835/status" target="_blank">http://127.0.0.1:45835/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 15.69 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:46445
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /home/jovyan/work/spatial_signatures/data_product/dask-worker-space/worker-wcnccrg_
                        </td>
                    </tr>





                </table>
            </details>
            </div>
        </div>

        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 2</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:44141
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 2
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="http://127.0.0.1:45401/status" target="_blank">http://127.0.0.1:45401/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 15.69 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:42789
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /home/jovyan/work/spatial_signatures/data_product/dask-worker-space/worker-d_b1cznu
                        </td>
                    </tr>





                </table>
            </details>
            </div>
        </div>

        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 3</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:46367
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 2
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="http://127.0.0.1:38675/status" target="_blank">http://127.0.0.1:38675/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 15.69 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:33619
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /home/jovyan/work/spatial_signatures/data_product/dask-worker-space/worker-ix070j9r
                        </td>
                    </tr>





                </table>
            </details>
            </div>
        </div>

        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 4</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:45547
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 2
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="http://127.0.0.1:40375/status" target="_blank">http://127.0.0.1:40375/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 15.69 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:39231
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /home/jovyan/work/spatial_signatures/data_product/dask-worker-space/worker-ltgjdbus
                        </td>
                    </tr>





                </table>
            </details>
            </div>
        </div>

        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 5</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:39895
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 2
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="http://127.0.0.1:46737/status" target="_blank">http://127.0.0.1:46737/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 15.69 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:43801
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /home/jovyan/work/spatial_signatures/data_product/dask-worker-space/worker-9s0njlc1
                        </td>
                    </tr>





                </table>
            </details>
            </div>
        </div>

        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 6</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:37101
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 2
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="http://127.0.0.1:33435/status" target="_blank">http://127.0.0.1:33435/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 15.69 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:38807
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /home/jovyan/work/spatial_signatures/data_product/dask-worker-space/worker-r6jib2lo
                        </td>
                    </tr>





                </table>
            </details>
            </div>
        </div>

        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 7</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:36381
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 2
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="http://127.0.0.1:36777/status" target="_blank">http://127.0.0.1:36777/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 15.69 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:35769
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /home/jovyan/work/spatial_signatures/data_product/dask-worker-space/worker-dxhuphng
                        </td>
                    </tr>





                </table>
            </details>
            </div>
        </div>


    </details>
</div>

        </details>
    </div>
</div>
            </details>


    </div>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">joined</span> <span class="o">=</span> <span class="n">dask</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/signatures/hindex_to_type&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;hindex&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;signature_type&quot;</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">joined</span><span class="o">.</span><span class="n">repartition</span><span class="p">(</span><span class="n">npartitions</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="s2">&quot;../../signatures_gb/signature_type&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[None]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="tables-of-characters">
<h2>Tables of characters<a class="headerlink" href="#tables-of-characters" title="Permalink to this headline">¶</a></h2>
<p>Create tables of characters to be used in the paper.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">morph</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;morphometric_chars.csv&quot;</span><span class="p">)</span>
<span class="n">morph</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>context</th>
      <th>category</th>
      <th>reference</th>
      <th>id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>building</td>
      <td>dimension</td>
      <td>[@hallowell2013]</td>
      <td>sdbAre</td>
    </tr>
    <tr>
      <th>1</th>
      <td>building</td>
      <td>dimension</td>
      <td>[@vanderhaegen2017]</td>
      <td>sdbPer</td>
    </tr>
    <tr>
      <th>2</th>
      <td>building</td>
      <td>dimension</td>
      <td>[@schirmer2015]</td>
      <td>sdbCoA</td>
    </tr>
    <tr>
      <th>3</th>
      <td>building</td>
      <td>shape</td>
      <td>[@dibble2017]</td>
      <td>ssbCCo</td>
    </tr>
    <tr>
      <th>4</th>
      <td>building</td>
      <td>shape</td>
      <td>[@steiniger2008]</td>
      <td>ssbCor</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">morph</span><span class="p">[</span><span class="s2">&quot;reference&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">morph</span><span class="p">[</span><span class="s2">&quot;reference&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;[@fleischmann2021]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">morph</span><span class="p">[</span><span class="s2">&quot;reference&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">cite{&quot;</span> <span class="o">+</span> <span class="n">morph</span><span class="p">[</span><span class="s2">&quot;reference&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;}&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">morph</span><span class="p">[</span><span class="s2">&quot;character&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">morph</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">renamer</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">morph</span> <span class="o">=</span> <span class="n">morph</span><span class="p">[[</span><span class="s2">&quot;character&quot;</span><span class="p">,</span> <span class="s2">&quot;category&quot;</span><span class="p">,</span> <span class="s2">&quot;reference&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">morph</span><span class="o">.</span><span class="n">to_latex</span><span class="p">(</span><span class="n">escape</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>\begin{tabular}{lll}
\toprule
                                         character &amp;     category &amp;               reference \\
\midrule
                                  area of building &amp;    dimension &amp;    \cite{hallowell2013} \\
                             perimeter of building &amp;    dimension &amp; \cite{vanderhaegen2017} \\
                        courtyard area of building &amp;    dimension &amp;     \cite{schirmer2015} \\
                  circular compactness of building &amp;        shape &amp;       \cite{dibble2017} \\
                               corners of building &amp;        shape &amp;    \cite{steiniger2008} \\
                            squareness of building &amp;        shape &amp;    \cite{steiniger2008} \\
          equivalent rectangular index of building &amp;        shape &amp;    \cite{basaraner2017} \\
                            elongation of building &amp;        shape &amp;    \cite{steiniger2008} \\
  centroid - corner distance deviation of building &amp;        shape &amp;  \cite{fleischmann2021} \\
       centroid - corner mean distance of building &amp;    dimension &amp;     \cite{schirmer2015} \\
                           orientation of building &amp; distribution &amp;     \cite{schirmer2015} \\
                      street alignment of building &amp; distribution &amp;     \cite{schirmer2015} \\
                        cell alignment of building &amp; distribution &amp;  \cite{fleischmann2021} \\
                        longest axis length of ETC &amp;    dimension &amp;  \cite{fleischmann2021} \\
                                       area of ETC &amp;    dimension &amp;     \cite{hamaina2012a} \\
                       circular compactness of ETC &amp;        shape &amp;  \cite{fleischmann2021} \\
               equivalent rectangular index of ETC &amp;        shape &amp;  \cite{fleischmann2021} \\
                                orientation of ETC &amp; distribution &amp;  \cite{fleischmann2021} \\
                         covered area ratio of ETC &amp;    intensity &amp;      \cite{hamaina2013} \\
                          length of street segment &amp;    dimension &amp;          \cite{gil2012} \\
                           width of street profile &amp;    dimension &amp;       \cite{araldi2019} \\
                        openness of street profile &amp; distribution &amp;       \cite{araldi2019} \\
                 width deviation of street profile &amp;    diversity &amp;       \cite{araldi2019} \\
                       linearity of street segment &amp;        shape &amp;       \cite{araldi2019} \\
                area covered by edge-attached ETCs &amp;    dimension &amp;  \cite{fleischmann2021} \\
             buildings per meter of street segment &amp;    intensity &amp;  \cite{fleischmann2021} \\
                area covered by node-attached ETCs &amp;    dimension &amp;  \cite{fleischmann2021} \\
               alignment of neighbouring buildings &amp; distribution &amp;       \cite{hijazi2016} \\
      mean distance between neighbouring buildings &amp; distribution &amp;       \cite{hijazi2016} \\
              perimeter-weighted neighbours of ETC &amp; distribution &amp;  \cite{fleischmann2021} \\
                area covered by neighbouring cells &amp;    dimension &amp;  \cite{fleischmann2021} \\
             reached ETCs by neighbouring segments &amp;    intensity &amp;  \cite{fleischmann2021} \\
             reached area by neighbouring segments &amp;    dimension &amp;  \cite{fleischmann2021} \\
                           node degree of junction &amp; distribution &amp;       \cite{boeing2018} \\
mean distance to neighbouring nodes of street n... &amp;    dimension &amp;  \cite{fleischmann2021} \\
                      mean inter-building distance &amp; distribution &amp;       \cite{caruso2017} \\
                weighted reached enclosures of ETC &amp;    intensity &amp;  \cite{fleischmann2021} \\
           reached ETCs by tessellation contiguity &amp;    intensity &amp;  \cite{fleischmann2021} \\
           reached area by tessellation contiguity &amp;    dimension &amp;  \cite{fleischmann2021} \\
                                 area of enclosure &amp;    dimension &amp;       \cite{dibble2017} \\
                            perimeter of enclosure &amp;    dimension &amp;          \cite{gil2012} \\
                 circular compactness of enclosure &amp;        shape &amp;     \cite{schirmer2015} \\
         equivalent rectangular index of enclosure &amp;        shape &amp;    \cite{basaraner2017} \\
            compactness-weighted axis of enclosure &amp;        shape &amp;   \cite{feliciotti2018} \\
                          orientation of enclosure &amp; distribution &amp;          \cite{gil2012} \\
        perimeter-weighted neighbours of enclosure &amp; distribution &amp;  \cite{fleischmann2021} \\
                   area-weighted ETCs of enclosure &amp;    intensity &amp;  \cite{fleischmann2021} \\
                local meshedness of street network &amp; connectivity &amp;   \cite{feliciotti2018} \\
                mean segment length within 3 steps &amp;    dimension &amp;  \cite{fleischmann2021} \\
         local cul-de-sac length of street network &amp;    dimension &amp;  \cite{fleischmann2021} \\
              reached area by local street network &amp;    dimension &amp;  \cite{fleischmann2021} \\
              reached ETCs by local street network &amp;    intensity &amp;  \cite{fleischmann2021} \\
              local node density of street network &amp;    intensity &amp;  \cite{fleischmann2021} \\
 local proportion of cul-de-sacs of street network &amp; connectivity &amp;        \cite{lowry2014} \\
local proportion of 3-way intersections of stre... &amp; connectivity &amp;       \cite{boeing2018} \\
local proportion of 4-way intersections of stre... &amp; connectivity &amp;       \cite{boeing2018} \\
local degree weighted node density of street ne... &amp;    intensity &amp;       \cite{dibble2017} \\
                 local closeness of street network &amp; connectivity &amp;        \cite{porta2006} \\
               square clustering of street network &amp; connectivity &amp;  \cite{fleischmann2021} \\
\bottomrule
\end{tabular}
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="figure-of-context">
<h2>Figure of context<a class="headerlink" href="#figure-of-context" title="Permalink to this headline">¶</a></h2>
<p>Create a figure illustrating context.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tess</span> <span class="o">=</span> <span class="n">geopandas</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/morphometrics/cells/cells_76.pq&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;hindex&quot;</span><span class="p">,</span> <span class="s2">&quot;tessellation&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">shapely.geometry</span> <span class="kn">import</span> <span class="n">Point</span>
<span class="kn">import</span> <span class="nn">urbangrammar_graphics</span> <span class="k">as</span> <span class="nn">ugg</span>
<span class="kn">import</span> <span class="nn">contextily</span>
<span class="kn">from</span> <span class="nn">matplotlib_scalebar.scalebar</span> <span class="kn">import</span> <span class="n">ScaleBar</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">minx</span><span class="p">,</span> <span class="n">maxx</span><span class="p">,</span> <span class="n">miny</span><span class="p">,</span> <span class="n">maxy</span> <span class="o">=</span> <span class="p">(</span><span class="mi">357500</span><span class="p">,</span> <span class="mi">360000</span><span class="p">,</span> <span class="mi">173500</span><span class="p">,</span> <span class="mi">176000</span><span class="p">)</span>
<span class="n">subset</span> <span class="o">=</span> <span class="n">tess</span><span class="o">.</span><span class="n">cx</span><span class="p">[</span><span class="n">minx</span><span class="p">:</span><span class="n">maxx</span><span class="p">,</span> <span class="n">miny</span><span class="p">:</span><span class="n">maxy</span><span class="p">]</span>
<span class="n">central</span> <span class="o">=</span> <span class="n">subset</span><span class="p">[</span><span class="n">subset</span><span class="o">.</span><span class="n">intersects</span><span class="p">(</span><span class="n">Point</span><span class="p">((</span><span class="n">maxx</span><span class="o">+</span><span class="n">minx</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">maxy</span><span class="o">+</span><span class="n">miny</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">central</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>hindex</th>
      <th>tessellation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>79425</th>
      <td>c076e329053t0011</td>
      <td>POLYGON ((358723.682 174746.214, 358724.705 17...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">momepy</span>

<span class="n">W</span> <span class="o">=</span> <span class="n">momepy</span><span class="o">.</span><span class="n">sw_high</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">subset</span><span class="p">,</span> <span class="n">ids</span><span class="o">=</span><span class="s2">&quot;hindex&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">neighbors</span> <span class="o">=</span> <span class="n">subset</span><span class="p">[</span><span class="n">subset</span><span class="o">.</span><span class="n">hindex</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">W</span><span class="o">.</span><span class="n">neighbors</span><span class="p">[</span><span class="s1">&#39;c076e329053t0011&#39;</span><span class="p">])]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">neighbors</span><span class="p">[</span><span class="s2">&quot;distance&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">neighbors</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">central</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.9/site-packages/geopandas/geodataframe.py:1351: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super().__setitem__(key, value)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">subset</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">Point</span><span class="p">((</span><span class="n">maxx</span><span class="o">+</span><span class="n">minx</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">maxy</span><span class="o">+</span><span class="n">miny</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">buffer</span><span class="p">(</span><span class="mi">1200</span><span class="p">))</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">central</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">ugg</span><span class="o">.</span><span class="n">COLORS</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
<span class="n">neighbors</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s2">&quot;distance&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">light_palette</span><span class="p">(</span><span class="n">ugg</span><span class="o">.</span><span class="n">COLORS</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">256</span><span class="p">,</span> <span class="n">as_cmap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.8</span><span class="p">)</span>

<span class="c1"># buildings.plot(ax=ax, color=ugg.COLORS[1], alpha=.1, zorder=-1)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>

<span class="n">scalebar</span> <span class="o">=</span> <span class="n">ScaleBar</span><span class="p">(</span><span class="n">dx</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span>
                    <span class="n">location</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">,</span>
                    <span class="n">height_fraction</span><span class="o">=</span><span class="mf">0.002</span><span class="p">,</span>
                    <span class="n">pad</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span>
                    <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">scalebar</span><span class="p">)</span>

<span class="n">contextily</span><span class="o">.</span><span class="n">add_basemap</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">contextily</span><span class="o">.</span><span class="n">providers</span><span class="o">.</span><span class="n">Esri</span><span class="o">.</span><span class="n">WorldImagery</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="n">subset</span><span class="o">.</span><span class="n">crs</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;cell_context.png&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/create_data_product_118_0.png" src="../_images/create_data_product_118_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">func</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">Series</span><span class="p">({</span><span class="s1">&#39;population&#39;</span><span class="p">:</span> <span class="s1">&#39;Population&#39;</span><span class="p">,</span>
 <span class="s1">&#39;night_lights&#39;</span><span class="p">:</span> <span class="s1">&#39;Night lights&#39;</span><span class="p">,</span>
 <span class="s1">&#39;A, B, D, E. Agriculture, energy and water&#39;</span><span class="p">:</span> <span class="s1">&#39;Workplace population [Agriculture, energy and water]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;C. Manufacturing&#39;</span><span class="p">:</span> <span class="s1">&#39;Workplace population [Manufacturing]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;F. Construction&#39;</span><span class="p">:</span> <span class="s1">&#39;Workplace population [Construction]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;G, I. Distribution, hotels and restaurants&#39;</span><span class="p">:</span> <span class="s1">&#39;Workplace population [Distribution, hotels and restaurants]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;H, J. Transport and communication&#39;</span><span class="p">:</span> <span class="s1">&#39;Workplace population [Transport and communication]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;K, L, M, N. Financial, real estate, professional and administrative activities&#39;</span><span class="p">:</span> <span class="s1">&#39;Workplace population [Financial, real estate, professional and administrative activities]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;O,P,Q. Public administration, education and health&#39;</span><span class="p">:</span> <span class="s1">&#39;Workplace population [Public administration, education and health]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;R, S, T, U. Other&#39;</span><span class="p">:</span> <span class="s1">&#39;Workplace population [Other]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Code_18_124&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Airports]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Code_18_211&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Non-irrigated arable land]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Code_18_121&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Industrial or commercial units]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Code_18_421&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Salt marshes]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Code_18_522&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Estuaries]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Code_18_142&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Sport and leisure facilities]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Code_18_141&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Green urban areas]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Code_18_112&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Discontinuous urban fabric]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Code_18_231&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Pastures]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Code_18_311&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Broad-leaved forest]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Code_18_131&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Mineral extraction sites]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Code_18_123&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Port areas]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Code_18_122&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Road and rail networks and associated land]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Code_18_512&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Water bodies]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Code_18_243&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Land principally occupied by agriculture, with significant areas of natural vegetation]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Code_18_313&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Mixed forest]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Code_18_412&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Peat bogs]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Code_18_321&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Natural grasslands]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Code_18_322&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Moors and heathland]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Code_18_324&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Transitional woodland-shrub]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Code_18_111&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Continuous urban fabric]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Code_18_423&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Intertidal flats]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Code_18_523&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Sea and ocean]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Code_18_312&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Coniferous forest]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Code_18_133&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Construction sites]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Code_18_333&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Sparsely vegetated areas]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Code_18_332&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Bare rocks]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Code_18_411&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Inland marshes]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Code_18_132&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Dump sites]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Code_18_222&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Fruit trees and berry plantations]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Code_18_242&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Complex cultivation patterns]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Code_18_331&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Beaches, dunes, sands]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Code_18_511&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Water courses]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Code_18_334&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Burnt areas]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Code_18_244&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Agro-forestry areas]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Code_18_521&#39;</span><span class="p">:</span> <span class="s1">&#39;Land cover [Coastal lagoons]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;mean&#39;</span><span class="p">:</span> <span class="s1">&#39;NDVI&#39;</span><span class="p">,</span>
 <span class="s1">&#39;supermarkets_nearest&#39;</span><span class="p">:</span> <span class="s1">&#39;Supermarkets [distance to nearest]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;supermarkets_counts&#39;</span><span class="p">:</span> <span class="s1">&#39;Supermarkets [counts within 1200m]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;listed_nearest&#39;</span><span class="p">:</span> <span class="s1">&#39;Listed buildings [distance to nearest]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;listed_counts&#39;</span><span class="p">:</span> <span class="s1">&#39;Listed buildings [counts within 1200m]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;fhrs_nearest&#39;</span><span class="p">:</span> <span class="s1">&#39;FHRS points [distance to nearest]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;fhrs_counts&#39;</span><span class="p">:</span> <span class="s1">&#39;FHRS points [counts within 1200m]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;culture_nearest&#39;</span><span class="p">:</span> <span class="s1">&#39;Cultural venues [distance to nearest]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;culture_counts&#39;</span><span class="p">:</span> <span class="s1">&#39;Cultural venues [counts within 1200m]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;nearest_water&#39;</span><span class="p">:</span> <span class="s1">&#39;Water bodies [distance to nearest]&#39;</span><span class="p">,</span>
 <span class="s1">&#39;nearest_retail_centre&#39;</span><span class="p">:</span> <span class="s1">&#39;Retail centres [distance to nearest]&#39;</span><span class="p">,},</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;character&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">func</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">or_func</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;func.csv&quot;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">or_func</span> <span class="o">=</span> <span class="n">or_func</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;Unnamed: 4&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rows</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span> <span class="o">+</span> <span class="p">([</span><span class="mi">8</span><span class="p">]</span> <span class="o">*</span> <span class="mi">37</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">or_func</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">rows</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(57, 4)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">functional</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">func</span><span class="p">,</span> <span class="n">or_func</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">rows</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">pandas</span><span class="o">.</span><span class="n">option_context</span><span class="p">(</span><span class="s2">&quot;max_colwidth&quot;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">functional</span><span class="o">.</span><span class="n">to_latex</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>\begin{tabular}{lllll}
\toprule
                                                                                          character &amp;                               data  &amp;                                                                     source  &amp;                    input geometry  &amp;                                transfer method  \\
\midrule
                                                                                         Population &amp;               Population estimates  &amp;           ONS Census Output Area population estimates, Statistics.gov.scot  &amp;      Vector (output area polygon)  &amp;  Building-based dasymetric areal interpolation  \\
                                                                                       Night lights &amp;                       Night Lights  &amp;                                                 VIIRS DNB Nighttime Lights  &amp;                     Raster (500m)  &amp;                               Zonal statistics  \\
                                               Workplace population [Agriculture, energy and water] &amp;               Workplace population  &amp;    ONS Census Workplace population, Scotland&#39;s census Workplace population  &amp;      Vector (output area polygon)  &amp;  Building-based dasymetric areal interpolation  \\
                                                               Workplace population [Manufacturing] &amp;               Workplace population  &amp;    ONS Census Workplace population, Scotland&#39;s census Workplace population  &amp;      Vector (output area polygon)  &amp;  Building-based dasymetric areal interpolation  \\
                                                                Workplace population [Construction] &amp;               Workplace population  &amp;    ONS Census Workplace population, Scotland&#39;s census Workplace population  &amp;      Vector (output area polygon)  &amp;  Building-based dasymetric areal interpolation  \\
                                        Workplace population [Distribution, hotels and restaurants] &amp;               Workplace population  &amp;    ONS Census Workplace population, Scotland&#39;s census Workplace population  &amp;      Vector (output area polygon)  &amp;  Building-based dasymetric areal interpolation  \\
                                                 Workplace population [Transport and communication] &amp;               Workplace population  &amp;    ONS Census Workplace population, Scotland&#39;s census Workplace population  &amp;      Vector (output area polygon)  &amp;  Building-based dasymetric areal interpolation  \\
          Workplace population [Financial, real estate, professional and administrative activities] &amp;               Workplace population  &amp;    ONS Census Workplace population, Scotland&#39;s census Workplace population  &amp;      Vector (output area polygon)  &amp;  Building-based dasymetric areal interpolation  \\
                                 Workplace population [Public administration, education and health] &amp;               Workplace population  &amp;    ONS Census Workplace population, Scotland&#39;s census Workplace population  &amp;      Vector (output area polygon)  &amp;  Building-based dasymetric areal interpolation  \\
                                                                       Workplace population [Other] &amp;                  Corine land cover  &amp;                                         Copernicus Land Monitoring Service  &amp;  Vector (land cover zone polygon)  &amp;                            Areal interpolation  \\
                                                                              Land cover [Airports] &amp;                  Corine land cover  &amp;                                         Copernicus Land Monitoring Service  &amp;  Vector (land cover zone polygon)  &amp;                            Areal interpolation  \\
                                                             Land cover [Non-irrigated arable land] &amp;                  Corine land cover  &amp;                                         Copernicus Land Monitoring Service  &amp;  Vector (land cover zone polygon)  &amp;                            Areal interpolation  \\
                                                        Land cover [Industrial or commercial units] &amp;                  Corine land cover  &amp;                                         Copernicus Land Monitoring Service  &amp;  Vector (land cover zone polygon)  &amp;                            Areal interpolation  \\
                                                                          Land cover [Salt marshes] &amp;                  Corine land cover  &amp;                                         Copernicus Land Monitoring Service  &amp;  Vector (land cover zone polygon)  &amp;                            Areal interpolation  \\
                                                                             Land cover [Estuaries] &amp;                  Corine land cover  &amp;                                         Copernicus Land Monitoring Service  &amp;  Vector (land cover zone polygon)  &amp;                            Areal interpolation  \\
                                                          Land cover [Sport and leisure facilities] &amp;                  Corine land cover  &amp;                                         Copernicus Land Monitoring Service  &amp;  Vector (land cover zone polygon)  &amp;                            Areal interpolation  \\
                                                                     Land cover [Green urban areas] &amp;                  Corine land cover  &amp;                                         Copernicus Land Monitoring Service  &amp;  Vector (land cover zone polygon)  &amp;                            Areal interpolation  \\
                                                            Land cover [Discontinuous urban fabric] &amp;                  Corine land cover  &amp;                                         Copernicus Land Monitoring Service  &amp;  Vector (land cover zone polygon)  &amp;                            Areal interpolation  \\
                                                                              Land cover [Pastures] &amp;                  Corine land cover  &amp;                                         Copernicus Land Monitoring Service  &amp;  Vector (land cover zone polygon)  &amp;                            Areal interpolation  \\
                                                                   Land cover [Broad-leaved forest] &amp;                  Corine land cover  &amp;                                         Copernicus Land Monitoring Service  &amp;  Vector (land cover zone polygon)  &amp;                            Areal interpolation  \\
                                                              Land cover [Mineral extraction sites] &amp;                  Corine land cover  &amp;                                         Copernicus Land Monitoring Service  &amp;  Vector (land cover zone polygon)  &amp;                            Areal interpolation  \\
                                                                            Land cover [Port areas] &amp;                  Corine land cover  &amp;                                         Copernicus Land Monitoring Service  &amp;  Vector (land cover zone polygon)  &amp;                            Areal interpolation  \\
                                            Land cover [Road and rail networks and associated land] &amp;                  Corine land cover  &amp;                                         Copernicus Land Monitoring Service  &amp;  Vector (land cover zone polygon)  &amp;                            Areal interpolation  \\
                                                                          Land cover [Water bodies] &amp;                  Corine land cover  &amp;                                         Copernicus Land Monitoring Service  &amp;  Vector (land cover zone polygon)  &amp;                            Areal interpolation  \\
Land cover [Land principally occupied by agriculture, with significant areas of natural vegetation] &amp;                  Corine land cover  &amp;                                         Copernicus Land Monitoring Service  &amp;  Vector (land cover zone polygon)  &amp;                            Areal interpolation  \\
                                                                          Land cover [Mixed forest] &amp;                  Corine land cover  &amp;                                         Copernicus Land Monitoring Service  &amp;  Vector (land cover zone polygon)  &amp;                            Areal interpolation  \\
                                                                             Land cover [Peat bogs] &amp;                  Corine land cover  &amp;                                         Copernicus Land Monitoring Service  &amp;  Vector (land cover zone polygon)  &amp;                            Areal interpolation  \\
                                                                    Land cover [Natural grasslands] &amp;                  Corine land cover  &amp;                                         Copernicus Land Monitoring Service  &amp;  Vector (land cover zone polygon)  &amp;                            Areal interpolation  \\
                                                                   Land cover [Moors and heathland] &amp;                  Corine land cover  &amp;                                         Copernicus Land Monitoring Service  &amp;  Vector (land cover zone polygon)  &amp;                            Areal interpolation  \\
                                                           Land cover [Transitional woodland-shrub] &amp;                  Corine land cover  &amp;                                         Copernicus Land Monitoring Service  &amp;  Vector (land cover zone polygon)  &amp;                            Areal interpolation  \\
                                                               Land cover [Continuous urban fabric] &amp;                  Corine land cover  &amp;                                         Copernicus Land Monitoring Service  &amp;  Vector (land cover zone polygon)  &amp;                            Areal interpolation  \\
                                                                      Land cover [Intertidal flats] &amp;                  Corine land cover  &amp;                                         Copernicus Land Monitoring Service  &amp;  Vector (land cover zone polygon)  &amp;                            Areal interpolation  \\
                                                                         Land cover [Sea and ocean] &amp;                  Corine land cover  &amp;                                         Copernicus Land Monitoring Service  &amp;  Vector (land cover zone polygon)  &amp;                            Areal interpolation  \\
                                                                     Land cover [Coniferous forest] &amp;                  Corine land cover  &amp;                                         Copernicus Land Monitoring Service  &amp;  Vector (land cover zone polygon)  &amp;                            Areal interpolation  \\
                                                                    Land cover [Construction sites] &amp;                  Corine land cover  &amp;                                         Copernicus Land Monitoring Service  &amp;  Vector (land cover zone polygon)  &amp;                            Areal interpolation  \\
                                                              Land cover [Sparsely vegetated areas] &amp;                  Corine land cover  &amp;                                         Copernicus Land Monitoring Service  &amp;  Vector (land cover zone polygon)  &amp;                            Areal interpolation  \\
                                                                            Land cover [Bare rocks] &amp;                  Corine land cover  &amp;                                         Copernicus Land Monitoring Service  &amp;  Vector (land cover zone polygon)  &amp;                            Areal interpolation  \\
                                                                        Land cover [Inland marshes] &amp;                  Corine land cover  &amp;                                         Copernicus Land Monitoring Service  &amp;  Vector (land cover zone polygon)  &amp;                            Areal interpolation  \\
                                                                            Land cover [Dump sites] &amp;                  Corine land cover  &amp;                                         Copernicus Land Monitoring Service  &amp;  Vector (land cover zone polygon)  &amp;                            Areal interpolation  \\
                                                     Land cover [Fruit trees and berry plantations] &amp;                  Corine land cover  &amp;                                         Copernicus Land Monitoring Service  &amp;  Vector (land cover zone polygon)  &amp;                            Areal interpolation  \\
                                                          Land cover [Complex cultivation patterns] &amp;                  Corine land cover  &amp;                                         Copernicus Land Monitoring Service  &amp;  Vector (land cover zone polygon)  &amp;                            Areal interpolation  \\
                                                                 Land cover [Beaches, dunes, sands] &amp;                  Corine land cover  &amp;                                         Copernicus Land Monitoring Service  &amp;  Vector (land cover zone polygon)  &amp;                            Areal interpolation  \\
                                                                         Land cover [Water courses] &amp;                  Corine land cover  &amp;                                         Copernicus Land Monitoring Service  &amp;  Vector (land cover zone polygon)  &amp;                            Areal interpolation  \\
                                                                           Land cover [Burnt areas] &amp;                  Corine land cover  &amp;                                         Copernicus Land Monitoring Service  &amp;  Vector (land cover zone polygon)  &amp;                            Areal interpolation  \\
                                                                   Land cover [Agro-forestry areas] &amp;                  Corine land cover  &amp;                                         Copernicus Land Monitoring Service  &amp;  Vector (land cover zone polygon)  &amp;                            Areal interpolation  \\
                                                                       Land cover [Coastal lagoons] &amp;                  Corine land cover  &amp;                                         Copernicus Land Monitoring Service  &amp;  Vector (land cover zone polygon)  &amp;                            Areal interpolation  \\
                                                                                               NDVI &amp;                               NDVI  &amp;                                                    GHS-composite-S2 R2020A  &amp;                      Raster (10m)  &amp;                               Zonal statistics  \\
                                                                 Supermarkets [distance to nearest] &amp;         Retail POIs (supermarkets)  &amp;                                                                   Geolytix  &amp;                    Vector (point)  &amp;              Network-constrained accessibility  \\
                                                                 Supermarkets [counts within 1200m] &amp;         Retail POIs (supermarkets)  &amp;                                                                   Geolytix  &amp;                    Vector (point)  &amp;              Network-constrained accessibility  \\
                                                             Listed buildings [distance to nearest] &amp;                   Listed Buildings  &amp;  Historic England, Historic Environment Scotland, Lle Geo-Portal for Wales  &amp;                    Vector (point)  &amp;              Network-constrained accessibility  \\
                                                             Listed buildings [counts within 1200m] &amp;                   Listed Buildings  &amp;  Historic England, Historic Environment Scotland, Lle Geo-Portal for Wales  &amp;                    Vector (point)  &amp;              Network-constrained accessibility  \\
                                                                  FHRS points [distance to nearest] &amp; Food Hygiene Rating Scheme Ratings  &amp;                                                                 CDRC.ac.uk  &amp;                    Vector (point)  &amp;              Network-constrained accessibility  \\
                                                                  FHRS points [counts within 1200m] &amp; Food Hygiene Rating Scheme Ratings  &amp;                                                                 CDRC.ac.uk  &amp;                    Vector (point)  &amp;              Network-constrained accessibility  \\
                                                              Cultural venues [distance to nearest] &amp;        Culture (theatres, cinemas)  &amp;                                                              OpenStreetMap  &amp;                    Vector (point)  &amp;              Network-constrained accessibility  \\
                                                              Cultural venues [counts within 1200m] &amp;        Culture (theatres, cinemas)  &amp;                                                              OpenStreetMap  &amp;                    Vector (point)  &amp;              Network-constrained accessibility  \\
                                                                 Water bodies [distance to nearest] &amp;                       Water bodies  &amp;                                                           OS OpenMap Local  &amp;       Vector (water body polygon)  &amp;                        Euclidean accessibility  \\
                                                               Retail centres [distance to nearest] &amp;                     Retail centres  &amp;                                                                 CDRC.ac.uk  &amp;    Vector (retail centre polygon)  &amp;                        Euclidean accessibility  \\
\bottomrule
\end{tabular}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">functional</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;fn_krasen.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">functional</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>character</th>
      <th>data</th>
      <th>source</th>
      <th>input geometry</th>
      <th>transfer method</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Population</td>
      <td>Population estimates</td>
      <td>ONS Census Output Area population estimates, ...</td>
      <td>Vector (output area polygon)</td>
      <td>Building-based dasymetric areal interpolation</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Night lights</td>
      <td>Night Lights</td>
      <td>VIIRS DNB Nighttime Lights</td>
      <td>Raster (500m)</td>
      <td>Zonal statistics</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Workplace population [Agriculture, energy and ...</td>
      <td>Workplace population</td>
      <td>ONS Census Workplace population, Scotland's c...</td>
      <td>Vector (output area polygon)</td>
      <td>Building-based dasymetric areal interpolation</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Workplace population [Manufacturing]</td>
      <td>Workplace population</td>
      <td>ONS Census Workplace population, Scotland's c...</td>
      <td>Vector (output area polygon)</td>
      <td>Building-based dasymetric areal interpolation</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Workplace population [Construction]</td>
      <td>Workplace population</td>
      <td>ONS Census Workplace population, Scotland's c...</td>
      <td>Vector (output area polygon)</td>
      <td>Building-based dasymetric areal interpolation</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Workplace population [Distribution, hotels and...</td>
      <td>Workplace population</td>
      <td>ONS Census Workplace population, Scotland's c...</td>
      <td>Vector (output area polygon)</td>
      <td>Building-based dasymetric areal interpolation</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Workplace population [Transport and communicat...</td>
      <td>Workplace population</td>
      <td>ONS Census Workplace population, Scotland's c...</td>
      <td>Vector (output area polygon)</td>
      <td>Building-based dasymetric areal interpolation</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Workplace population [Financial, real estate, ...</td>
      <td>Workplace population</td>
      <td>ONS Census Workplace population, Scotland's c...</td>
      <td>Vector (output area polygon)</td>
      <td>Building-based dasymetric areal interpolation</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Workplace population [Public administration, e...</td>
      <td>Workplace population</td>
      <td>ONS Census Workplace population, Scotland's c...</td>
      <td>Vector (output area polygon)</td>
      <td>Building-based dasymetric areal interpolation</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Workplace population [Other]</td>
      <td>Corine land cover</td>
      <td>Copernicus Land Monitoring Service</td>
      <td>Vector (land cover zone polygon)</td>
      <td>Areal interpolation</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Land cover [Airports]</td>
      <td>Corine land cover</td>
      <td>Copernicus Land Monitoring Service</td>
      <td>Vector (land cover zone polygon)</td>
      <td>Areal interpolation</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Land cover [Non-irrigated arable land]</td>
      <td>Corine land cover</td>
      <td>Copernicus Land Monitoring Service</td>
      <td>Vector (land cover zone polygon)</td>
      <td>Areal interpolation</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Land cover [Industrial or commercial units]</td>
      <td>Corine land cover</td>
      <td>Copernicus Land Monitoring Service</td>
      <td>Vector (land cover zone polygon)</td>
      <td>Areal interpolation</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Land cover [Salt marshes]</td>
      <td>Corine land cover</td>
      <td>Copernicus Land Monitoring Service</td>
      <td>Vector (land cover zone polygon)</td>
      <td>Areal interpolation</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Land cover [Estuaries]</td>
      <td>Corine land cover</td>
      <td>Copernicus Land Monitoring Service</td>
      <td>Vector (land cover zone polygon)</td>
      <td>Areal interpolation</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Land cover [Sport and leisure facilities]</td>
      <td>Corine land cover</td>
      <td>Copernicus Land Monitoring Service</td>
      <td>Vector (land cover zone polygon)</td>
      <td>Areal interpolation</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Land cover [Green urban areas]</td>
      <td>Corine land cover</td>
      <td>Copernicus Land Monitoring Service</td>
      <td>Vector (land cover zone polygon)</td>
      <td>Areal interpolation</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Land cover [Discontinuous urban fabric]</td>
      <td>Corine land cover</td>
      <td>Copernicus Land Monitoring Service</td>
      <td>Vector (land cover zone polygon)</td>
      <td>Areal interpolation</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Land cover [Pastures]</td>
      <td>Corine land cover</td>
      <td>Copernicus Land Monitoring Service</td>
      <td>Vector (land cover zone polygon)</td>
      <td>Areal interpolation</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Land cover [Broad-leaved forest]</td>
      <td>Corine land cover</td>
      <td>Copernicus Land Monitoring Service</td>
      <td>Vector (land cover zone polygon)</td>
      <td>Areal interpolation</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Land cover [Mineral extraction sites]</td>
      <td>Corine land cover</td>
      <td>Copernicus Land Monitoring Service</td>
      <td>Vector (land cover zone polygon)</td>
      <td>Areal interpolation</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Land cover [Port areas]</td>
      <td>Corine land cover</td>
      <td>Copernicus Land Monitoring Service</td>
      <td>Vector (land cover zone polygon)</td>
      <td>Areal interpolation</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Land cover [Road and rail networks and associa...</td>
      <td>Corine land cover</td>
      <td>Copernicus Land Monitoring Service</td>
      <td>Vector (land cover zone polygon)</td>
      <td>Areal interpolation</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Land cover [Water bodies]</td>
      <td>Corine land cover</td>
      <td>Copernicus Land Monitoring Service</td>
      <td>Vector (land cover zone polygon)</td>
      <td>Areal interpolation</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Land cover [Land principally occupied by agric...</td>
      <td>Corine land cover</td>
      <td>Copernicus Land Monitoring Service</td>
      <td>Vector (land cover zone polygon)</td>
      <td>Areal interpolation</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Land cover [Mixed forest]</td>
      <td>Corine land cover</td>
      <td>Copernicus Land Monitoring Service</td>
      <td>Vector (land cover zone polygon)</td>
      <td>Areal interpolation</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Land cover [Peat bogs]</td>
      <td>Corine land cover</td>
      <td>Copernicus Land Monitoring Service</td>
      <td>Vector (land cover zone polygon)</td>
      <td>Areal interpolation</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Land cover [Natural grasslands]</td>
      <td>Corine land cover</td>
      <td>Copernicus Land Monitoring Service</td>
      <td>Vector (land cover zone polygon)</td>
      <td>Areal interpolation</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Land cover [Moors and heathland]</td>
      <td>Corine land cover</td>
      <td>Copernicus Land Monitoring Service</td>
      <td>Vector (land cover zone polygon)</td>
      <td>Areal interpolation</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Land cover [Transitional woodland-shrub]</td>
      <td>Corine land cover</td>
      <td>Copernicus Land Monitoring Service</td>
      <td>Vector (land cover zone polygon)</td>
      <td>Areal interpolation</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Land cover [Continuous urban fabric]</td>
      <td>Corine land cover</td>
      <td>Copernicus Land Monitoring Service</td>
      <td>Vector (land cover zone polygon)</td>
      <td>Areal interpolation</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Land cover [Intertidal flats]</td>
      <td>Corine land cover</td>
      <td>Copernicus Land Monitoring Service</td>
      <td>Vector (land cover zone polygon)</td>
      <td>Areal interpolation</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Land cover [Sea and ocean]</td>
      <td>Corine land cover</td>
      <td>Copernicus Land Monitoring Service</td>
      <td>Vector (land cover zone polygon)</td>
      <td>Areal interpolation</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Land cover [Coniferous forest]</td>
      <td>Corine land cover</td>
      <td>Copernicus Land Monitoring Service</td>
      <td>Vector (land cover zone polygon)</td>
      <td>Areal interpolation</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Land cover [Construction sites]</td>
      <td>Corine land cover</td>
      <td>Copernicus Land Monitoring Service</td>
      <td>Vector (land cover zone polygon)</td>
      <td>Areal interpolation</td>
    </tr>
    <tr>
      <th>35</th>
      <td>Land cover [Sparsely vegetated areas]</td>
      <td>Corine land cover</td>
      <td>Copernicus Land Monitoring Service</td>
      <td>Vector (land cover zone polygon)</td>
      <td>Areal interpolation</td>
    </tr>
    <tr>
      <th>36</th>
      <td>Land cover [Bare rocks]</td>
      <td>Corine land cover</td>
      <td>Copernicus Land Monitoring Service</td>
      <td>Vector (land cover zone polygon)</td>
      <td>Areal interpolation</td>
    </tr>
    <tr>
      <th>37</th>
      <td>Land cover [Inland marshes]</td>
      <td>Corine land cover</td>
      <td>Copernicus Land Monitoring Service</td>
      <td>Vector (land cover zone polygon)</td>
      <td>Areal interpolation</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Land cover [Dump sites]</td>
      <td>Corine land cover</td>
      <td>Copernicus Land Monitoring Service</td>
      <td>Vector (land cover zone polygon)</td>
      <td>Areal interpolation</td>
    </tr>
    <tr>
      <th>39</th>
      <td>Land cover [Fruit trees and berry plantations]</td>
      <td>Corine land cover</td>
      <td>Copernicus Land Monitoring Service</td>
      <td>Vector (land cover zone polygon)</td>
      <td>Areal interpolation</td>
    </tr>
    <tr>
      <th>40</th>
      <td>Land cover [Complex cultivation patterns]</td>
      <td>Corine land cover</td>
      <td>Copernicus Land Monitoring Service</td>
      <td>Vector (land cover zone polygon)</td>
      <td>Areal interpolation</td>
    </tr>
    <tr>
      <th>41</th>
      <td>Land cover [Beaches, dunes, sands]</td>
      <td>Corine land cover</td>
      <td>Copernicus Land Monitoring Service</td>
      <td>Vector (land cover zone polygon)</td>
      <td>Areal interpolation</td>
    </tr>
    <tr>
      <th>42</th>
      <td>Land cover [Water courses]</td>
      <td>Corine land cover</td>
      <td>Copernicus Land Monitoring Service</td>
      <td>Vector (land cover zone polygon)</td>
      <td>Areal interpolation</td>
    </tr>
    <tr>
      <th>43</th>
      <td>Land cover [Burnt areas]</td>
      <td>Corine land cover</td>
      <td>Copernicus Land Monitoring Service</td>
      <td>Vector (land cover zone polygon)</td>
      <td>Areal interpolation</td>
    </tr>
    <tr>
      <th>44</th>
      <td>Land cover [Agro-forestry areas]</td>
      <td>Corine land cover</td>
      <td>Copernicus Land Monitoring Service</td>
      <td>Vector (land cover zone polygon)</td>
      <td>Areal interpolation</td>
    </tr>
    <tr>
      <th>45</th>
      <td>Land cover [Coastal lagoons]</td>
      <td>Corine land cover</td>
      <td>Copernicus Land Monitoring Service</td>
      <td>Vector (land cover zone polygon)</td>
      <td>Areal interpolation</td>
    </tr>
    <tr>
      <th>46</th>
      <td>NDVI</td>
      <td>NDVI</td>
      <td>GHS-composite-S2 R2020A</td>
      <td>Raster (10m)</td>
      <td>Zonal statistics</td>
    </tr>
    <tr>
      <th>47</th>
      <td>Supermarkets [distance to nearest]</td>
      <td>Retail POIs (supermarkets)</td>
      <td>Geolytix</td>
      <td>Vector (point)</td>
      <td>Network-constrained accessibility</td>
    </tr>
    <tr>
      <th>48</th>
      <td>Supermarkets [counts within 1200m]</td>
      <td>Retail POIs (supermarkets)</td>
      <td>Geolytix</td>
      <td>Vector (point)</td>
      <td>Network-constrained accessibility</td>
    </tr>
    <tr>
      <th>49</th>
      <td>Listed buildings [distance to nearest]</td>
      <td>Listed Buildings</td>
      <td>Historic England, Historic Environment Scotla...</td>
      <td>Vector (point)</td>
      <td>Network-constrained accessibility</td>
    </tr>
    <tr>
      <th>50</th>
      <td>Listed buildings [counts within 1200m]</td>
      <td>Listed Buildings</td>
      <td>Historic England, Historic Environment Scotla...</td>
      <td>Vector (point)</td>
      <td>Network-constrained accessibility</td>
    </tr>
    <tr>
      <th>51</th>
      <td>FHRS points [distance to nearest]</td>
      <td>Food Hygiene Rating Scheme Ratings</td>
      <td>CDRC.ac.uk</td>
      <td>Vector (point)</td>
      <td>Network-constrained accessibility</td>
    </tr>
    <tr>
      <th>52</th>
      <td>FHRS points [counts within 1200m]</td>
      <td>Food Hygiene Rating Scheme Ratings</td>
      <td>CDRC.ac.uk</td>
      <td>Vector (point)</td>
      <td>Network-constrained accessibility</td>
    </tr>
    <tr>
      <th>53</th>
      <td>Cultural venues [distance to nearest]</td>
      <td>Culture (theatres, cinemas)</td>
      <td>OpenStreetMap</td>
      <td>Vector (point)</td>
      <td>Network-constrained accessibility</td>
    </tr>
    <tr>
      <th>54</th>
      <td>Cultural venues [counts within 1200m]</td>
      <td>Culture (theatres, cinemas)</td>
      <td>OpenStreetMap</td>
      <td>Vector (point)</td>
      <td>Network-constrained accessibility</td>
    </tr>
    <tr>
      <th>55</th>
      <td>Water bodies [distance to nearest]</td>
      <td>Water bodies</td>
      <td>OS OpenMap Local</td>
      <td>Vector (water body polygon)</td>
      <td>Euclidean accessibility</td>
    </tr>
    <tr>
      <th>56</th>
      <td>Retail centres [distance to nearest]</td>
      <td>Retail centres</td>
      <td>CDRC.ac.uk</td>
      <td>Vector (retail centre polygon)</td>
      <td>Euclidean accessibility</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">48</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">10</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>154
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">pandas</span><span class="o">.</span><span class="n">option_context</span><span class="p">(</span><span class="s2">&quot;max_colwidth&quot;</span><span class="p">,</span> <span class="mi">10000</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">pandas</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;Wild countryside&quot;</span><span class="p">:</span> <span class="s2">&quot;In “Wild countryside”, human influence is the least intensive. This signature covers large open spaces in the countryside where no urbanisation happens apart from occasional roads, cottages, and pastures. You can find it across the Scottish Highlands, numerous national parks such as Lake District, or in the majority of Wales.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Countryside agriculture&quot;</span><span class="p">:</span> <span class="s2">&quot;“Countryside agriculture” features much of the English countryside and displays a high degree of agriculture including both fields and pastures. There are a few buildings scattered across the area but, for the most part, it is green space.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Urban buffer&quot;</span><span class="p">:</span> <span class="s2">&quot;“Urban buffer” can be characterised as a green belt around cities. This signature includes mostly agricultural land in the immediate adjacency of towns and cities, often including edge development. It still feels more like countryside than urban, but these signatures are much smaller compared to other countryside types.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Open sprawl&quot;</span><span class="p">:</span> <span class="s2">&quot;“Open sprawl” represents the transition between countryside and urbanised land. It is located in the outskirts of cities or around smaller towns and is typically made up of large open space areas intertwined with different kinds of human development, from highways to smaller neighbourhoods.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Disconnected suburbia&quot;</span><span class="p">:</span> <span class="s2">&quot;“Disconnected suburbia” includes residential developments in the outskirts of cities or even towns and villages with convoluted, disconnected street networks, low built-up and population densities, and lack of jobs and services. This signature type is entirely car-dependent.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Accessible suburbia&quot;</span><span class="p">:</span> <span class="s2">&quot;“Accessible suburbia” covers residential development on the urban periphery with a relatively legible and connected street network, albeit less so than other more urban signature types. Areas in this signature feature low density, both in terms of population and built-up area, lack of jobs and services. For these reasons, “accessible suburbia” largely acts as dormitories.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Warehouse/Park land&quot;</span><span class="p">:</span> <span class="s2">&quot;“Warehouse/Park land” covers predominantly industrial areas and other work-related developments made of box-like buildings with large footprints. It contains many jobs of manual nature such as manufacturing or construction, and very little population live here compared to the rest of urban areas. Occasionally this type also covers areas of parks with large scale green open areas.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Gridded residential quarters&quot;</span><span class="p">:</span> <span class="s2">&quot;“Gridded residential quarters” are areas with street networks forming a well-connected grid-like (high density of 4-way intersections) pattern, resulting in places with smaller blocks and higher granularity. This signature is mostly residential but includes some services and jobs, and it tends to be located away from city centres.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Connected residential neighbourhoods&quot;</span><span class="p">:</span> <span class="s2">&quot;“Connected residential neighbourhoods” are relatively dense urban areas, both in terms of population and built-up area, that tend to be formed around well-connected street networks. They have access to services and some jobs but may be further away from city centres leading to higher dependency on cars and public transport for their residents.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Dense residential neighbourhoods&quot;</span><span class="p">:</span> <span class="s2">&quot;A “dense residential neighbourhood” is an abundant signature often covering large parts of cities outside of their centres. It has primarily residential purpose and high population density, varied street network patterns, and some services and jobs but not in high intensity.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Dense urban neighbourhoods&quot;</span><span class="p">:</span> <span class="s2">&quot;“Dense urban neighbourhoods” are areas of inner-city with high population and built-up density of a predominantly residential nature but with direct access to jobs and services. This signature type tends to be relatively walkable and, in the case of some towns, may even form their centres.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Local urbanity&quot;</span><span class="p">:</span> <span class="s2">&quot;“Local urbanity” reflects town centres, outer parts of city centres or even district centres. In all cases, this signature is very much urban in essence, combining high population and built-up density, access to amenities and jobs. Yet, it is on the lower end of the hierarchy of signature types denoting urban centres with only a local significance.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Regional urbanity&quot;</span><span class="p">:</span> <span class="s2">&quot;“Regional urbanity” captures centres of mid-size cities with regional importance such as Liverpool, Plymouth or Newcastle upon Tyne. It is often encircled by “Local urbanity” signatures and can form outer rings of city centres in large cities. It features high population density, as well as a high number of jobs and amenities within walkable distance.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Metropolitan urbanity&quot;</span><span class="p">:</span> <span class="s2">&quot;Signature type “Metropolitan urbanity” captures the centre of the largest cities in Great Britain such as Glasgow, Birmingham or Manchester. It is characterised by a very high number of jobs in the area, high built-up density and often high population density. This type serves as the core centre of the entire metropolitan areas.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Concentrated urbanity&quot;</span><span class="p">:</span> <span class="s2">&quot;Concentrated urbanity” is a signature type found in the city centre of London and nowhere else in Great Britain. It reflects the uniqueness of London in the British context with an extremely high number of jobs and amenities located nearby, as well as high built-up and population densities. Buildings in this signature are large and tightly packed, forming complex shapes with courtyards and little green space.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Hyper concentrated urbanity&quot;</span><span class="p">:</span> <span class="s2">&quot;The epitome of urbanity in the British context. “Hyper concentrated urbanity” is a signature type present only in the centre of London, around the Soho district, and covering Oxford and Regent streets. This signature is the result of centuries of urban primacy, with a multitude of historical layers interwoven, very high built-up and population density, and extreme abundance of amenities, services and jobs.&quot;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="p">)</span><span class="o">.</span><span class="n">to_latex</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>\begin{tabular}{ll}
\toprule
{} &amp;                                                                                                                                                                                                                                                                                                                                                                                                                             0 \\
\midrule
Wild countryside                     &amp;                                                                                       In “Wild countryside”, human influence is the least intensive. This signature covers large open spaces in the countryside where no urbanisation happens apart from occasional roads, cottages, and pastures. You can find it across the Scottish Highlands, numerous national parks such as Lake District, or in the majority of Wales. \\
Countryside agriculture              &amp;                                                                                                                                                                               “Countryside agriculture” features much of the English countryside and displays a high degree of agriculture including both fields and pastures. There are a few buildings scattered across the area but, for the most part, it is green space. \\
Urban buffer                         &amp;                                                                                             “Urban buffer” can be characterised as a green belt around cities. This signature includes mostly agricultural land in the immediate adjacency of towns and cities, often including edge development. It still feels more like countryside than urban, but these signatures are much smaller compared to other countryside types. \\
Open sprawl                          &amp;                                                                                                                           “Open sprawl” represents the transition between countryside and urbanised land. It is located in the outskirts of cities or around smaller towns and is typically made up of large open space areas intertwined with different kinds of human development, from highways to smaller neighbourhoods. \\
Disconnected suburbia                &amp;                                                                                                                                           “Disconnected suburbia” includes residential developments in the outskirts of cities or even towns and villages with convoluted, disconnected street networks, low built-up and population densities, and lack of jobs and services. This signature type is entirely car-dependent. \\
Accessible suburbia                  &amp;                                        “Accessible suburbia” covers residential development on the urban periphery with a relatively legible and connected street network, albeit less so than other more urban signature types. Areas in this signature feature low density, both in terms of population and built-up area, lack of jobs and services. For these reasons, “accessible suburbia” largely acts as dormitories. \\
Warehouse/Park land                  &amp;                                “Warehouse/Park land” covers predominantly industrial areas and other work-related developments made of box-like buildings with large footprints. It contains many jobs of manual nature such as manufacturing or construction, and very little population live here compared to the rest of urban areas. Occasionally this type also covers areas of parks with large scale green open areas. \\
Gridded residential quarters         &amp;                                                                                  “Gridded residential quarters” are areas with street networks forming a well-connected grid-like (high density of 4-way intersections) pattern, resulting in places with smaller blocks and higher granularity. This signature is mostly residential but includes some services and jobs, and it tends to be located away from city centres. \\
Connected residential neighbourhoods &amp;                                                                     “Connected residential neighbourhoods” are relatively dense urban areas, both in terms of population and built-up area, that tend to be formed around well-connected street networks. They have access to services and some jobs but may be further away from city centres leading to higher dependency on cars and public transport for their residents. \\
Dense residential neighbourhoods     &amp;                                                                                                                                           A “dense residential neighbourhood” is an abundant signature often covering large parts of cities outside of their centres. It has primarily residential purpose and high population density, varied street network patterns, and some services and jobs but not in high intensity. \\
Dense urban neighbourhoods           &amp;                                                                                                                            “Dense urban neighbourhoods” are areas of inner-city with high population and built-up density of a predominantly residential nature but with direct access to jobs and services. This signature type tends to be relatively walkable and, in the case of some towns, may even form their centres. \\
Local urbanity                       &amp;                                                                “Local urbanity” reflects town centres, outer parts of city centres or even district centres. In all cases, this signature is very much urban in essence, combining high population and built-up density, access to amenities and jobs. Yet, it is on the lower end of the hierarchy of signature types denoting urban centres with only a local significance. \\
Regional urbanity                    &amp;                                                             “Regional urbanity” captures centres of mid-size cities with regional importance such as Liverpool, Plymouth or Newcastle upon Tyne. It is often encircled by “Local urbanity” signatures and can form outer rings of city centres in large cities. It features high population density, as well as a high number of jobs and amenities within walkable distance. \\
Metropolitan urbanity                &amp;                                                                                    Signature type “Metropolitan urbanity” captures the centre of the largest cities in Great Britain such as Glasgow, Birmingham or Manchester. It is characterised by a very high number of jobs in the area, high built-up density and often high population density. This type serves as the core centre of the entire metropolitan areas. \\
Concentrated urbanity                &amp;  Concentrated urbanity” is a signature type found in the city centre of London and nowhere else in Great Britain. It reflects the uniqueness of London in the British context with an extremely high number of jobs and amenities located nearby, as well as high built-up and population densities. Buildings in this signature are large and tightly packed, forming complex shapes with courtyards and little green space. \\
Hyper concentrated urbanity          &amp;     The epitome of urbanity in the British context. “Hyper concentrated urbanity” is a signature type present only in the centre of London, around the Soho district, and covering Oxford and Regent streets. This signature is the result of centuries of urban primacy, with a multitude of historical layers interwoven, very high built-up and population density, and extreme abundance of amenities, services and jobs. \\
\bottomrule
\end{tabular}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prof</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/data_product/per_type.csv&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;code&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prof</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">prof</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">pandas</span><span class="o">.</span><span class="n">option_context</span><span class="p">(</span><span class="s2">&quot;max_colwidth&quot;</span><span class="p">,</span> <span class="mi">10000</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">prof</span><span class="o">.</span><span class="n">to_latex</span><span class="p">(</span><span class="n">float_format</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%.2f</span><span class="s2">&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>\begin{tabular}{lrrrrrrrrrrrrrrrr}
\toprule
type &amp;  Accessible suburbia &amp;  Connected residential neighbourhoods &amp;  Countryside agriculture &amp;  Dense residential neighbourhoods &amp;  Dense urban neighbourhoods &amp;  Disconnected suburbia &amp;  Concentrated urbanity &amp;  Gridded residential quarters &amp;  Hyper concentrated urbanity &amp;  Local urbanity &amp;  Metropolitan urbanity &amp;  Open sprawl &amp;  Regional urbanity &amp;  Urban buffer &amp;  Warehouse/Park land &amp;  Wild countryside \\
\midrule
area of building                                                                                    &amp;               176.95 &amp;                                272.52 &amp;                   204.10 &amp;                            375.60 &amp;                      588.36 &amp;                 212.71 &amp;                3713.38 &amp;                        283.89 &amp;                      3358.10 &amp;          823.35 &amp;                2413.94 &amp;       226.72 &amp;            1480.26 &amp;        209.42 &amp;               393.22 &amp;            209.86 \\
perimeter of building                                                                               &amp;                53.90 &amp;                                 69.12 &amp;                    56.05 &amp;                             80.56 &amp;                      107.36 &amp;                  61.63 &amp;                 376.30 &amp;                         69.67 &amp;                       330.82 &amp;          135.54 &amp;                 283.94 &amp;        59.64 &amp;             195.98 &amp;         55.94 &amp;                75.68 &amp;             57.12 \\
courtyard area of building                                                                          &amp;                 0.48 &amp;                                  1.07 &amp;                     0.51 &amp;                              2.13 &amp;                        5.03 &amp;                   0.52 &amp;                 159.09 &amp;                          0.75 &amp;                        90.82 &amp;           12.67 &amp;                 118.95 &amp;         0.90 &amp;              43.19 &amp;          0.74 &amp;                 3.26 &amp;              0.22 \\
circular compactness of building                                                                    &amp;                 0.53 &amp;                                  0.48 &amp;                     0.51 &amp;                              0.47 &amp;                        0.44 &amp;                   0.49 &amp;                   0.43 &amp;                          0.49 &amp;                         0.45 &amp;            0.41 &amp;                   0.40 &amp;         0.52 &amp;               0.39 &amp;          0.52 &amp;                 0.47 &amp;              0.50 \\
corners of building                                                                                 &amp;                 4.25 &amp;                                  4.45 &amp;                     4.37 &amp;                              4.69 &amp;                        5.21 &amp;                   4.35 &amp;                  12.48 &amp;                          4.51 &amp;                         9.27 &amp;            6.01 &amp;                   9.72 &amp;         4.37 &amp;               7.78 &amp;          4.34 &amp;                 4.56 &amp;              4.38 \\
squareness of building                                                                              &amp;                 0.78 &amp;                                  1.47 &amp;                     0.81 &amp;                              1.86 &amp;                        3.28 &amp;                   1.02 &amp;                  18.59 &amp;                          1.66 &amp;                        22.51 &amp;            5.07 &amp;                  12.41 &amp;         0.99 &amp;               8.84 &amp;          0.86 &amp;                 1.35 &amp;              0.71 \\
equivalent rectangular index of building                                                            &amp;                 0.99 &amp;                                  0.98 &amp;                     0.98 &amp;                              0.97 &amp;                        0.95 &amp;                   0.98 &amp;                   0.78 &amp;                          0.98 &amp;                         0.80 &amp;            0.92 &amp;                   0.82 &amp;         0.98 &amp;               0.87 &amp;          0.98 &amp;                 0.98 &amp;              0.98 \\
elongation of building                                                                              &amp;                 0.64 &amp;                                  0.56 &amp;                     0.60 &amp;                              0.56 &amp;                        0.52 &amp;                   0.57 &amp;                   0.59 &amp;                          0.58 &amp;                         0.62 &amp;            0.51 &amp;                   0.53 &amp;         0.62 &amp;               0.51 &amp;          0.63 &amp;                 0.54 &amp;              0.59 \\
centroid - corner mean distance of building                                                         &amp;                 9.60 &amp;                                 12.41 &amp;                     9.79 &amp;                             13.96 &amp;                       18.00 &amp;                  11.11 &amp;                  35.93 &amp;                         12.41 &amp;                        37.22 &amp;           20.71 &amp;                  29.68 &amp;        10.49 &amp;              25.25 &amp;          9.81 &amp;                13.20 &amp;              9.95 \\
centroid - corner distance deviation of building                                                    &amp;                 0.36 &amp;                                  0.71 &amp;                     0.56 &amp;                              1.07 &amp;                        1.88 &amp;                   0.54 &amp;                   9.03 &amp;                          0.80 &amp;                         7.70 &amp;            2.98 &amp;                   6.78 &amp;         0.55 &amp;               4.98 &amp;          0.49 &amp;                 0.88 &amp;              0.60 \\
orientation of building                                                                             &amp;                19.56 &amp;                                 25.50 &amp;                    20.57 &amp;                             16.41 &amp;                       20.64 &amp;                  26.39 &amp;                  20.32 &amp;                         23.13 &amp;                        26.26 &amp;           20.78 &amp;                  22.30 &amp;        20.21 &amp;              21.82 &amp;         21.10 &amp;                23.30 &amp;             21.86 \\
longest axis length of ETC                                                                          &amp;                50.84 &amp;                                 57.72 &amp;                   220.30 &amp;                             64.46 &amp;                       73.56 &amp;                  53.55 &amp;                 112.12 &amp;                         52.89 &amp;                       126.58 &amp;           80.14 &amp;                 100.52 &amp;        60.97 &amp;              91.91 &amp;        105.16 &amp;                78.67 &amp;            449.71 \\
area of ETC                                                                                         &amp;              1147.25 &amp;                               1517.81 &amp;                 31193.48 &amp;                           1917.31 &amp;                     2410.32 &amp;                1259.03 &amp;                5708.23 &amp;                       1251.54 &amp;                      8654.32 &amp;         2696.40 &amp;                4442.21 &amp;      2000.37 &amp;            3535.28 &amp;       8658.83 &amp;              3520.84 &amp;         155623.92 \\
circular compactness of ETC                                                                         &amp;                 0.47 &amp;                                  0.48 &amp;                     0.38 &amp;                              0.48 &amp;                        0.47 &amp;                   0.49 &amp;                   0.46 &amp;                          0.48 &amp;                         0.47 &amp;            0.46 &amp;                   0.42 &amp;         0.47 &amp;               0.44 &amp;          0.44 &amp;                 0.46 &amp;              0.35 \\
equivalent rectangular index of ETC                                                                 &amp;                 0.97 &amp;                                  0.97 &amp;                     0.93 &amp;                              0.96 &amp;                        0.96 &amp;                   0.97 &amp;                   0.94 &amp;                          0.97 &amp;                         0.95 &amp;            0.95 &amp;                   0.93 &amp;         0.97 &amp;               0.94 &amp;          0.95 &amp;                 0.96 &amp;              0.91 \\
orientation of ETC                                                                                  &amp;                20.40 &amp;                                 24.94 &amp;                    21.92 &amp;                             17.77 &amp;                       21.07 &amp;                  25.28 &amp;                  20.37 &amp;                         23.06 &amp;                        25.96 &amp;           21.22 &amp;                  22.38 &amp;        21.07 &amp;              21.88 &amp;         21.86 &amp;                23.27 &amp;             22.51 \\
covered area ratio of ETC                                                                           &amp;                 0.19 &amp;                                  0.20 &amp;                     0.07 &amp;                              0.52 &amp;                        0.27 &amp;                   0.22 &amp;                   0.91 &amp;                          0.23 &amp;                         0.61 &amp;            0.60 &amp;                   4.85 &amp;         0.18 &amp;            1122.51 &amp;          0.14 &amp;                 0.18 &amp;              0.04 \\
cell alignment of building                                                                          &amp;                 7.38 &amp;                                  6.12 &amp;                    11.49 &amp;                              6.52 &amp;                        5.61 &amp;                   8.08 &amp;                   4.43 &amp;                          5.48 &amp;                         2.72 &amp;            5.64 &amp;                   4.86 &amp;         8.64 &amp;               5.25 &amp;          9.76 &amp;                 8.03 &amp;             12.55 \\
alignment of neighbouring buildings                                                                 &amp;                 5.31 &amp;                                  5.36 &amp;                     8.45 &amp;                              5.39 &amp;                        5.17 &amp;                   5.67 &amp;                   5.95 &amp;                          4.93 &amp;                         6.55 &amp;            5.67 &amp;                   6.37 &amp;         6.48 &amp;               6.27 &amp;          7.06 &amp;                 6.06 &amp;             10.05 \\
mean distance between neighbouring buildings                                                        &amp;                17.82 &amp;                                 19.17 &amp;                   111.38 &amp;                             20.84 &amp;                       21.13 &amp;                  18.63 &amp;                  18.96 &amp;                         16.48 &amp;                        22.95 &amp;           20.62 &amp;                  22.33 &amp;        22.13 &amp;              20.94 &amp;         45.37 &amp;                28.71 &amp;            238.45 \\
perimeter-weighted neighbours of ETC                                                                &amp;                 0.04 &amp;                                  0.04 &amp;                     0.02 &amp;                              0.04 &amp;                        0.07 &amp;                   0.05 &amp;                   0.03 &amp;                          0.04 &amp;                         0.04 &amp;            0.11 &amp;                   0.04 &amp;         0.06 &amp;               7.46 &amp;          0.13 &amp;                 0.04 &amp;              0.01 \\
area covered by neighbouring cells                                                                  &amp;              8620.11 &amp;                              11990.46 &amp;                277883.95 &amp;                          15619.36 &amp;                    20375.37 &amp;                9503.57 &amp;               52023.10 &amp;                       9962.17 &amp;                     61122.40 &amp;        22892.04 &amp;               39665.51 &amp;     16780.98 &amp;           31594.99 &amp;      76942.43 &amp;             31956.96 &amp;        1485709.28 \\
weighted reached enclosures of ETC                                                                  &amp;                 0.00 &amp;                                  0.00 &amp;                     0.00 &amp;                              0.00 &amp;                        0.00 &amp;                   0.00 &amp;                   0.00 &amp;                          0.00 &amp;                         0.00 &amp;            0.00 &amp;                   0.00 &amp;         0.00 &amp;               0.00 &amp;          0.00 &amp;                 0.00 &amp;              0.00 \\
mean inter-building distance                                                                        &amp;                21.97 &amp;                                 24.07 &amp;                   167.60 &amp;                             26.48 &amp;                       27.37 &amp;                  22.03 &amp;                  22.73 &amp;                         21.34 &amp;                        23.74 &amp;           26.28 &amp;                  26.99 &amp;        28.94 &amp;              26.32 &amp;         67.27 &amp;                40.97 &amp;            367.72 \\
width of street profile                                                                             &amp;                28.38 &amp;                                 26.84 &amp;                    32.84 &amp;                             26.29 &amp;                       24.84 &amp;                  27.65 &amp;                  19.47 &amp;                         24.27 &amp;                        17.47 &amp;           24.56 &amp;                  22.61 &amp;        28.59 &amp;              23.44 &amp;         31.00 &amp;                30.85 &amp;             34.31 \\
width deviation of street profile                                                                   &amp;                 3.30 &amp;                                  3.27 &amp;                     3.91 &amp;                              3.50 &amp;                        3.45 &amp;                   3.71 &amp;                   3.29 &amp;                          3.87 &amp;                         2.85 &amp;            3.60 &amp;                   3.50 &amp;         3.74 &amp;               3.62 &amp;          3.76 &amp;                 3.26 &amp;              3.41 \\
openness of street profile                                                                          &amp;                 0.42 &amp;                                  0.41 &amp;                     0.83 &amp;                              0.43 &amp;                        0.41 &amp;                   0.44 &amp;                   0.28 &amp;                          0.38 &amp;                         0.22 &amp;            0.41 &amp;                   0.37 &amp;         0.48 &amp;               0.39 &amp;          0.62 &amp;                 0.53 &amp;              0.92 \\
length of street segment                                                                            &amp;               187.61 &amp;                                162.45 &amp;                   574.25 &amp;                            153.66 &amp;                      151.58 &amp;                 150.53 &amp;                 108.90 &amp;                        126.02 &amp;                        93.90 &amp;          143.14 &amp;                 123.30 &amp;       183.43 &amp;             132.18 &amp;        333.77 &amp;               220.94 &amp;            842.79 \\
linearity of street segment                                                                         &amp;                 0.93 &amp;                                  0.94 &amp;                     0.93 &amp;                              0.92 &amp;                        0.93 &amp;                   0.92 &amp;                   0.94 &amp;                          0.94 &amp;                         0.97 &amp;            0.92 &amp;                   0.93 &amp;         0.90 &amp;               0.92 &amp;          0.91 &amp;                 0.91 &amp;              0.91 \\
mean segment length within 3 steps                                                                  &amp;              2327.31 &amp;                               2374.39 &amp;                  5884.25 &amp;                           1992.44 &amp;                     2113.58 &amp;                1707.52 &amp;                1944.94 &amp;                       1950.07 &amp;                      2057.70 &amp;         2011.42 &amp;                2112.12 &amp;      1862.02 &amp;            2034.72 &amp;       3170.78 &amp;              2339.74 &amp;           8062.03 \\
node degree of junction                                                                             &amp;                 2.87 &amp;                                  3.00 &amp;                     2.78 &amp;                              2.89 &amp;                        2.94 &amp;                   2.68 &amp;                   3.12 &amp;                          3.04 &amp;                         3.33 &amp;            2.94 &amp;                   3.14 &amp;         2.68 &amp;               3.01 &amp;          2.70 &amp;                 2.77 &amp;              2.69 \\
local meshedness of street network                                                                  &amp;                 0.08 &amp;                                  0.11 &amp;                     0.06 &amp;                              0.10 &amp;                        0.11 &amp;                   0.05 &amp;                   0.14 &amp;                          0.13 &amp;                         0.17 &amp;            0.11 &amp;                   0.14 &amp;         0.06 &amp;               0.12 &amp;          0.05 &amp;                 0.08 &amp;              0.05 \\
local proportion of 3-way intersections of street network                                           &amp;                 0.74 &amp;                                  0.74 &amp;                     0.72 &amp;                              0.74 &amp;                        0.74 &amp;                   0.71 &amp;                   0.76 &amp;                          0.72 &amp;                         0.70 &amp;            0.75 &amp;                   0.75 &amp;         0.71 &amp;               0.76 &amp;          0.71 &amp;                 0.75 &amp;              0.68 \\
local proportion of 4-way intersections of street network                                           &amp;                 0.07 &amp;                                  0.12 &amp;                     0.04 &amp;                              0.09 &amp;                        0.11 &amp;                   0.04 &amp;                   0.15 &amp;                          0.16 &amp;                         0.23 &amp;            0.11 &amp;                   0.17 &amp;         0.04 &amp;               0.13 &amp;          0.04 &amp;                 0.05 &amp;              0.04 \\
local proportion of cul-de-sacs of street network                                                   &amp;                 0.19 &amp;                                  0.14 &amp;                     0.24 &amp;                              0.17 &amp;                        0.14 &amp;                   0.25 &amp;                   0.09 &amp;                          0.12 &amp;                         0.06 &amp;            0.14 &amp;                   0.08 &amp;         0.25 &amp;               0.11 &amp;          0.25 &amp;                 0.20 &amp;              0.28 \\
local closeness of street network                                                                   &amp;                 0.00 &amp;                                  0.00 &amp;                     0.00 &amp;                              0.00 &amp;                        0.00 &amp;                   0.00 &amp;                   0.00 &amp;                          0.00 &amp;                         0.00 &amp;            0.00 &amp;                   0.00 &amp;         0.00 &amp;               0.00 &amp;          0.00 &amp;                 0.00 &amp;              0.00 \\
local cul-de-sac length of street network                                                           &amp;               228.58 &amp;                                163.78 &amp;                   636.07 &amp;                            196.63 &amp;                      170.89 &amp;                 275.96 &amp;                  84.41 &amp;                        133.13 &amp;                        75.11 &amp;          167.72 &amp;                  79.56 &amp;       288.26 &amp;             128.76 &amp;        408.67 &amp;               253.49 &amp;           1186.52 \\
square clustering of street network                                                                 &amp;                 0.03 &amp;                                  0.04 &amp;                     0.01 &amp;                              0.03 &amp;                        0.04 &amp;                   0.01 &amp;                   0.03 &amp;                          0.04 &amp;                         0.04 &amp;            0.03 &amp;                   0.04 &amp;         0.02 &amp;               0.03 &amp;          0.02 &amp;                 0.03 &amp;              0.01 \\
mean distance to neighbouring nodes of street network                                               &amp;               132.49 &amp;                                118.06 &amp;                   373.74 &amp;                            112.48 &amp;                      111.55 &amp;                 111.69 &amp;                  86.38 &amp;                         92.19 &amp;                        81.24 &amp;          106.90 &amp;                  93.66 &amp;       129.03 &amp;              99.79 &amp;        212.34 &amp;               150.43 &amp;            601.60 \\
local node density of street network                                                                &amp;                 0.02 &amp;                                  0.02 &amp;                     0.01 &amp;                              0.02 &amp;                        0.02 &amp;                   0.03 &amp;                   0.02 &amp;                          0.02 &amp;                         0.02 &amp;            0.02 &amp;                   0.02 &amp;         0.03 &amp;               0.02 &amp;          0.02 &amp;                 0.02 &amp;              0.01 \\
local degree weighted node density of street network                                                &amp;                 0.03 &amp;                                  0.03 &amp;                     0.02 &amp;                              0.04 &amp;                        0.04 &amp;                   0.04 &amp;                   0.04 &amp;                          0.04 &amp;                         0.04 &amp;            0.04 &amp;                   0.04 &amp;         0.04 &amp;               0.04 &amp;          0.03 &amp;                 0.03 &amp;              0.01 \\
street alignment of building                                                                        &amp;                 8.73 &amp;                                  7.53 &amp;                    11.81 &amp;                              8.25 &amp;                        7.57 &amp;                   9.98 &amp;                   7.84 &amp;                          6.95 &amp;                         6.23 &amp;            8.05 &amp;                   8.32 &amp;        10.97 &amp;               8.06 &amp;         11.33 &amp;                10.02 &amp;             12.77 \\
area covered by node-attached ETCs                                                                  &amp;             22426.36 &amp;                              14599.22 &amp;                286081.33 &amp;                          14037.94 &amp;                    13513.86 &amp;               15656.96 &amp;               13069.71 &amp;                       9488.11 &amp;                     20051.57 &amp;        11878.66 &amp;               13201.87 &amp;     25443.99 &amp;           12080.93 &amp;     100470.30 &amp;             33097.00 &amp;        1215083.95 \\
area covered by edge-attached ETCs                                                                  &amp;             36496.96 &amp;                              24423.69 &amp;                502883.47 &amp;                          25413.44 &amp;                    26111.44 &amp;               26810.65 &amp;               33257.27 &amp;                      17094.77 &amp;                     38566.99 &amp;        25905.75 &amp;               31497.77 &amp;     47178.87 &amp;           29440.27 &amp;     188719.66 &amp;             66614.68 &amp;        2174736.93 \\
buildings per meter of street segment                                                               &amp;                 0.11 &amp;                                  0.08 &amp;                     0.05 &amp;                              0.08 &amp;                        0.07 &amp;                   0.10 &amp;                   0.05 &amp;                          0.09 &amp;                         0.05 &amp;            0.06 &amp;                   0.05 &amp;         0.10 &amp;               0.05 &amp;          0.09 &amp;                 0.07 &amp;              0.02 \\
reached ETCs by neighbouring segments                                                               &amp;                49.09 &amp;                                 33.99 &amp;                    38.08 &amp;                             26.79 &amp;                       21.56 &amp;                  32.35 &amp;                   8.88 &amp;                         26.76 &amp;                         8.57 &amp;           16.97 &amp;                  11.04 &amp;        35.17 &amp;              13.53 &amp;         43.96 &amp;                30.27 &amp;             26.08 \\
reached area by neighbouring segments                                                               &amp;            113290.06 &amp;                              88462.74 &amp;               1591397.39 &amp;                          89313.79 &amp;                    97515.74 &amp;               84060.33 &amp;              145420.68 &amp;                      64059.40 &amp;                    151507.35 &amp;       100616.06 &amp;              132683.99 &amp;    140813.94 &amp;          119718.73 &amp;     556190.10 &amp;            211678.46 &amp;        5556960.68 \\
reached ETCs by local street network                                                                &amp;               166.98 &amp;                                126.07 &amp;                   110.89 &amp;                             90.93 &amp;                       74.36 &amp;                 102.39 &amp;                  28.79 &amp;                         99.87 &amp;                        27.00 &amp;           56.17 &amp;                  36.29 &amp;       103.45 &amp;              43.97 &amp;        123.39 &amp;                93.33 &amp;             71.94 \\
reached area by local street network                                                                &amp;            451276.21 &amp;                             390719.33 &amp;               5858316.88 &amp;                         369240.03 &amp;                   416784.68 &amp;              316062.25 &amp;              703631.50 &amp;                     296524.52 &amp;                    621126.10 &amp;       439804.09 &amp;              643746.00 &amp;    506987.49 &amp;          540975.07 &amp;    1982158.35 &amp;            794621.33 &amp;       17403052.98 \\
reached ETCs by tessellation contiguity                                                             &amp;                36.80 &amp;                                 40.24 &amp;                    46.23 &amp;                             43.10 &amp;                       45.61 &amp;                  39.57 &amp;                  53.52 &amp;                         42.04 &amp;                        48.46 &amp;           47.29 &amp;                  51.81 &amp;        41.55 &amp;              51.95 &amp;         43.57 &amp;                42.93 &amp;             47.56 \\
reached area by tessellation contiguity                                                             &amp;             60511.46 &amp;                              87537.63 &amp;               2410926.40 &amp;                         115962.63 &amp;                   152810.21 &amp;               63671.98 &amp;              372984.21 &amp;                      73335.07 &amp;                    306427.88 &amp;       173857.48 &amp;              302746.84 &amp;    136577.35 &amp;          238390.55 &amp;     692699.47 &amp;            297667.66 &amp;       14081627.81 \\
area of enclosure                                                                                   &amp;            242778.35 &amp;                              95677.02 &amp;               3591565.15 &amp;                         133719.21 &amp;                   105561.74 &amp;              282930.77 &amp;               28859.85 &amp;                     110195.65 &amp;                     31788.41 &amp;        83656.67 &amp;               29460.25 &amp;    640071.17 &amp;           63476.79 &amp;    1854684.23 &amp;            430998.35 &amp;       44036373.80 \\
perimeter of enclosure                                                                              &amp;              2046.29 &amp;                               1360.81 &amp;                  7599.46 &amp;                           1693.62 &amp;                     1463.16 &amp;                2380.50 &amp;                 683.27 &amp;                       1150.58 &amp;                       538.87 &amp;         1299.32 &amp;                 671.29 &amp;      3793.33 &amp;            1009.07 &amp;       5664.05 &amp;              2992.30 &amp;          21952.84 \\
circular compactness of enclosure                                                                   &amp;                 0.40 &amp;                                  0.39 &amp;                     0.40 &amp;                              0.38 &amp;                        0.38 &amp;                   0.42 &amp;                   0.44 &amp;                          0.41 &amp;                         0.45 &amp;            0.39 &amp;                   0.40 &amp;         0.38 &amp;               0.40 &amp;          0.39 &amp;                 0.38 &amp;              0.38 \\
equivalent rectangular index of enclosure                                                           &amp;                 0.85 &amp;                                  0.87 &amp;                     0.84 &amp;                              0.84 &amp;                        0.86 &amp;                   0.83 &amp;                   0.91 &amp;                          0.89 &amp;                         0.94 &amp;            0.85 &amp;                   0.89 &amp;         0.77 &amp;               0.87 &amp;          0.80 &amp;                 0.80 &amp;              0.79 \\
compactness-weighted axis of enclosure                                                              &amp;               515.77 &amp;                                344.74 &amp;                  1777.66 &amp;                            441.16 &amp;                      397.37 &amp;                 567.78 &amp;                 144.75 &amp;                        289.81 &amp;                       120.13 &amp;          345.64 &amp;                 153.64 &amp;       986.37 &amp;             249.05 &amp;       1434.02 &amp;               780.52 &amp;           5069.06 \\
orientation of enclosure                                                                            &amp;                19.24 &amp;                                 25.62 &amp;                    21.39 &amp;                             16.18 &amp;                       20.88 &amp;                  27.07 &amp;                  20.23 &amp;                         23.04 &amp;                        24.93 &amp;           21.09 &amp;                  21.77 &amp;        20.39 &amp;              22.00 &amp;         21.52 &amp;                24.08 &amp;             22.66 \\
perimeter-weighted neighbours of enclosure                                                          &amp;                 0.01 &amp;                                  0.01 &amp;                     0.01 &amp;                              0.02 &amp;                        0.08 &amp;                   0.02 &amp;                   0.04 &amp;                          0.02 &amp;                         0.08 &amp;            0.12 &amp;                   0.06 &amp;         0.05 &amp;               9.94 &amp;          0.11 &amp;                 0.01 &amp;              0.01 \\
area-weighted ETCs of enclosure                                                                     &amp;                36.32 &amp;                                  2.82 &amp;                   746.28 &amp;                              3.03 &amp;                        4.63 &amp;             2137242.86 &amp;                   0.00 &amp;                          0.43 &amp;                         0.00 &amp;            0.14 &amp;                   0.01 &amp;    330422.61 &amp;               0.01 &amp; 1178106554.77 &amp;            627879.43 &amp;        2270509.66 \\
Population                                                                                          &amp;                 4.51 &amp;                                  8.57 &amp;                     1.91 &amp;                             10.02 &amp;                       17.52 &amp;                   6.55 &amp;                  36.91 &amp;                          7.74 &amp;                        37.93 &amp;           28.87 &amp;                  43.70 &amp;         5.06 &amp;              42.99 &amp;          3.43 &amp;                 6.93 &amp;              1.31 \\
Night lights                                                                                        &amp;                11.02 &amp;                                 19.99 &amp;                     1.39 &amp;                             22.63 &amp;                       34.74 &amp;                  12.35 &amp;                 115.70 &amp;                         15.17 &amp;                       183.23 &amp;           51.19 &amp;                  87.38 &amp;        10.96 &amp;              67.53 &amp;          5.08 &amp;                18.29 &amp;              0.48 \\
Workplace population [Agriculture, energy and water]                                                &amp;                 0.01 &amp;                                  0.03 &amp;                     0.08 &amp;                              0.07 &amp;                        0.11 &amp;                   0.02 &amp;                   2.44 &amp;                          0.03 &amp;                         1.41 &amp;            0.18 &amp;                   1.01 &amp;         0.04 &amp;               0.39 &amp;          0.05 &amp;                 0.10 &amp;              0.11 \\
Workplace population [Manufacturing]                                                                &amp;                 0.12 &amp;                                  0.29 &amp;                     0.22 &amp;                              0.64 &amp;                        1.10 &amp;                   0.21 &amp;                  12.80 &amp;                          0.36 &amp;                        20.14 &amp;            1.32 &amp;                   4.18 &amp;         0.42 &amp;               2.03 &amp;          0.38 &amp;                 1.25 &amp;              0.09 \\
Workplace population [Construction]                                                                 &amp;                 0.12 &amp;                                  0.22 &amp;                     0.10 &amp;                              0.33 &amp;                        0.56 &amp;                   0.18 &amp;                   9.16 &amp;                          0.20 &amp;                        10.68 &amp;            0.80 &amp;                   3.80 &amp;         0.17 &amp;               1.40 &amp;          0.14 &amp;                 0.34 &amp;              0.07 \\
Workplace population [Distribution, hotels and restaurants]                                         &amp;                 0.21 &amp;                                  0.61 &amp;                     0.19 &amp;                              1.17 &amp;                        2.30 &amp;                   0.38 &amp;                  54.16 &amp;                          0.73 &amp;                       152.31 &amp;            4.16 &amp;                  22.76 &amp;         0.45 &amp;              11.90 &amp;          0.32 &amp;                 1.00 &amp;              0.12 \\
Workplace population [Transport and communication]                                                  &amp;                 0.07 &amp;                                  0.21 &amp;                     0.07 &amp;                              0.41 &amp;                        0.88 &amp;                   0.13 &amp;                  39.51 &amp;                          0.18 &amp;                        97.90 &amp;            1.96 &amp;                  18.93 &amp;         0.16 &amp;               5.70 &amp;          0.14 &amp;                 0.51 &amp;              0.04 \\
Workplace population [Financial, real estate, professional and administrative activities]           &amp;                 0.15 &amp;                                  0.40 &amp;                     0.13 &amp;                              0.78 &amp;                        1.81 &amp;                   0.26 &amp;                 258.67 &amp;                          0.38 &amp;                       172.75 &amp;            4.89 &amp;                  65.30 &amp;         0.27 &amp;              16.45 &amp;          0.21 &amp;                 0.61 &amp;              0.06 \\
Workplace population [Public administration, education and health]                                  &amp;                 0.43 &amp;                                  0.94 &amp;                     0.22 &amp;                              1.67 &amp;                        3.21 &amp;                   0.59 &amp;                  41.70 &amp;                          0.98 &amp;                        30.82 &amp;            5.71 &amp;                  42.90 &amp;         0.59 &amp;              14.50 &amp;          0.39 &amp;                 1.06 &amp;              0.12 \\
Workplace population [Other]                                                                        &amp;                 0.06 &amp;                                  0.15 &amp;                     0.05 &amp;                              0.26 &amp;                        0.56 &amp;                   0.10 &amp;                  23.06 &amp;                          0.17 &amp;                        38.16 &amp;            1.14 &amp;                   8.74 &amp;         0.09 &amp;               3.40 &amp;          0.07 &amp;                 0.16 &amp;              0.03 \\
Land cover [Airports]                                                                               &amp;                 0.00 &amp;                                  0.00 &amp;                     0.00 &amp;                              0.00 &amp;                        0.00 &amp;                   0.00 &amp;                   0.00 &amp;                          0.00 &amp;                         0.00 &amp;            0.00 &amp;                   0.00 &amp;         0.00 &amp;               0.00 &amp;          0.00 &amp;                 0.00 &amp;              0.00 \\
Land cover [Non-irrigated arable land]                                                              &amp;                 0.00 &amp;                                  0.00 &amp;                     0.35 &amp;                              0.00 &amp;                        0.00 &amp;                   0.00 &amp;                   0.00 &amp;                          0.00 &amp;                         0.00 &amp;            0.00 &amp;                   0.00 &amp;         0.01 &amp;               0.00 &amp;          0.11 &amp;                 0.02 &amp;              0.15 \\
Land cover [Industrial or commercial units]                                                         &amp;                 0.00 &amp;                                  0.02 &amp;                     0.01 &amp;                              0.05 &amp;                        0.09 &amp;                   0.01 &amp;                   0.00 &amp;                          0.00 &amp;                         0.00 &amp;            0.09 &amp;                   0.01 &amp;         0.03 &amp;               0.06 &amp;          0.03 &amp;                 0.14 &amp;              0.00 \\
Land cover [Salt marshes]                                                                           &amp;                 0.00 &amp;                                  0.00 &amp;                     0.00 &amp;                              0.00 &amp;                        0.00 &amp;                   0.00 &amp;                   0.00 &amp;                          0.00 &amp;                         0.01 &amp;            0.00 &amp;                   0.00 &amp;         0.00 &amp;               0.00 &amp;          0.00 &amp;                 0.00 &amp;              0.00 \\
Land cover [Estuaries]                                                                              &amp;                 0.00 &amp;                                  0.00 &amp;                     0.00 &amp;                              0.00 &amp;                        0.00 &amp;                   0.00 &amp;                   0.00 &amp;                          0.00 &amp;                         0.00 &amp;            0.00 &amp;                   0.00 &amp;         0.00 &amp;               0.00 &amp;          0.00 &amp;                 0.00 &amp;              0.00 \\
Land cover [Sport and leisure facilities]                                                           &amp;                 0.00 &amp;                                  0.00 &amp;                     0.02 &amp;                              0.00 &amp;                        0.00 &amp;                   0.00 &amp;                   0.00 &amp;                          0.00 &amp;                         0.00 &amp;            0.00 &amp;                   0.00 &amp;         0.01 &amp;               0.00 &amp;          0.02 &amp;                 0.01 &amp;              0.01 \\
Land cover [Green urban areas]                                                                      &amp;                 0.01 &amp;                                  0.01 &amp;                     0.00 &amp;                              0.01 &amp;                        0.01 &amp;                   0.00 &amp;                   0.03 &amp;                          0.00 &amp;                         0.00 &amp;            0.01 &amp;                   0.03 &amp;         0.01 &amp;               0.01 &amp;          0.00 &amp;                 0.02 &amp;              0.00 \\
Land cover [Discontinuous urban fabric]                                                             &amp;                 0.98 &amp;                                  0.95 &amp;                     0.20 &amp;                              0.88 &amp;                        0.75 &amp;                   0.98 &amp;                   0.06 &amp;                          0.92 &amp;                         0.00 &amp;            0.63 &amp;                   0.08 &amp;         0.91 &amp;               0.34 &amp;          0.68 &amp;                 0.77 &amp;              0.03 \\
Land cover [Pastures]                                                                               &amp;                 0.00 &amp;                                  0.00 &amp;                     0.36 &amp;                              0.00 &amp;                        0.00 &amp;                   0.00 &amp;                   0.00 &amp;                          0.00 &amp;                         0.02 &amp;            0.00 &amp;                   0.00 &amp;         0.02 &amp;               0.00 &amp;          0.12 &amp;                 0.02 &amp;              0.59 \\
Land cover [Broad-leaved forest]                                                                    &amp;                 0.00 &amp;                                  0.00 &amp;                     0.02 &amp;                              0.00 &amp;                        0.00 &amp;                   0.00 &amp;                   0.00 &amp;                          0.00 &amp;                         0.00 &amp;            0.00 &amp;                   0.00 &amp;         0.00 &amp;               0.00 &amp;          0.01 &amp;                 0.00 &amp;              0.03 \\
Land cover [Mineral extraction sites]                                                               &amp;                 0.00 &amp;                                  0.00 &amp;                     0.00 &amp;                              0.00 &amp;                        0.00 &amp;                   0.00 &amp;                   0.00 &amp;                          0.00 &amp;                         0.00 &amp;            0.00 &amp;                   0.00 &amp;         0.00 &amp;               0.00 &amp;          0.00 &amp;                 0.00 &amp;              0.00 \\
Land cover [Port areas]                                                                             &amp;                 0.00 &amp;                                  0.00 &amp;                     0.00 &amp;                              0.00 &amp;                        0.01 &amp;                   0.00 &amp;                   0.00 &amp;                          0.00 &amp;                         0.00 &amp;            0.01 &amp;                   0.00 &amp;         0.00 &amp;               0.01 &amp;          0.00 &amp;                 0.01 &amp;              0.00 \\
Land cover [Road and rail networks and associated land]                                             &amp;                 0.00 &amp;                                  0.00 &amp;                     0.00 &amp;                              0.00 &amp;                        0.00 &amp;                   0.00 &amp;                   0.00 &amp;                          0.00 &amp;                         0.00 &amp;            0.00 &amp;                   0.00 &amp;         0.00 &amp;               0.00 &amp;          0.00 &amp;                 0.00 &amp;              0.00 \\
Land cover [Water bodies]                                                                           &amp;                 0.00 &amp;                                  0.00 &amp;                     0.00 &amp;                              0.00 &amp;                        0.00 &amp;                   0.00 &amp;                   0.00 &amp;                          0.00 &amp;                         0.00 &amp;            0.00 &amp;                   0.00 &amp;         0.00 &amp;               0.00 &amp;          0.00 &amp;                 0.00 &amp;              0.00 \\
Land cover [Land principally occupied by agriculture, with significant areas of natural vegetation] &amp;                 0.00 &amp;                                  0.00 &amp;                     0.01 &amp;                              0.00 &amp;                        0.00 &amp;                   0.00 &amp;                   0.00 &amp;                          0.00 &amp;                         0.00 &amp;            0.00 &amp;                   0.00 &amp;         0.00 &amp;               0.00 &amp;          0.00 &amp;                 0.00 &amp;              0.01 \\
Land cover [Mixed forest]                                                                           &amp;                 0.00 &amp;                                  0.00 &amp;                     0.01 &amp;                              0.00 &amp;                        0.00 &amp;                   0.00 &amp;                   0.00 &amp;                          0.00 &amp;                         0.00 &amp;            0.00 &amp;                   0.00 &amp;         0.00 &amp;               0.00 &amp;          0.00 &amp;                 0.00 &amp;              0.02 \\
Land cover [Peat bogs]                                                                              &amp;                 0.00 &amp;                                  0.00 &amp;                     0.00 &amp;                              0.00 &amp;                        0.00 &amp;                   0.00 &amp;                   0.00 &amp;                          0.00 &amp;                         0.00 &amp;            0.00 &amp;                   0.00 &amp;         0.00 &amp;               0.00 &amp;          0.00 &amp;                 0.00 &amp;              0.02 \\
Land cover [Natural grasslands]                                                                     &amp;                 0.00 &amp;                                  0.00 &amp;                     0.00 &amp;                              0.00 &amp;                        0.00 &amp;                   0.00 &amp;                   0.00 &amp;                          0.00 &amp;                         0.00 &amp;            0.00 &amp;                   0.00 &amp;         0.00 &amp;               0.00 &amp;          0.00 &amp;                 0.00 &amp;              0.04 \\
Land cover [Moors and heathland]                                                                    &amp;                 0.00 &amp;                                  0.00 &amp;                     0.00 &amp;                              0.00 &amp;                        0.00 &amp;                   0.00 &amp;                   0.00 &amp;                          0.00 &amp;                         0.00 &amp;            0.00 &amp;                   0.00 &amp;         0.00 &amp;               0.00 &amp;          0.00 &amp;                 0.00 &amp;              0.04 \\
Land cover [Transitional woodland-shrub]                                                            &amp;                 0.00 &amp;                                  0.00 &amp;                     0.00 &amp;                              0.00 &amp;                        0.00 &amp;                   0.00 &amp;                   0.00 &amp;                          0.00 &amp;                         0.00 &amp;            0.00 &amp;                   0.00 &amp;         0.00 &amp;               0.00 &amp;          0.00 &amp;                 0.00 &amp;              0.01 \\
Land cover [Continuous urban fabric]                                                                &amp;                 0.00 &amp;                                  0.02 &amp;                     0.00 &amp;                              0.04 &amp;                        0.13 &amp;                   0.00 &amp;                   0.90 &amp;                          0.07 &amp;                         0.97 &amp;            0.25 &amp;                   0.88 &amp;         0.00 &amp;               0.57 &amp;          0.00 &amp;                 0.00 &amp;              0.00 \\
Land cover [Intertidal flats]                                                                       &amp;                 0.00 &amp;                                  0.00 &amp;                     0.00 &amp;                              0.00 &amp;                        0.00 &amp;                   0.00 &amp;                   0.00 &amp;                          0.00 &amp;                         0.00 &amp;            0.00 &amp;                   0.00 &amp;         0.00 &amp;               0.00 &amp;          0.00 &amp;                 0.00 &amp;              0.00 \\
Land cover [Sea and ocean]                                                                          &amp;                 0.00 &amp;                                  0.00 &amp;                     0.00 &amp;                              0.00 &amp;                        0.00 &amp;                   0.00 &amp;                   0.00 &amp;                          0.00 &amp;                         0.00 &amp;            0.00 &amp;                   0.00 &amp;         0.00 &amp;               0.00 &amp;          0.00 &amp;                 0.00 &amp;              0.00 \\
Land cover [Construction sites]                                                                     &amp;                 0.00 &amp;                                  0.00 &amp;                     0.00 &amp;                              0.00 &amp;                        0.00 &amp;                   0.00 &amp;                   0.00 &amp;                          0.00 &amp;                         0.00 &amp;            0.00 &amp;                   0.00 &amp;         0.00 &amp;               0.00 &amp;          0.01 &amp;                 0.00 &amp;              0.00 \\
Land cover [Burnt areas]                                                                            &amp;                 0.00 &amp;                                  0.00 &amp;                     0.00 &amp;                              0.00 &amp;                        0.00 &amp;                   0.00 &amp;                   0.00 &amp;                          0.00 &amp;                         0.00 &amp;            0.00 &amp;                   0.00 &amp;         0.00 &amp;               0.00 &amp;          0.00 &amp;                 0.00 &amp;              0.00 \\
Land cover [Dump sites]                                                                             &amp;                 0.00 &amp;                                  0.00 &amp;                     0.00 &amp;                              0.00 &amp;                        0.00 &amp;                   0.00 &amp;                   0.00 &amp;                          0.00 &amp;                         0.00 &amp;            0.00 &amp;                   0.00 &amp;         0.00 &amp;               0.00 &amp;          0.00 &amp;                 0.00 &amp;              0.00 \\
Land cover [Complex cultivation patterns]                                                           &amp;                 0.00 &amp;                                  0.00 &amp;                     0.00 &amp;                              0.00 &amp;                        0.00 &amp;                   0.00 &amp;                   0.00 &amp;                          0.00 &amp;                         0.00 &amp;            0.00 &amp;                   0.00 &amp;         0.00 &amp;               0.00 &amp;          0.00 &amp;                 0.00 &amp;              0.00 \\
Land cover [Inland marshes]                                                                         &amp;                 0.00 &amp;                                  0.00 &amp;                     0.00 &amp;                              0.00 &amp;                        0.00 &amp;                   0.00 &amp;                   0.00 &amp;                          0.00 &amp;                         0.00 &amp;            0.00 &amp;                   0.00 &amp;         0.00 &amp;               0.00 &amp;          0.00 &amp;                 0.00 &amp;              0.00 \\
Land cover [Water courses]                                                                          &amp;                 0.00 &amp;                                  0.00 &amp;                     0.00 &amp;                              0.00 &amp;                        0.00 &amp;                   0.00 &amp;                   0.01 &amp;                          0.00 &amp;                         0.00 &amp;            0.00 &amp;                   0.01 &amp;         0.00 &amp;               0.01 &amp;          0.00 &amp;                 0.00 &amp;              0.00 \\
Land cover [Coniferous forest]                                                                      &amp;                 0.00 &amp;                                  0.00 &amp;                     0.01 &amp;                              0.00 &amp;                        0.00 &amp;                   0.00 &amp;                   0.00 &amp;                          0.00 &amp;                         0.00 &amp;            0.00 &amp;                   0.00 &amp;         0.00 &amp;               0.00 &amp;          0.00 &amp;                 0.00 &amp;              0.04 \\
Land cover [Bare rocks]                                                                             &amp;                 0.00 &amp;                                  0.00 &amp;                     0.00 &amp;                              0.00 &amp;                        0.00 &amp;                   0.00 &amp;                   0.00 &amp;                          0.00 &amp;                         0.00 &amp;            0.00 &amp;                   0.00 &amp;         0.00 &amp;               0.00 &amp;          0.00 &amp;                 0.00 &amp;              0.00 \\
Land cover [Coastal lagoons]                                                                        &amp;                 0.00 &amp;                                  0.00 &amp;                     0.00 &amp;                              0.00 &amp;                        0.00 &amp;                   0.00 &amp;                   0.00 &amp;                          0.00 &amp;                         0.00 &amp;            0.00 &amp;                   0.00 &amp;         0.00 &amp;               0.00 &amp;          0.00 &amp;                 0.00 &amp;              0.00 \\
Land cover [Beaches, dunes, sands]                                                                  &amp;                 0.00 &amp;                                  0.00 &amp;                     0.00 &amp;                              0.00 &amp;                        0.00 &amp;                   0.00 &amp;                   0.00 &amp;                          0.00 &amp;                         0.00 &amp;            0.00 &amp;                   0.00 &amp;         0.00 &amp;               0.00 &amp;          0.00 &amp;                 0.00 &amp;              0.00 \\
Land cover [Agro-forestry areas]                                                                    &amp;                 0.00 &amp;                                  0.00 &amp;                     0.00 &amp;                              0.00 &amp;                        0.00 &amp;                   0.00 &amp;                   0.00 &amp;                          0.00 &amp;                         0.00 &amp;            0.00 &amp;                   0.00 &amp;         0.00 &amp;               0.00 &amp;          0.00 &amp;                 0.00 &amp;              0.00 \\
Land cover [Sparsely vegetated areas]                                                               &amp;                 0.00 &amp;                                  0.00 &amp;                     0.00 &amp;                              0.00 &amp;                        0.00 &amp;                   0.00 &amp;                   0.00 &amp;                          0.00 &amp;                         0.00 &amp;            0.00 &amp;                   0.00 &amp;         0.00 &amp;               0.00 &amp;          0.00 &amp;                 0.00 &amp;              0.00 \\
Land cover [Fruit trees and berry plantations]                                                      &amp;                 0.00 &amp;                                  0.00 &amp;                     0.00 &amp;                              0.00 &amp;                        0.00 &amp;                   0.00 &amp;                   0.00 &amp;                          0.00 &amp;                         0.00 &amp;            0.00 &amp;                   0.00 &amp;         0.00 &amp;               0.00 &amp;          0.00 &amp;                 0.00 &amp;              0.00 \\
NDVI                                                                                                &amp;                 0.29 &amp;                                  0.25 &amp;                     0.48 &amp;                              0.23 &amp;                        0.19 &amp;                   0.29 &amp;                   0.03 &amp;                          0.21 &amp;                         0.00 &amp;            0.16 &amp;                   0.06 &amp;         0.29 &amp;               0.11 &amp;          0.37 &amp;                 0.29 &amp;              0.56 \\
Supermarkets [distance to nearest]                                                                  &amp;               828.82 &amp;                                679.96 &amp;                  4751.23 &amp;                            661.77 &amp;                      587.28 &amp;                 761.86 &amp;                 229.90 &amp;                        577.68 &amp;                       324.42 &amp;          483.02 &amp;                 299.93 &amp;       948.03 &amp;             331.07 &amp;       1752.87 &amp;              1043.84 &amp;           9854.12 \\
Supermarkets [counts within 1200m]                                                                  &amp;                 1.89 &amp;                                  2.86 &amp;                     0.09 &amp;                              3.13 &amp;                        4.44 &amp;                   2.07 &amp;                  22.51 &amp;                          3.41 &amp;                        18.79 &amp;            6.85 &amp;                  17.27 &amp;         1.47 &amp;              12.53 &amp;          0.65 &amp;                 1.43 &amp;              0.03 \\
Listed buildings [distance to nearest]                                                              &amp;               744.22 &amp;                                596.61 &amp;                   557.94 &amp;                            506.61 &amp;                      350.89 &amp;                 729.61 &amp;                  31.73 &amp;                        516.20 &amp;                        69.75 &amp;          216.86 &amp;                  51.87 &amp;       760.26 &amp;             115.00 &amp;        673.93 &amp;               934.00 &amp;           1324.03 \\
Listed buildings [counts within 1200m]                                                              &amp;                11.27 &amp;                                 24.28 &amp;                    11.22 &amp;                             37.47 &amp;                       62.78 &amp;                  24.18 &amp;                 685.16 &amp;                         31.77 &amp;                      1142.57 &amp;          140.03 &amp;                 456.53 &amp;        18.17 &amp;             324.50 &amp;         16.14 &amp;                10.57 &amp;              4.21 \\
FHRS points [distance to nearest]                                                                   &amp;               218.46 &amp;                                152.48 &amp;                   725.69 &amp;                            144.02 &amp;                      106.08 &amp;                 217.95 &amp;                  16.22 &amp;                        129.24 &amp;                        14.10 &amp;           82.47 &amp;                  40.06 &amp;       267.24 &amp;              56.87 &amp;        379.17 &amp;               256.22 &amp;           1699.17 \\
FHRS points [counts within 1200m]                                                                   &amp;               334.43 &amp;                                692.66 &amp;                    44.47 &amp;                            860.93 &amp;                     1568.44 &amp;                 342.08 &amp;                6297.61 &amp;                       1081.38 &amp;                      9213.15 &amp;         2167.91 &amp;                4490.95 &amp;       253.88 &amp;            3163.83 &amp;        132.66 &amp;               271.09 &amp;             33.07 \\
Cultural venues [distance to nearest]                                                               &amp;              5384.64 &amp;                               3946.05 &amp;                 13156.20 &amp;                           3497.51 &amp;                     2287.43 &amp;                5831.52 &amp;                 702.75 &amp;                       4094.92 &amp;                       351.33 &amp;         1273.23 &amp;                 644.53 &amp;      6309.75 &amp;             850.25 &amp;       8939.65 &amp;              5121.47 &amp;          20695.29 \\
Cultural venues [counts within 1200m]                                                               &amp;                 0.06 &amp;                                  0.13 &amp;                     0.00 &amp;                              0.26 &amp;                        0.48 &amp;                   0.08 &amp;                  10.39 &amp;                          0.24 &amp;                        34.20 &amp;            1.13 &amp;                   4.45 &amp;         0.06 &amp;               2.23 &amp;          0.02 &amp;                 0.06 &amp;              0.00 \\
Water bodies [distance to nearest]                                                                  &amp;               542.61 &amp;                                555.96 &amp;                   304.49 &amp;                            483.12 &amp;                      528.85 &amp;                 523.05 &amp;                 565.25 &amp;                        522.09 &amp;                       759.60 &amp;          507.71 &amp;                 467.71 &amp;       378.36 &amp;             461.42 &amp;        345.79 &amp;               417.43 &amp;            236.73 \\
Retail centres [distance to nearest]                                                                &amp;               849.45 &amp;                                536.47 &amp;                  4943.97 &amp;                            421.09 &amp;                      224.33 &amp;                 725.57 &amp;                  29.80 &amp;                        445.52 &amp;                        32.54 &amp;          161.85 &amp;                  66.32 &amp;      1002.66 &amp;              90.87 &amp;       2102.46 &amp;               898.17 &amp;          11041.32 \\
\bottomrule
\end{tabular}
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="feature-importance">
<h2>Feature importance<a class="headerlink" href="#feature-importance" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">importances</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/clustering_data/spsig_feature_importance.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">importances</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">importances</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">renamer</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">importances</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;relative importance&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">importances</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">to_latex</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>\begin{tabular}{lr}
\toprule
{} &amp;  relative importance \\
\midrule
covered area ratio of ETC (Q1)             &amp;             0.036944 \\
covered area ratio of ETC (Q2)             &amp;             0.031717 \\
perimeter-weighted neighbours of ETC (Q2)  &amp;             0.023476 \\
mean inter-building distance (Q2)          &amp;             0.016662 \\
area of ETC (Q3)                           &amp;             0.016005 \\
area covered by node-attached ETCs (Q3)    &amp;             0.014813 \\
longest axis length of ETC (Q2)            &amp;             0.014501 \\
weighted reached enclosures of ETC (Q1)    &amp;             0.014115 \\
reached area by neighbouring segments (Q3) &amp;             0.014000 \\
reached area by neighbouring segments (Q1) &amp;             0.013904 \\
\bottomrule
\end{tabular}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">importances</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>relative importance    0.196135
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">type_imp</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/clustering_data/per_cluster_importance.pq&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">classes</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;cluster_4&#39;</span><span class="p">,</span> <span class="s1">&#39;cluster_0&#39;</span><span class="p">,</span> <span class="s1">&#39;cluster_6&#39;</span><span class="p">,</span> <span class="s1">&#39;cluster_1&#39;</span><span class="p">,</span> <span class="s1">&#39;cluster_21&#39;</span><span class="p">,</span>
    <span class="s1">&#39;cluster_7&#39;</span><span class="p">,</span> <span class="s1">&#39;cluster_3&#39;</span><span class="p">,</span> <span class="s1">&#39;cluster_5&#39;</span><span class="p">,</span> <span class="s1">&#39;cluster_90&#39;</span><span class="p">,</span> <span class="s1">&#39;cluster_20&#39;</span><span class="p">,</span>
    <span class="s1">&#39;cluster_8&#39;</span><span class="p">,</span> <span class="s1">&#39;cluster_22&#39;</span><span class="p">,</span> <span class="s1">&#39;cluster_92&#39;</span><span class="p">,</span> <span class="s1">&#39;cluster_94&#39;</span><span class="p">,</span> <span class="s1">&#39;cluster_91&#39;</span><span class="p">,</span>
    <span class="s1">&#39;cluster_95&#39;</span>
<span class="p">]</span>
<span class="n">type_imp</span><span class="p">[</span><span class="n">classes</span><span class="p">]</span> <span class="o">=</span> <span class="n">type_imp</span><span class="p">[</span><span class="n">classes</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">renamer</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">types</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;Countryside agriculture&quot;</span><span class="p">,</span>
    <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;Accessible suburbia&quot;</span><span class="p">,</span>
    <span class="mi">3</span><span class="p">:</span> <span class="s2">&quot;Open sprawl&quot;</span><span class="p">,</span>
    <span class="mi">4</span><span class="p">:</span> <span class="s2">&quot;Wild countryside&quot;</span><span class="p">,</span>
    <span class="mi">5</span><span class="p">:</span> <span class="s2">&quot;Warehouse/Park land&quot;</span><span class="p">,</span>
    <span class="mi">6</span><span class="p">:</span> <span class="s2">&quot;Gridded residential quarters&quot;</span><span class="p">,</span>
    <span class="mi">7</span><span class="p">:</span> <span class="s2">&quot;Urban buffer&quot;</span><span class="p">,</span>
    <span class="mi">8</span><span class="p">:</span> <span class="s2">&quot;Disconnected suburbia&quot;</span><span class="p">,</span>
    <span class="mi">20</span><span class="p">:</span> <span class="s2">&quot;Dense residential neighbourhoods&quot;</span><span class="p">,</span>
    <span class="mi">21</span><span class="p">:</span> <span class="s2">&quot;Connected residential neighbourhoods&quot;</span><span class="p">,</span>
    <span class="mi">22</span><span class="p">:</span> <span class="s2">&quot;Dense urban neighbourhoods&quot;</span><span class="p">,</span>
    <span class="mi">90</span><span class="p">:</span> <span class="s2">&quot;Local urbanity&quot;</span><span class="p">,</span>
    <span class="mi">91</span><span class="p">:</span> <span class="s2">&quot;Concentrated urbanity&quot;</span><span class="p">,</span>
    <span class="mi">92</span><span class="p">:</span> <span class="s2">&quot;Regional urbanity&quot;</span><span class="p">,</span>
    <span class="mi">94</span><span class="p">:</span> <span class="s2">&quot;Metropolitan urbanity&quot;</span><span class="p">,</span>
    <span class="mi">95</span><span class="p">:</span> <span class="s2">&quot;Hyper concentrated urbanity&quot;</span><span class="p">,</span>
    <span class="mi">93</span><span class="p">:</span> <span class="s2">&quot;outlier&quot;</span><span class="p">,</span>
    <span class="mi">96</span><span class="p">:</span> <span class="s2">&quot;outlier&quot;</span><span class="p">,</span>
    <span class="mi">97</span><span class="p">:</span> <span class="s2">&quot;outlier&quot;</span><span class="p">,</span>
    <span class="mi">98</span><span class="p">:</span> <span class="s2">&quot;outlier&quot;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tups</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">type_imp</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="k">if</span> <span class="s1">&#39;vals&#39;</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span>
        <span class="n">tups</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">types</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span><span class="o">-</span><span class="mi">5</span><span class="p">])],</span> <span class="s1">&#39;rel. importance&#39;</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tups</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">types</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">8</span><span class="p">:])],</span> <span class="s1">&#39;name&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">type_imp</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">tups</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">type_imp</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">to_latex</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>\begin{tabular}{lrlrlrlrlrlrlrlrlrlrlrlrlrlrlrlr}
\toprule
                                 Wild countryside &amp; \multicolumn{2}{l}{Countryside agriculture} &amp; \multicolumn{2}{l}{Gridded residential quarters} &amp; \multicolumn{2}{l}{Accessible suburbia} &amp; \multicolumn{2}{l}{Connected residential neighbourhoods} &amp; \multicolumn{2}{l}{Urban buffer} &amp; \multicolumn{2}{l}{Open sprawl} &amp; \multicolumn{2}{l}{Warehouse/Park land} &amp; \multicolumn{2}{l}{Local urbanity} &amp; \multicolumn{2}{l}{Dense residential neighbourhoods} &amp; \multicolumn{2}{l}{Disconnected suburbia} &amp; \multicolumn{2}{l}{Dense urban neighbourhoods} &amp; \multicolumn{2}{l}{Regional urbanity} &amp; \multicolumn{2}{l}{Metropolitan urbanity} &amp; \multicolumn{2}{l}{Concentrated urbanity} &amp; \multicolumn{2}{l}{Hyper concentrated urbanity} \\
                                             name &amp; rel. importance &amp;                                               name &amp; rel. importance &amp;                                               name &amp; rel. importance &amp;                                         name &amp; rel. importance &amp;                                               name &amp; rel. importance &amp;                                               name &amp; rel. importance &amp;                                        name &amp; rel. importance &amp;                                               name &amp; rel. importance &amp;                                               name &amp; rel. importance &amp;                                             name &amp; rel. importance &amp;                                               name &amp; rel. importance &amp;                                               name &amp; rel. importance &amp;                                               name &amp; rel. importance &amp;                                               name &amp; rel. importance &amp;                                               name &amp; rel. importance &amp;                                               name &amp; rel. importance \\
\midrule
                  longest axis length of ETC (Q1) &amp;        0.196609 &amp;                     covered area ratio of ETC (Q1) &amp;        0.154212 &amp;             local closeness of street network (Q3) &amp;        0.095416 &amp;      weighted reached enclosures of ETC (Q3) &amp;        0.063690 &amp;                    cell alignment of building (Q1) &amp;        0.028481 &amp;            area covered by neighbouring cells (Q2) &amp;        0.071780 &amp;   reached area by local street network (Q1) &amp;        0.058349 &amp;                        elongation of building (Q1) &amp;        0.033986 &amp;                         perimeter of building (Q2) &amp;        0.101218 &amp; centroid - corner mean distance of building (Q2) &amp;        0.036962 &amp; local proportion of cul-de-sacs of street netwo... &amp;        0.023643 &amp;                         perimeter of building (Q2) &amp;        0.106663 &amp; centroid - corner distance deviation of buildin... &amp;        0.115378 &amp;      equivalent rectangular index of building (Q2) &amp;        0.110605 &amp;                              area of building (Q1) &amp;        0.128233 &amp;                     covered area ratio of ETC (Q2) &amp;        0.154124 \\
                   covered area ratio of ETC (Q2) &amp;        0.151118 &amp;                     covered area ratio of ETC (Q2) &amp;        0.144279 &amp;             local closeness of street network (Q2) &amp;        0.046007 &amp; reached ETCs by tessellation contiguity (Q3) &amp;        0.062061 &amp; local proportion of 4-way intersections of stre... &amp;        0.022801 &amp;                     covered area ratio of ETC (Q2) &amp;        0.049986 &amp;  reached area by neighbouring segments (Q1) &amp;        0.033786 &amp;   centroid - corner mean distance of building (Q3) &amp;        0.028038 &amp;      equivalent rectangular index of building (Q1) &amp;        0.093518 &amp; centroid - corner mean distance of building (Q3) &amp;        0.030172 &amp;            local meshedness of street network (Q3) &amp;        0.021436 &amp;   centroid - corner mean distance of building (Q2) &amp;        0.084484 &amp;   centroid - corner mean distance of building (Q2) &amp;        0.088275 &amp;   centroid - corner mean distance of building (Q2) &amp;        0.087236 &amp; Workplace population [Distribution, hotels and ... &amp;        0.099872 &amp;          Workplace population [Manufacturing] (Q2) &amp;        0.143669 \\
                   covered area ratio of ETC (Q1) &amp;        0.145754 &amp;                  mean inter-building distance (Q2) &amp;        0.078928 &amp;                        perimeter of enclosure (Q1) &amp;        0.044369 &amp; reached area by tessellation contiguity (Q2) &amp;        0.047628 &amp;                    cell alignment of building (Q2) &amp;        0.017361 &amp; mean distance to neighbouring nodes of street n... &amp;        0.048812 &amp;     area covered by node-attached ETCs (Q2) &amp;        0.023548 &amp;                        elongation of building (Q2) &amp;        0.025310 &amp;   centroid - corner mean distance of building (Q2) &amp;        0.082040 &amp;                            area of building (Q3) &amp;        0.029425 &amp;            local meshedness of street network (Q2) &amp;        0.020520 &amp;                         perimeter of building (Q3) &amp;        0.082203 &amp;                        squareness of building (Q3) &amp;        0.082130 &amp; centroid - corner distance deviation of buildin... &amp;        0.080684 &amp; Workplace population [Financial, real estate, p... &amp;        0.076751 &amp;                  Workplace population [Other] (Q2) &amp;        0.101678 \\
                                 area of ETC (Q2) &amp;        0.096485 &amp;                                   area of ETC (Q2) &amp;        0.072977 &amp;                             area of enclosure (Q2) &amp;        0.037296 &amp;                             area of ETC (Q2) &amp;        0.045100 &amp;                             area of enclosure (Q2) &amp;        0.017232 &amp;                     covered area ratio of ETC (Q1) &amp;        0.046002 &amp;              covered area ratio of ETC (Q2) &amp;        0.022004 &amp;              circular compactness of building (Q1) &amp;        0.019596 &amp;                        squareness of building (Q3) &amp;        0.054375 &amp;                                  Population (Q3) &amp;        0.028051 &amp;      equivalent rectangular index of building (Q1) &amp;        0.020273 &amp;                              area of building (Q2) &amp;        0.066331 &amp; Workplace population [Financial, real estate, p... &amp;        0.071195 &amp;                           corners of building (Q2) &amp;        0.071910 &amp;                  Workplace population [Other] (Q2) &amp;        0.075844 &amp; Workplace population [Distribution, hotels and ... &amp;        0.081796 \\
        perimeter-weighted neighbours of ETC (Q3) &amp;        0.075078 &amp;            area covered by node-attached ETCs (Q2) &amp;        0.066916 &amp;             local closeness of street network (Q1) &amp;        0.036698 &amp;   reached ETCs by neighbouring segments (Q1) &amp;        0.036865 &amp;                            orientation of ETC (Q2) &amp;        0.016519 &amp;         reached area by neighbouring segments (Q1) &amp;        0.038292 &amp;   local node density of street network (Q3) &amp;        0.018821 &amp; centroid - corner distance deviation of buildin... &amp;        0.017568 &amp;                              area of building (Q2) &amp;        0.051383 &amp;                       perimeter of building (Q2) &amp;        0.025995 &amp;              circular compactness of building (Q1) &amp;        0.019361 &amp;                                    Population (Q3) &amp;        0.039538 &amp;                         perimeter of building (Q2) &amp;        0.065223 &amp; Workplace population [Financial, real estate, p... &amp;        0.060205 &amp; Workplace population [Distribution, hotels and ... &amp;        0.070516 &amp;                     covered area ratio of ETC (Q1) &amp;        0.079165 \\
       reached area by neighbouring segments (Q1) &amp;        0.048869 &amp; mean distance to neighbouring nodes of street n... &amp;        0.066150 &amp;            weighted reached enclosures of ETC (Q3) &amp;        0.031708 &amp;   reached ETCs by neighbouring segments (Q2) &amp;        0.029904 &amp;      equivalent rectangular index of building (Q1) &amp;        0.016281 &amp;                   circular compactness of ETC (Q2) &amp;        0.034693 &amp;  reached area by neighbouring segments (Q2) &amp;        0.018065 &amp;                         perimeter of building (Q3) &amp;        0.017147 &amp; centroid - corner distance deviation of buildin... &amp;        0.044975 &amp;                            area of building (Q2) &amp;        0.022935 &amp;                                    Population (Q1) &amp;        0.017855 &amp;                        squareness of building (Q3) &amp;        0.039269 &amp;                         perimeter of building (Q3) &amp;        0.057863 &amp; Workplace population [Distribution, hotels and ... &amp;        0.051041 &amp; Workplace population [Financial, real estate, p... &amp;        0.060396 &amp;          Workplace population [Manufacturing] (Q3) &amp;        0.074537 \\
     reached area by tessellation contiguity (Q1) &amp;        0.018289 &amp;         reached area by neighbouring segments (Q1) &amp;        0.062776 &amp; local proportion of 4-way intersections of stre... &amp;        0.020617 &amp;    reached ETCs by local street network (Q2) &amp;        0.026220 &amp; local proportion of 4-way intersections of stre... &amp;        0.014317 &amp;            area covered by neighbouring cells (Q1) &amp;        0.033082 &amp;              covered area ratio of ETC (Q1) &amp;        0.018036 &amp;                       width of street profile (Q2) &amp;        0.016790 &amp; Workplace population [Financial, real estate, p... &amp;        0.044019 &amp;                      perimeter of enclosure (Q1) &amp;        0.020672 &amp;                        elongation of building (Q2) &amp;        0.016115 &amp; centroid - corner distance deviation of buildin... &amp;        0.034407 &amp;                              area of building (Q2) &amp;        0.050349 &amp;                         perimeter of building (Q2) &amp;        0.046511 &amp;          Workplace population [Manufacturing] (Q2) &amp;        0.054662 &amp;   centroid - corner mean distance of building (Q2) &amp;        0.070363 \\
                                 area of ETC (Q3) &amp;        0.015991 &amp;       Land cover [Discontinuous urban fabric] (Q2) &amp;        0.055444 &amp;            area covered by node-attached ETCs (Q1) &amp;        0.019211 &amp;    perimeter-weighted neighbours of ETC (Q1) &amp;        0.023718 &amp;                        perimeter of enclosure (Q1) &amp;        0.014305 &amp;         buildings per meter of street segment (Q2) &amp;        0.032175 &amp;                      area of enclosure (Q2) &amp;        0.017156 &amp;              circular compactness of building (Q2) &amp;        0.016306 &amp; Workplace population [Distribution, hotels and ... &amp;        0.035144 &amp;                    orientation of enclosure (Q2) &amp;        0.017636 &amp;         reached area by neighbouring segments (Q2) &amp;        0.015907 &amp; Workplace population [Financial, real estate, p... &amp;        0.029293 &amp; Workplace population [Distribution, hotels and ... &amp;        0.048963 &amp;                        squareness of building (Q3) &amp;        0.039035 &amp;                         perimeter of building (Q2) &amp;        0.046941 &amp;                         perimeter of building (Q2) &amp;        0.054542 \\
mean distance between neighbouring buildings (Q2) &amp;        0.015013 &amp;          perimeter-weighted neighbours of ETC (Q2) &amp;        0.021903 &amp;            area covered by node-attached ETCs (Q2) &amp;        0.018326 &amp; reached area by tessellation contiguity (Q1) &amp;        0.022821 &amp; local proportion of cul-de-sacs of street netwo... &amp;        0.013748 &amp;       reached area by tessellation contiguity (Q1) &amp;        0.029531 &amp; compactness-weighted axis of enclosure (Q3) &amp;        0.016709 &amp;       reached area by tessellation contiguity (Q1) &amp;        0.016248 &amp;                         perimeter of building (Q3) &amp;        0.033695 &amp;                       perimeter of building (Q3) &amp;        0.016561 &amp;            area covered by edge-attached ETCs (Q3) &amp;        0.015526 &amp;      equivalent rectangular index of building (Q1) &amp;        0.017548 &amp;                           corners of building (Q3) &amp;        0.029268 &amp; Workplace population [Financial, real estate, p... &amp;        0.029708 &amp;   centroid - corner mean distance of building (Q2) &amp;        0.044694 &amp;                    openness of street profile (Q2) &amp;        0.031258 \\
                mean inter-building distance (Q2) &amp;        0.010559 &amp;                    longest axis length of ETC (Q2) &amp;        0.020504 &amp;            weighted reached enclosures of ETC (Q2) &amp;        0.016607 &amp;    reached ETCs by local street network (Q1) &amp;        0.020275 &amp;                      orientation of enclosure (Q1) &amp;        0.013305 &amp;            area covered by node-attached ETCs (Q3) &amp;        0.027952 &amp;                            area of ETC (Q2) &amp;        0.015707 &amp;                         perimeter of building (Q2) &amp;        0.014735 &amp;                              area of building (Q1) &amp;        0.022769 &amp;                           area of enclosure (Q1) &amp;        0.015454 &amp;              circular compactness of building (Q2) &amp;        0.015257 &amp;                  Workplace population [Other] (Q2) &amp;        0.016284 &amp; centroid - corner distance deviation of buildin... &amp;        0.020625 &amp;   centroid - corner mean distance of building (Q1) &amp;        0.018957 &amp;        Land cover [Non-irrigated arable land] (Q1) &amp;        0.025912 &amp;                                          NDVI (Q3) &amp;        0.027406 \\
\bottomrule
\end{tabular}
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./data_product"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="overview.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">Overview of the data product</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="oa_interpolation.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">Interpolation of signatures to OA and LSOA</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Dani Arribas-Bel, Martin Fleischmann<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>