
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Functional data &#8212; Urban Grammar AI | WP2 - Spatial Signatures</title>
    
  <link rel="stylesheet" href="../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/sphinx-book-theme.e7340bb3dbd8dde6db86f25597f54a1b.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.svg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Urban Grammar AI | WP2 - Spatial Signatures</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <p class="caption collapsible-parent">
 <span class="caption-text">
  Project
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference external" href="http://urbangrammarai.github.io">
   Project homepage
   <i class="fas fa-external-link-alt">
   </i>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="http://urbangrammarai.github.io/data_processing">
   WP1 - Data processing
   <i class="fas fa-external-link-alt">
   </i>
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Spatial unit
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../spatial_unit/unit.html">
   Exploration of tessellation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../spatial_unit/enclosed_tessellation.html">
   Enclosed tessellation (proof of a concept)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../spatial_unit/Parallelized_enclosures.html">
   Generating enclosures (proof of a concept)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../spatial_unit/Generate_enclosures.html">
   Generate enclosures for the Great Britain
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../spatial_unit/chunk_uk.html">
   Geo-chunking Great Britain
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../spatial_unit/chunked_enclosed_tessellation.html">
   Generate enclosed tessellation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../spatial_unit/hierarchical_ids.html">
   Generate hierarchical unique IDs
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Populating units with data
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="cross-chunk_indices.html">
   Cross-chunk indices
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="morphometrics.html">
   Urban morphometrics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="GHS-composite-S2_ndvi.html">
   NDVI
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Cluster analysis
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../clusters/mastermap_openmap_cluster.html">
   Trial of clustering on OpenMap and MasterMap data
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/measuring/functional_data.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/urbangrammarai/spatial_signatures"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/urbangrammarai/spatial_signatures/master?urlpath=tree/measuring/functional_data.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i>
            Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#night-lights">
   Night lights
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#worplace-population-by-industry">
   Worplace population by industry
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#corine-land-cover">
   CORINE Land cover
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#retail-centres">
   Retail centres
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#water">
   Water
  </a>
 </li>
</ul>

        </nav>
        
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="functional-data">
<h1>Functional data<a class="headerlink" href="#functional-data" title="Permalink to this headline">¶</a></h1>
<p>This notebook links various functional layers to ET cells across GB.</p>
<p>## Population estimates</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">tobler</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>
<span class="kn">import</span> <span class="nn">xarray</span>
<span class="kn">import</span> <span class="nn">rioxarray</span>
<span class="kn">import</span> <span class="nn">rasterstats</span>

<span class="kn">from</span> <span class="nn">dask.distributed</span> <span class="kn">import</span> <span class="n">Client</span><span class="p">,</span> <span class="n">LocalCluster</span><span class="p">,</span> <span class="n">as_completed</span>
<span class="kn">import</span> <span class="nn">dask.dataframe</span> <span class="k">as</span> <span class="nn">dd</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s1">&#39;.*initial implementation of Parquet.*&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">population_est</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s2">&quot;../../urbangrammar_samba/functional_data/population_estimates/gb_population_estimates.pq&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">population_est</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>code</th>
      <th>population</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>E00000095</td>
      <td>508</td>
      <td>POLYGON ((549375.280 184970.971, 549375.032 18...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>E00000096</td>
      <td>322</td>
      <td>POLYGON ((549003.992 184933.133, 549007.974 18...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>E00000097</td>
      <td>348</td>
      <td>POLYGON ((548895.389 184911.808, 548897.030 18...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>E00000098</td>
      <td>305</td>
      <td>POLYGON ((548320.415 184671.916, 548317.197 18...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>E00000001</td>
      <td>251</td>
      <td>POLYGON ((532303.125 181877.594, 532301.345 18...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>6971</th>
      <td>S01013477</td>
      <td>638</td>
      <td>POLYGON ((308686.000 672220.000, 308688.000 67...</td>
    </tr>
    <tr>
      <th>6972</th>
      <td>S01013478</td>
      <td>809</td>
      <td>POLYGON ((307423.889 672579.756, 307424.594 67...</td>
    </tr>
    <tr>
      <th>6973</th>
      <td>S01013479</td>
      <td>758</td>
      <td>POLYGON ((308478.000 672440.000, 308485.000 67...</td>
    </tr>
    <tr>
      <th>6974</th>
      <td>S01013480</td>
      <td>703</td>
      <td>POLYGON ((308734.000 672598.000, 308743.000 67...</td>
    </tr>
    <tr>
      <th>6975</th>
      <td>S01013481</td>
      <td>682</td>
      <td>POLYGON ((309949.893 672738.667, 309970.518 67...</td>
    </tr>
  </tbody>
</table>
<p>188384 rows × 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chunk</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/tessellation/tess_0.pq&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chunk</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>hindex</th>
      <th>tessellation</th>
      <th>buildings</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>c000e109777t0000</td>
      <td>POLYGON ((336287.376 427055.178, 336286.745 42...</td>
      <td>POLYGON ((336281.920 427085.170, 336285.250 42...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>c000e109777t0001</td>
      <td>POLYGON ((336192.633 427056.666, 336192.607 42...</td>
      <td>POLYGON ((336196.990 427062.730, 336209.420 42...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>c000e109777t0002</td>
      <td>POLYGON ((336202.056 427028.254, 336199.483 42...</td>
      <td>POLYGON ((336198.720 427052.340, 336200.960 42...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>c000e109777t0003</td>
      <td>POLYGON ((336194.678 427020.851, 336196.952 42...</td>
      <td>POLYGON ((336213.400 427028.670, 336214.800 42...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>c000e109777t0004</td>
      <td>POLYGON ((336220.377 427052.195, 336218.829 42...</td>
      <td>POLYGON ((336248.750 427066.160, 336246.990 42...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>114648</th>
      <td>c000e599810t0000</td>
      <td>POLYGON Z ((348790.934 452623.250 0.000, 34878...</td>
      <td>None</td>
    </tr>
    <tr>
      <th>114649</th>
      <td>c000e094707t0000</td>
      <td>POLYGON ((352410.100 452567.740, 352408.620 45...</td>
      <td>None</td>
    </tr>
    <tr>
      <th>114650</th>
      <td>c000e599602t0000</td>
      <td>POLYGON Z ((352035.703 452585.968 0.000, 35204...</td>
      <td>None</td>
    </tr>
    <tr>
      <th>114651</th>
      <td>c000e599795t0000</td>
      <td>POLYGON Z ((348790.934 452623.250 0.000, 34879...</td>
      <td>None</td>
    </tr>
    <tr>
      <th>114652</th>
      <td>c000e599790t0000</td>
      <td>POLYGON Z ((348431.535 452642.577 0.000, 34842...</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
<p>114653 rows × 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">chunk</span><span class="o">.</span><span class="n">total_bounds</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">ests</span> <span class="o">=</span> <span class="n">tobler</span><span class="o">.</span><span class="n">area_weighted</span><span class="o">.</span><span class="n">area_interpolate</span><span class="p">(</span><span class="n">population_est</span><span class="o">.</span><span class="n">cx</span><span class="p">[</span><span class="n">xmin</span><span class="p">:</span><span class="n">xmax</span><span class="p">,</span> <span class="n">ymin</span><span class="p">:</span><span class="n">ymax</span><span class="p">],</span> <span class="n">chunk</span><span class="o">.</span><span class="n">set_geometry</span><span class="p">(</span><span class="s2">&quot;buildings&quot;</span><span class="p">),</span> <span class="n">extensive_variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;population&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 6.69 s, sys: 18 ms, total: 6.71 s
Wall time: 6.71 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ests</span><span class="o">.</span><span class="n">population</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>373.49790543317795
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">chunk_id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">103</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
    <span class="n">chunk</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/tessellation/tess_</span><span class="si">{</span><span class="n">chunk_id</span><span class="si">}</span><span class="s2">.pq&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;hindex&quot;</span><span class="p">,</span> <span class="s2">&quot;buildings&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">set_geometry</span><span class="p">(</span><span class="s2">&quot;buildings&quot;</span><span class="p">)</span>
    <span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">chunk</span><span class="o">.</span><span class="n">total_bounds</span>
    <span class="n">ests</span> <span class="o">=</span> <span class="n">tobler</span><span class="o">.</span><span class="n">area_weighted</span><span class="o">.</span><span class="n">area_interpolate</span><span class="p">(</span><span class="n">population_est</span><span class="o">.</span><span class="n">cx</span><span class="p">[</span><span class="n">xmin</span><span class="p">:</span><span class="n">xmax</span><span class="p">,</span> <span class="n">ymin</span><span class="p">:</span><span class="n">ymax</span><span class="p">],</span> <span class="n">chunk</span><span class="p">,</span> <span class="n">extensive_variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;population&#39;</span><span class="p">])</span>
    <span class="n">pop</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;hindex&#39;</span><span class="p">:</span> <span class="n">chunk</span><span class="o">.</span><span class="n">hindex</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="s2">&quot;population&quot;</span><span class="p">:</span> <span class="n">ests</span><span class="o">.</span><span class="n">population</span><span class="o">.</span><span class="n">values</span><span class="p">})</span>
    <span class="n">pop</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/functional/population/pop_</span><span class="si">{</span><span class="n">chunk_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Chunk </span><span class="si">{</span><span class="n">chunk_id</span><span class="si">}</span><span class="s2"> processed sucessfully in </span><span class="si">{</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">s</span><span class="si">}</span><span class="s2"> seconds.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 0 processed sucessfully in 6.84471321105957 seconds.
Chunk 1 processed sucessfully in 8.95691466331482 seconds.
Chunk 2 processed sucessfully in 7.748736381530762 seconds.
Chunk 3 processed sucessfully in 8.444145202636719 seconds.
Chunk 4 processed sucessfully in 12.662679195404053 seconds.
Chunk 5 processed sucessfully in 33.37630248069763 seconds.
Chunk 6 processed sucessfully in 26.04380989074707 seconds.
Chunk 7 processed sucessfully in 8.81340217590332 seconds.
Chunk 8 processed sucessfully in 9.171989679336548 seconds.
Chunk 9 processed sucessfully in 7.381581783294678 seconds.
Chunk 10 processed sucessfully in 8.442428827285767 seconds.
Chunk 11 processed sucessfully in 8.21262001991272 seconds.
Chunk 12 processed sucessfully in 13.600036859512329 seconds.
Chunk 13 processed sucessfully in 9.243984937667847 seconds.
Chunk 14 processed sucessfully in 10.093465805053711 seconds.
Chunk 15 processed sucessfully in 7.550076246261597 seconds.
Chunk 16 processed sucessfully in 7.128798007965088 seconds.
Chunk 17 processed sucessfully in 6.8270556926727295 seconds.
Chunk 18 processed sucessfully in 6.49470067024231 seconds.
Chunk 19 processed sucessfully in 9.43128228187561 seconds.
Chunk 20 processed sucessfully in 9.012417316436768 seconds.
Chunk 21 processed sucessfully in 6.9743428230285645 seconds.
Chunk 22 processed sucessfully in 7.980851411819458 seconds.
Chunk 23 processed sucessfully in 7.119813442230225 seconds.
Chunk 24 processed sucessfully in 9.437546253204346 seconds.
Chunk 25 processed sucessfully in 6.803953409194946 seconds.
Chunk 26 processed sucessfully in 9.637716293334961 seconds.
Chunk 27 processed sucessfully in 10.971379280090332 seconds.
Chunk 28 processed sucessfully in 6.771683216094971 seconds.
Chunk 29 processed sucessfully in 7.680195569992065 seconds.
Chunk 30 processed sucessfully in 9.643282890319824 seconds.
Chunk 31 processed sucessfully in 8.81855821609497 seconds.
Chunk 32 processed sucessfully in 13.103512048721313 seconds.
Chunk 33 processed sucessfully in 8.799424409866333 seconds.
Chunk 34 processed sucessfully in 8.385125398635864 seconds.
Chunk 35 processed sucessfully in 7.943921089172363 seconds.
Chunk 36 processed sucessfully in 8.670780181884766 seconds.
Chunk 37 processed sucessfully in 9.39652395248413 seconds.
Chunk 38 processed sucessfully in 15.169151782989502 seconds.
Chunk 39 processed sucessfully in 8.4164559841156 seconds.
Chunk 40 processed sucessfully in 13.69991397857666 seconds.
Chunk 41 processed sucessfully in 7.764244079589844 seconds.
Chunk 42 processed sucessfully in 15.848462104797363 seconds.
Chunk 43 processed sucessfully in 6.976937770843506 seconds.
Chunk 44 processed sucessfully in 6.865246772766113 seconds.
Chunk 45 processed sucessfully in 8.11099624633789 seconds.
Chunk 46 processed sucessfully in 8.987512826919556 seconds.
Chunk 47 processed sucessfully in 11.197800874710083 seconds.
Chunk 48 processed sucessfully in 12.576496839523315 seconds.
Chunk 49 processed sucessfully in 8.557328939437866 seconds.
Chunk 50 processed sucessfully in 9.006227254867554 seconds.
Chunk 51 processed sucessfully in 7.308640956878662 seconds.
Chunk 52 processed sucessfully in 6.800082445144653 seconds.
Chunk 53 processed sucessfully in 9.72713017463684 seconds.
Chunk 54 processed sucessfully in 11.267854452133179 seconds.
Chunk 55 processed sucessfully in 6.751447916030884 seconds.
Chunk 56 processed sucessfully in 7.8523406982421875 seconds.
Chunk 57 processed sucessfully in 7.844626426696777 seconds.
Chunk 58 processed sucessfully in 10.484244346618652 seconds.
Chunk 59 processed sucessfully in 9.79651427268982 seconds.
Chunk 60 processed sucessfully in 8.072324752807617 seconds.
Chunk 61 processed sucessfully in 11.107304334640503 seconds.
Chunk 62 processed sucessfully in 8.907939672470093 seconds.
Chunk 63 processed sucessfully in 7.690721750259399 seconds.
Chunk 64 processed sucessfully in 13.754353046417236 seconds.
Chunk 65 processed sucessfully in 10.253072500228882 seconds.
Chunk 66 processed sucessfully in 11.333423614501953 seconds.
Chunk 67 processed sucessfully in 14.56236720085144 seconds.
Chunk 68 processed sucessfully in 7.398583889007568 seconds.
Chunk 69 processed sucessfully in 9.372607469558716 seconds.
Chunk 70 processed sucessfully in 8.01703691482544 seconds.
Chunk 71 processed sucessfully in 16.29048180580139 seconds.
Chunk 72 processed sucessfully in 7.994531154632568 seconds.
Chunk 73 processed sucessfully in 11.008782386779785 seconds.
Chunk 74 processed sucessfully in 8.612136125564575 seconds.
Chunk 75 processed sucessfully in 11.12154507637024 seconds.
Chunk 76 processed sucessfully in 11.133208751678467 seconds.
Chunk 77 processed sucessfully in 15.550080060958862 seconds.
Chunk 78 processed sucessfully in 13.50342082977295 seconds.
Chunk 79 processed sucessfully in 6.586763381958008 seconds.
Chunk 80 processed sucessfully in 9.003321886062622 seconds.
Chunk 81 processed sucessfully in 5.388545274734497 seconds.
Chunk 82 processed sucessfully in 8.296855211257935 seconds.
Chunk 83 processed sucessfully in 15.966768264770508 seconds.
Chunk 84 processed sucessfully in 10.587163925170898 seconds.
Chunk 85 processed sucessfully in 15.459435939788818 seconds.
Chunk 86 processed sucessfully in 8.884847640991211 seconds.
Chunk 87 processed sucessfully in 72.90204572677612 seconds.
Chunk 88 processed sucessfully in 12.681055545806885 seconds.
Chunk 89 processed sucessfully in 20.51318907737732 seconds.
Chunk 90 processed sucessfully in 7.61368465423584 seconds.
Chunk 91 processed sucessfully in 9.144746541976929 seconds.
Chunk 92 processed sucessfully in 12.611844301223755 seconds.
Chunk 93 processed sucessfully in 8.325418472290039 seconds.
Chunk 94 processed sucessfully in 7.072360038757324 seconds.
Chunk 95 processed sucessfully in 8.754754304885864 seconds.
Chunk 96 processed sucessfully in 6.333356857299805 seconds.
Chunk 97 processed sucessfully in 23.62648057937622 seconds.
Chunk 98 processed sucessfully in 11.09464406967163 seconds.
Chunk 99 processed sucessfully in 12.188191413879395 seconds.
Chunk 100 processed sucessfully in 9.159373998641968 seconds.
Chunk 101 processed sucessfully in 13.356648683547974 seconds.
Chunk 102 processed sucessfully in 8.125576972961426 seconds.
</pre></div>
</div>
</div>
</div>
<div class="section" id="night-lights">
<h2>Night lights<a class="headerlink" href="#night-lights" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nl</span> <span class="o">=</span> <span class="n">xarray</span><span class="o">.</span><span class="n">open_rasterio</span><span class="p">(</span><span class="s2">&quot;../../urbangrammar_samba/functional_data/employment/night_lights_osgb.tif&quot;</span><span class="p">)</span>
<span class="n">nl_clip</span> <span class="o">=</span> <span class="n">nl</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">clip_box</span><span class="p">(</span><span class="o">*</span><span class="n">chunk</span><span class="o">.</span><span class="n">total_bounds</span><span class="p">)</span>
<span class="n">arr</span> <span class="o">=</span> <span class="n">nl_clip</span><span class="o">.</span><span class="n">values</span>
<span class="n">affine</span> <span class="o">=</span> <span class="n">nl_clip</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">transform</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span> 
<span class="n">stats_nl</span> <span class="o">=</span> <span class="n">rasterstats</span><span class="o">.</span><span class="n">zonal_stats</span><span class="p">(</span>
    <span class="n">chunk</span><span class="o">.</span><span class="n">tessellation</span><span class="p">,</span> 
    <span class="n">raster</span><span class="o">=</span><span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">affine</span><span class="o">=</span><span class="n">affine</span><span class="p">,</span>
    <span class="n">stats</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">],</span>
    <span class="n">all_touched</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">nodata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 1min 42s, sys: 6.97 s, total: 1min 49s
Wall time: 1min 44s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stats_nl</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[{&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 4.674999952316284},
 {&#39;mean&#39;: 4.674999952316284},
 {&#39;mean&#39;: 4.674999952316284},
 {&#39;mean&#39;: 4.674999952316284},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 3.869999885559082},
 {&#39;mean&#39;: 3.869999885559082},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 3.869999885559082},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 3.869999885559082},
 {&#39;mean&#39;: 3.869999885559082},
 {&#39;mean&#39;: 3.869999885559082},
 {&#39;mean&#39;: 3.869999885559082},
 {&#39;mean&#39;: 4.139999866485596},
 {&#39;mean&#39;: 4.139999866485596},
 {&#39;mean&#39;: 4.139999866485596},
 {&#39;mean&#39;: 4.139999866485596},
 {&#39;mean&#39;: 4.139999866485596},
 {&#39;mean&#39;: 4.139999866485596},
 {&#39;mean&#39;: 4.139999866485596},
 {&#39;mean&#39;: 4.139999866485596},
 {&#39;mean&#39;: 4.139999866485596},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 4.139999866485596},
 {&#39;mean&#39;: 4.139999866485596},
 {&#39;mean&#39;: 4.139999866485596},
 {&#39;mean&#39;: 4.139999866485596},
 {&#39;mean&#39;: 4.139999866485596},
 {&#39;mean&#39;: 4.139999866485596},
 {&#39;mean&#39;: 4.139999866485596},
 {&#39;mean&#39;: 4.139999866485596},
 {&#39;mean&#39;: 4.139999866485596},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 5.909999847412109},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 6.019999980926514},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 4.139999866485596},
 {&#39;mean&#39;: 4.139999866485596},
 {&#39;mean&#39;: 4.674999952316284},
 {&#39;mean&#39;: 4.139999866485596},
 {&#39;mean&#39;: 4.674999952316284},
 {&#39;mean&#39;: 4.674999952316284},
 {&#39;mean&#39;: 4.674999952316284},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 3.409999966621399},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 3.409999966621399},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 5.5299999713897705},
 {&#39;mean&#39;: 6.070000171661377},
 {&#39;mean&#39;: 6.070000171661377},
 {&#39;mean&#39;: 6.070000171661377},
 {&#39;mean&#39;: 5.5299999713897705},
 {&#39;mean&#39;: 6.070000171661377},
 {&#39;mean&#39;: 6.070000171661377},
 {&#39;mean&#39;: 6.070000171661377},
 {&#39;mean&#39;: 6.070000171661377},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 5.909999847412109},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.409999966621399},
 {&#39;mean&#39;: 3.409999966621399},
 {&#39;mean&#39;: 3.409999966621399},
 {&#39;mean&#39;: 3.409999966621399},
 {&#39;mean&#39;: 6.019999980926514},
 {&#39;mean&#39;: 6.019999980926514},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 6.070000171661377},
 {&#39;mean&#39;: 6.070000171661377},
 {&#39;mean&#39;: 6.070000171661377},
 {&#39;mean&#39;: 6.070000171661377},
 {&#39;mean&#39;: 6.070000171661377},
 {&#39;mean&#39;: 6.070000171661377},
 {&#39;mean&#39;: 6.070000171661377},
 {&#39;mean&#39;: 6.070000171661377},
 {&#39;mean&#39;: 6.070000171661377},
 {&#39;mean&#39;: 6.070000171661377},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 5.5299999713897705},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 6.070000171661377},
 {&#39;mean&#39;: 5.5299999713897705},
 {&#39;mean&#39;: 6.070000171661377},
 {&#39;mean&#39;: 6.070000171661377},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 6.070000171661377},
 {&#39;mean&#39;: 6.070000171661377},
 {&#39;mean&#39;: 6.070000171661377},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 4.045000076293945},
 {&#39;mean&#39;: 4.045000076293945},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 5.909999847412109},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.989999771118164},
 {&#39;mean&#39;: 4.045000076293945},
 {&#39;mean&#39;: 4.045000076293945},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.644999980926514},
 {&#39;mean&#39;: 5.909999847412109},
 {&#39;mean&#39;: 5.644999980926514},
 {&#39;mean&#39;: 5.644999980926514},
 {&#39;mean&#39;: 5.644999980926514},
 {&#39;mean&#39;: 4.2749998569488525},
 {&#39;mean&#39;: 4.2749998569488525},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 4.045000076293945},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 4.045000076293945},
 {&#39;mean&#39;: 4.045000076293945},
 {&#39;mean&#39;: 4.045000076293945},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 4.045000076293945},
 {&#39;mean&#39;: 3.8799999952316284},
 {&#39;mean&#39;: 4.045000076293945},
 {&#39;mean&#39;: 6.31000018119812},
 {&#39;mean&#39;: 4.87333329518636},
 {&#39;mean&#39;: 5.292500019073486},
 {&#39;mean&#39;: 4.973333358764648},
 {&#39;mean&#39;: 4.8450000286102295},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 6.31000018119812},
 {&#39;mean&#39;: 6.31000018119812},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.31000018119812},
 {&#39;mean&#39;: 6.31000018119812},
 {&#39;mean&#39;: 5.644999980926514},
 {&#39;mean&#39;: 5.644999980926514},
 {&#39;mean&#39;: 6.829999923706055},
 {&#39;mean&#39;: 5.644999980926514},
 {&#39;mean&#39;: 5.644999980926514},
 {&#39;mean&#39;: 5.644999980926514},
 {&#39;mean&#39;: 5.644999980926514},
 {&#39;mean&#39;: 5.644999980926514},
 {&#39;mean&#39;: 5.644999980926514},
 {&#39;mean&#39;: 5.644999980926514},
 {&#39;mean&#39;: 4.460000038146973},
 {&#39;mean&#39;: 5.644999980926514},
 {&#39;mean&#39;: 5.644999980926514},
 {&#39;mean&#39;: 5.644999980926514},
 {&#39;mean&#39;: 6.31000018119812},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.31000018119812},
 {&#39;mean&#39;: 6.31000018119812},
 {&#39;mean&#39;: 6.31000018119812},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 4.139999866485596},
 {&#39;mean&#39;: 4.139999866485596},
 {&#39;mean&#39;: 4.139999866485596},
 {&#39;mean&#39;: 4.139999866485596},
 {&#39;mean&#39;: 4.139999866485596},
 {&#39;mean&#39;: 4.139999866485596},
 {&#39;mean&#39;: 4.139999866485596},
 {&#39;mean&#39;: 4.139999866485596},
 {&#39;mean&#39;: 4.139999866485596},
 {&#39;mean&#39;: 4.139999866485596},
 {&#39;mean&#39;: 4.674999952316284},
 {&#39;mean&#39;: 4.674999952316284},
 {&#39;mean&#39;: 5.210000038146973},
 {&#39;mean&#39;: 4.139999866485596},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 4.139999866485596},
 {&#39;mean&#39;: 3.869999885559082},
 {&#39;mean&#39;: 4.139999866485596},
 {&#39;mean&#39;: 4.139999866485596},
 {&#39;mean&#39;: 4.139999866485596},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 4.139999866485596},
 {&#39;mean&#39;: 4.139999866485596},
 {&#39;mean&#39;: 3.676666577657064},
 {&#39;mean&#39;: 4.139999866485596},
 {&#39;mean&#39;: 3.7149999141693115},
 {&#39;mean&#39;: 3.7149999141693115},
 {&#39;mean&#39;: 3.65749990940094},
 {&#39;mean&#39;: 3.7149999141693115},
 {&#39;mean&#39;: 2.880000114440918},
 {&#39;mean&#39;: 2.880000114440918},
 {&#39;mean&#39;: 2.880000114440918},
 {&#39;mean&#39;: 2.880000114440918},
 {&#39;mean&#39;: 2.880000114440918},
 {&#39;mean&#39;: 2.880000114440918},
 {&#39;mean&#39;: 2.880000114440918},
 {&#39;mean&#39;: 2.880000114440918},
 {&#39;mean&#39;: 2.880000114440918},
 {&#39;mean&#39;: 2.880000114440918},
 {&#39;mean&#39;: 2.880000114440918},
 {&#39;mean&#39;: 2.880000114440918},
 {&#39;mean&#39;: 2.880000114440918},
 {&#39;mean&#39;: 2.880000114440918},
 {&#39;mean&#39;: 2.880000114440918},
 {&#39;mean&#39;: 2.880000114440918},
 {&#39;mean&#39;: 2.880000114440918},
 {&#39;mean&#39;: 3.2899999618530273},
 {&#39;mean&#39;: 3.2899999618530273},
 {&#39;mean&#39;: 3.2899999618530273},
 {&#39;mean&#39;: 3.7149999141693115},
 {&#39;mean&#39;: 3.7149999141693115},
 {&#39;mean&#39;: 3.7149999141693115},
 {&#39;mean&#39;: 3.2899999618530273},
 {&#39;mean&#39;: 3.2899999618530273},
 {&#39;mean&#39;: 3.2899999618530273},
 {&#39;mean&#39;: 3.7149999141693115},
 {&#39;mean&#39;: 3.2899999618530273},
 {&#39;mean&#39;: 3.0850000381469727},
 {&#39;mean&#39;: 3.0850000381469727},
 {&#39;mean&#39;: 3.0850000381469727},
 {&#39;mean&#39;: 2.880000114440918},
 {&#39;mean&#39;: 2.880000114440918},
 {&#39;mean&#39;: 2.880000114440918},
 {&#39;mean&#39;: 3.7149999141693115},
 {&#39;mean&#39;: 3.2899999618530273},
 {&#39;mean&#39;: 3.2899999618530273},
 {&#39;mean&#39;: 3.2899999618530273},
 {&#39;mean&#39;: 3.2899999618530273},
 {&#39;mean&#39;: 3.2899999618530273},
 {&#39;mean&#39;: 3.2899999618530273},
 {&#39;mean&#39;: 3.444999933242798},
 {&#39;mean&#39;: 3.2899999618530273},
 {&#39;mean&#39;: 3.2899999618530273},
 {&#39;mean&#39;: 3.2899999618530273},
 {&#39;mean&#39;: 3.2899999618530273},
 {&#39;mean&#39;: 3.2899999618530273},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 3.409999966621399},
 {&#39;mean&#39;: 3.4733332792917886},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 3.409999966621399},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 3.3466666539510093},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 3.409999966621399},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.3466666539510093},
 {&#39;mean&#39;: 3.409999966621399},
 {&#39;mean&#39;: 3.3466666539510093},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 5.5299999713897705},
 {&#39;mean&#39;: 6.31000018119812},
 {&#39;mean&#39;: 6.070000171661377},
 {&#39;mean&#39;: 6.070000171661377},
 {&#39;mean&#39;: 6.070000171661377},
 {&#39;mean&#39;: 6.31000018119812},
 {&#39;mean&#39;: 5.639999961853027},
 {&#39;mean&#39;: 5.909999847412109},
 {&#39;mean&#39;: 5.909999847412109},
 {&#39;mean&#39;: 5.5299999713897705},
 {&#39;mean&#39;: 3.409999966621399},
 {&#39;mean&#39;: 3.409999966621399},
 {&#39;mean&#39;: 3.5999999046325684},
 {&#39;mean&#39;: 4.424999952316284},
 {&#39;mean&#39;: 4.739999771118164},
 {&#39;mean&#39;: 4.739999771118164},
 {&#39;mean&#39;: 4.956666469573975},
 {&#39;mean&#39;: 3.5828570468085155},
 {&#39;mean&#39;: 5.46999979019165},
 {&#39;mean&#39;: 3.93666664759318},
 {&#39;mean&#39;: 3.1649999618530273},
 {&#39;mean&#39;: 3.0924999713897705},
 {&#39;mean&#39;: 2.359999895095825},
 {&#39;mean&#39;: 3.9033332665761313},
 {&#39;mean&#39;: 3.869999885559082},
 {&#39;mean&#39;: 3.869999885559082},
 {&#39;mean&#39;: 3.869999885559082},
 {&#39;mean&#39;: 3.869999885559082},
 {&#39;mean&#39;: 3.9199999570846558},
 {&#39;mean&#39;: 3.869999885559082},
 {&#39;mean&#39;: 4.069999933242798},
 {&#39;mean&#39;: 4.069999933242798},
 {&#39;mean&#39;: 3.9049999713897705},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.3799999952316284},
 {&#39;mean&#39;: 3.3799999952316284},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.3799999952316284},
 {&#39;mean&#39;: 3.3799999952316284},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.409999966621399},
 {&#39;mean&#39;: 3.409999966621399},
 {&#39;mean&#39;: 3.3799999952316284},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.3799999952316284},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.3799999952316284},
 {&#39;mean&#39;: 3.3799999952316284},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.3799999952316284},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 4.460000038146973},
 {&#39;mean&#39;: 4.460000038146973},
 {&#39;mean&#39;: 4.460000038146973},
 {&#39;mean&#39;: 4.460000038146973},
 {&#39;mean&#39;: 6.31000018119812},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 3.559999942779541},
 {&#39;mean&#39;: 3.559999942779541},
 {&#39;mean&#39;: 3.559999942779541},
 {&#39;mean&#39;: 3.559999942779541},
 {&#39;mean&#39;: 3.559999942779541},
 {&#39;mean&#39;: 3.559999942779541},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.31000018119812},
 {&#39;mean&#39;: 6.31000018119812},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 3.559999942779541},
 {&#39;mean&#39;: 3.559999942779541},
 {&#39;mean&#39;: 3.559999942779541},
 {&#39;mean&#39;: 3.559999942779541},
 {&#39;mean&#39;: 3.559999942779541},
 {&#39;mean&#39;: 3.559999942779541},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 5.055000066757202},
 {&#39;mean&#39;: 5.055000066757202},
 {&#39;mean&#39;: 3.559999942779541},
 {&#39;mean&#39;: 5.055000066757202},
 {&#39;mean&#39;: 3.559999942779541},
 {&#39;mean&#39;: 3.559999942779541},
 {&#39;mean&#39;: 4.460000038146973},
 {&#39;mean&#39;: 4.460000038146973},
 {&#39;mean&#39;: 4.460000038146973},
 {&#39;mean&#39;: 4.460000038146973},
 {&#39;mean&#39;: 4.460000038146973},
 {&#39;mean&#39;: 4.460000038146973},
 {&#39;mean&#39;: 4.460000038146973},
 {&#39;mean&#39;: 4.460000038146973},
 {&#39;mean&#39;: 4.460000038146973},
 {&#39;mean&#39;: 4.460000038146973},
 {&#39;mean&#39;: 4.460000038146973},
 {&#39;mean&#39;: 4.460000038146973},
 {&#39;mean&#39;: 4.460000038146973},
 {&#39;mean&#39;: 4.460000038146973},
 {&#39;mean&#39;: 4.460000038146973},
 {&#39;mean&#39;: 4.460000038146973},
 {&#39;mean&#39;: 4.460000038146973},
 {&#39;mean&#39;: 4.460000038146973},
 {&#39;mean&#39;: 4.460000038146973},
 {&#39;mean&#39;: 4.460000038146973},
 {&#39;mean&#39;: 4.460000038146973},
 {&#39;mean&#39;: 4.269999980926514},
 {&#39;mean&#39;: 4.269999980926514},
 {&#39;mean&#39;: 4.269999980926514},
 {&#39;mean&#39;: 4.269999980926514},
 {&#39;mean&#39;: 4.269999980926514},
 {&#39;mean&#39;: 4.269999980926514},
 {&#39;mean&#39;: 4.269999980926514},
 {&#39;mean&#39;: 4.269999980926514},
 {&#39;mean&#39;: 4.269999980926514},
 {&#39;mean&#39;: 4.269999980926514},
 {&#39;mean&#39;: 4.269999980926514},
 {&#39;mean&#39;: 4.269999980926514},
 {&#39;mean&#39;: 4.269999980926514},
 {&#39;mean&#39;: 4.269999980926514},
 {&#39;mean&#39;: 4.269999980926514},
 {&#39;mean&#39;: 3.9049999713897705},
 {&#39;mean&#39;: 3.9049999713897705},
 {&#39;mean&#39;: 3.9049999713897705},
 {&#39;mean&#39;: 3.9049999713897705},
 {&#39;mean&#39;: 3.9049999713897705},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.9049999713897705},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 4.460000038146973},
 {&#39;mean&#39;: 4.460000038146973},
 {&#39;mean&#39;: 4.460000038146973},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.210000038146973},
 {&#39;mean&#39;: 3.559999942779541},
 {&#39;mean&#39;: 5.055000066757202},
 {&#39;mean&#39;: 3.559999942779541},
 {&#39;mean&#39;: 3.559999942779541},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 5.055000066757202},
 {&#39;mean&#39;: 5.055000066757202},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 3.559999942779541},
 {&#39;mean&#39;: 3.559999942779541},
 {&#39;mean&#39;: 3.559999942779541},
 {&#39;mean&#39;: 3.559999942779541},
 {&#39;mean&#39;: 3.559999942779541},
 {&#39;mean&#39;: 4.2749998569488525},
 {&#39;mean&#39;: 4.959999918937683},
 {&#39;mean&#39;: 4.2749998569488525},
 {&#39;mean&#39;: 4.2749998569488525},
 {&#39;mean&#39;: 4.2749998569488525},
 {&#39;mean&#39;: 3.559999942779541},
 {&#39;mean&#39;: 3.559999942779541},
 {&#39;mean&#39;: 4.009999990463257},
 {&#39;mean&#39;: 3.559999942779541},
 {&#39;mean&#39;: 3.559999942779541},
 {&#39;mean&#39;: 3.559999942779541},
 {&#39;mean&#39;: 3.559999942779541},
 {&#39;mean&#39;: 4.009999990463257},
 {&#39;mean&#39;: 4.009999990463257},
 {&#39;mean&#39;: 4.009999990463257},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 6.210000038146973},
 {&#39;mean&#39;: 6.210000038146973},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 6.210000038146973},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 6.210000038146973},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 4.919999957084656},
 {&#39;mean&#39;: 4.919999957084656},
 {&#39;mean&#39;: 4.919999957084656},
 {&#39;mean&#39;: 4.919999957084656},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.869999885559082},
 {&#39;mean&#39;: 5.020000100135803},
 {&#39;mean&#39;: 3.9700000286102295},
 {&#39;mean&#39;: 5.020000100135803},
 {&#39;mean&#39;: 3.9700000286102295},
 {&#39;mean&#39;: 5.020000100135803},
 {&#39;mean&#39;: 4.919999957084656},
 {&#39;mean&#39;: 4.919999957084656},
 {&#39;mean&#39;: 5.615000069141388},
 {&#39;mean&#39;: 6.210000038146973},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.3799999952316284},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.3799999952316284},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.3799999952316284},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.3799999952316284},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.2200000286102295},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 6.550000190734863},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.9049999713897705},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.5399999618530273},
 {&#39;mean&#39;: 3.9049999713897705},
 {&#39;mean&#39;: 4.269999980926514},
 {&#39;mean&#39;: 3.9049999713897705},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 4.829999923706055},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 3.559999942779541},
 {&#39;mean&#39;: 3.559999942779541},
 {&#39;mean&#39;: 4.829999923706055},
 {&#39;mean&#39;: 3.559999942779541},
 {&#39;mean&#39;: 4.829999923706055},
 {&#39;mean&#39;: 3.309999942779541},
 {&#39;mean&#39;: 3.559999942779541},
 {&#39;mean&#39;: 3.309999942779541},
 {&#39;mean&#39;: 3.559999942779541},
 {&#39;mean&#39;: 3.559999942779541},
 {&#39;mean&#39;: 3.559999942779541},
 {&#39;mean&#39;: 3.559999942779541},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 4.829999923706055},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 4.829999923706055},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 4.829999923706055},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 4.829999923706055},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 5.75},
 {&#39;mean&#39;: 5.136666615804036},
 {&#39;mean&#39;: 5.75},
 {&#39;mean&#39;: 5.269999980926514},
 {&#39;mean&#39;: 8.454999923706055},
 {&#39;mean&#39;: 8.454999923706055},
 {&#39;mean&#39;: 5.75},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 5.75},
 {&#39;mean&#39;: 5.75},
 {&#39;mean&#39;: 5.75},
 {&#39;mean&#39;: 5.75},
 {&#39;mean&#39;: 6.099999904632568},
 {&#39;mean&#39;: 5.924999952316284},
 {&#39;mean&#39;: 5.75},
 {&#39;mean&#39;: 5.75},
 {&#39;mean&#39;: 5.75},
 {&#39;mean&#39;: 5.75},
 {&#39;mean&#39;: 5.75},
 {&#39;mean&#39;: 5.924999952316284},
 {&#39;mean&#39;: 5.924999952316284},
 {&#39;mean&#39;: 5.75},
 {&#39;mean&#39;: 5.75},
 {&#39;mean&#39;: 12.40999984741211},
 {&#39;mean&#39;: 12.40999984741211},
 {&#39;mean&#39;: 12.40999984741211},
 {&#39;mean&#39;: 12.40999984741211},
 {&#39;mean&#39;: 12.40999984741211},
 {&#39;mean&#39;: 12.40999984741211},
 {&#39;mean&#39;: 12.40999984741211},
 {&#39;mean&#39;: 12.40999984741211},
 {&#39;mean&#39;: 12.40999984741211},
 {&#39;mean&#39;: 12.40999984741211},
 {&#39;mean&#39;: 12.40999984741211},
 {&#39;mean&#39;: 12.40999984741211},
 {&#39;mean&#39;: 12.40999984741211},
 {&#39;mean&#39;: 12.40999984741211},
 {&#39;mean&#39;: 12.40999984741211},
 {&#39;mean&#39;: 12.40999984741211},
 {&#39;mean&#39;: 12.40999984741211},
 {&#39;mean&#39;: 12.40999984741211},
 {&#39;mean&#39;: 4.5},
 {&#39;mean&#39;: 4.5},
 {&#39;mean&#39;: 4.5},
 {&#39;mean&#39;: 8.454999923706055},
 {&#39;mean&#39;: 8.454999923706055},
 {&#39;mean&#39;: 4.5},
 {&#39;mean&#39;: 4.5},
 {&#39;mean&#39;: 4.5},
 {&#39;mean&#39;: 8.454999923706055},
 {&#39;mean&#39;: 4.5},
 {&#39;mean&#39;: 8.454999923706055},
 {&#39;mean&#39;: 4.5},
 {&#39;mean&#39;: 4.5},
 {&#39;mean&#39;: 4.5},
 {&#39;mean&#39;: 8.454999923706055},
 {&#39;mean&#39;: 4.5},
 {&#39;mean&#39;: 4.5},
 {&#39;mean&#39;: 4.5},
 {&#39;mean&#39;: 4.5},
 {&#39;mean&#39;: 8.454999923706055},
 {&#39;mean&#39;: 4.5},
 {&#39;mean&#39;: 4.5},
 ...]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">workers</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">LocalCluster</span><span class="p">(</span><span class="n">n_workers</span><span class="o">=</span><span class="n">workers</span><span class="p">,</span> <span class="n">threads_per_worker</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="n">client</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table style="border: 2px solid white;">
<tr>
<td style="vertical-align: top; border: 0px solid white">
<h3 style="text-align: left;">Client</h3>
<ul style="text-align: left; list-style: none; margin: 0; padding: 0;">
  <li><b>Scheduler: </b>tcp://127.0.0.1:38779</li>
  <li><b>Dashboard: </b><a href='http://127.0.0.1:8787/status' target='_blank'>http://127.0.0.1:8787/status</a></li>
</ul>
</td>
<td style="vertical-align: top; border: 0px solid white">
<h3 style="text-align: left;">Cluster</h3>
<ul style="text-align: left; list-style:none; margin: 0; padding: 0;">
  <li><b>Workers: </b>8</li>
  <li><b>Cores: </b>8</li>
  <li><b>Memory: </b>134.91 GB</li>
</ul>
</td>
</tr>
</table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">_night_lights</span><span class="p">(</span><span class="n">chunk_id</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">rioxarray</span>
    
    <span class="n">s</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
    
    <span class="n">chunk</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/tessellation/tess_</span><span class="si">{</span><span class="n">chunk_id</span><span class="si">}</span><span class="s2">.pq&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;hindex&quot;</span><span class="p">,</span> <span class="s2">&quot;tessellation&quot;</span><span class="p">])</span>
    <span class="n">nl</span> <span class="o">=</span> <span class="n">xarray</span><span class="o">.</span><span class="n">open_rasterio</span><span class="p">(</span><span class="s2">&quot;../../urbangrammar_samba/functional_data/employment/night_lights_osgb.tif&quot;</span><span class="p">)</span>
    <span class="n">nl_clip</span> <span class="o">=</span> <span class="n">nl</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">clip_box</span><span class="p">(</span><span class="o">*</span><span class="n">chunk</span><span class="o">.</span><span class="n">total_bounds</span><span class="p">)</span>
    <span class="n">arr</span> <span class="o">=</span> <span class="n">nl_clip</span><span class="o">.</span><span class="n">values</span>
    <span class="n">affine</span> <span class="o">=</span> <span class="n">nl_clip</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">transform</span><span class="p">()</span>
    <span class="n">stats_nl</span> <span class="o">=</span> <span class="n">rasterstats</span><span class="o">.</span><span class="n">zonal_stats</span><span class="p">(</span>
        <span class="n">chunk</span><span class="o">.</span><span class="n">tessellation</span><span class="p">,</span> 
        <span class="n">raster</span><span class="o">=</span><span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">affine</span><span class="o">=</span><span class="n">affine</span><span class="p">,</span>
        <span class="n">stats</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">],</span>
        <span class="n">all_touched</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">nodata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">chunk</span><span class="p">[</span><span class="s2">&quot;night_lights&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">stats_nl</span><span class="p">]</span>
    <span class="n">chunk</span><span class="p">[[</span><span class="s2">&quot;hindex&quot;</span><span class="p">,</span> <span class="s2">&quot;night_lights&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/functional/night_lights/nl_</span><span class="si">{</span><span class="n">chunk_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Chunk </span><span class="si">{</span><span class="n">chunk_id</span><span class="si">}</span><span class="s2"> processed sucessfully in </span><span class="si">{</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">s</span><span class="si">}</span><span class="s2"> seconds.&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">103</span><span class="p">))</span>
<span class="n">futures</span> <span class="o">=</span> <span class="p">[</span><span class="n">client</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">_night_lights</span><span class="p">,</span> <span class="nb">next</span><span class="p">(</span><span class="n">inputs</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">workers</span><span class="p">)]</span>
<span class="n">ac</span> <span class="o">=</span> <span class="n">as_completed</span><span class="p">(</span><span class="n">futures</span><span class="p">)</span>
<span class="k">for</span> <span class="n">finished_future</span> <span class="ow">in</span> <span class="n">ac</span><span class="p">:</span>
    <span class="c1"># submit new future </span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">new_future</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">_night_lights</span><span class="p">,</span> <span class="nb">next</span><span class="p">(</span><span class="n">inputs</span><span class="p">))</span>
        <span class="n">ac</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new_future</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">finished_future</span><span class="o">.</span><span class="n">result</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 3 processed sucessfully in 101.62825918197632 seconds.
Chunk 0 processed sucessfully in 108.6822566986084 seconds.
Chunk 2 processed sucessfully in 115.19350171089172 seconds.
Chunk 1 processed sucessfully in 122.15239238739014 seconds.
Chunk 7 processed sucessfully in 135.8249044418335 seconds.
Chunk 4 processed sucessfully in 151.0806565284729 seconds.
Chunk 11 processed sucessfully in 96.01190829277039 seconds.
Chunk 10 processed sucessfully in 106.74090838432312 seconds.
Chunk 5 processed sucessfully in 222.54443430900574 seconds.
Chunk 9 processed sucessfully in 118.09922075271606 seconds.
Chunk 8 processed sucessfully in 138.83542704582214 seconds.
Chunk 6 processed sucessfully in 245.05762553215027 seconds.
Chunk 13 processed sucessfully in 131.59788346290588 seconds.
Chunk 15 processed sucessfully in 100.00797629356384 seconds.
Chunk 12 processed sucessfully in 189.21026062965393 seconds.
Chunk 16 processed sucessfully in 110.26696038246155 seconds.
Chunk 17 processed sucessfully in 106.11720705032349 seconds.
Chunk 18 processed sucessfully in 96.18992209434509 seconds.
Chunk 14 processed sucessfully in 140.87093257904053 seconds.
Chunk 19 processed sucessfully in 138.64996123313904 seconds.
Chunk 20 processed sucessfully in 101.9511969089508 seconds.
Chunk 21 processed sucessfully in 101.76437902450562 seconds.
Chunk 22 processed sucessfully in 101.0459156036377 seconds.
Chunk 25 processed sucessfully in 94.92612791061401 seconds.
Chunk 23 processed sucessfully in 100.61872792243958 seconds.
Chunk 24 processed sucessfully in 143.85778379440308 seconds.
Chunk 28 processed sucessfully in 98.6511640548706 seconds.
Chunk 26 processed sucessfully in 149.18314170837402 seconds.
Chunk 27 processed sucessfully in 132.90636014938354 seconds.
Chunk 29 processed sucessfully in 115.51502442359924 seconds.
Chunk 30 processed sucessfully in 116.42731094360352 seconds.
Chunk 31 processed sucessfully in 123.73720860481262 seconds.
Chunk 34 processed sucessfully in 109.74327087402344 seconds.
Chunk 33 processed sucessfully in 119.46904826164246 seconds.
Chunk 36 processed sucessfully in 101.37444949150085 seconds.
Chunk 32 processed sucessfully in 193.43646478652954 seconds.
Chunk 35 processed sucessfully in 125.17357873916626 seconds.
Chunk 39 processed sucessfully in 112.63721680641174 seconds.
Chunk 37 processed sucessfully in 142.00179624557495 seconds.
Chunk 41 processed sucessfully in 123.84309720993042 seconds.
Chunk 43 processed sucessfully in 108.66190791130066 seconds.
Chunk 44 processed sucessfully in 108.84255719184875 seconds.
Chunk 38 processed sucessfully in 214.8878664970398 seconds.
Chunk 42 processed sucessfully in 141.92127871513367 seconds.
Chunk 45 processed sucessfully in 126.95859885215759 seconds.
Chunk 40 processed sucessfully in 210.22668433189392 seconds.
Chunk 46 processed sucessfully in 130.38542461395264 seconds.
Chunk 47 processed sucessfully in 107.3020806312561 seconds.
Chunk 48 processed sucessfully in 117.02449750900269 seconds.
Chunk 49 processed sucessfully in 126.16321659088135 seconds.
Chunk 51 processed sucessfully in 111.30655455589294 seconds.
Chunk 50 processed sucessfully in 134.84748768806458 seconds.
Chunk 52 processed sucessfully in 98.01691603660583 seconds.
Chunk 53 processed sucessfully in 117.51246094703674 seconds.
Chunk 55 processed sucessfully in 95.78628873825073 seconds.
Chunk 54 processed sucessfully in 115.85429787635803 seconds.
Chunk 56 processed sucessfully in 119.20770120620728 seconds.
Chunk 58 processed sucessfully in 113.76907634735107 seconds.
Chunk 57 processed sucessfully in 121.98187804222107 seconds.
Chunk 60 processed sucessfully in 113.2664635181427 seconds.
Chunk 59 processed sucessfully in 122.7981789112091 seconds.
Chunk 63 processed sucessfully in 112.39697980880737 seconds.
Chunk 62 processed sucessfully in 135.0854411125183 seconds.
Chunk 65 processed sucessfully in 146.32753658294678 seconds.
Chunk 61 processed sucessfully in 211.46607542037964 seconds.
Chunk 66 processed sucessfully in 155.82709622383118 seconds.
Chunk 68 processed sucessfully in 143.95870995521545 seconds.
Chunk 69 processed sucessfully in 125.38387680053711 seconds.
Chunk 64 processed sucessfully in 204.88879561424255 seconds.
Chunk 70 processed sucessfully in 132.9638316631317 seconds.
Chunk 67 processed sucessfully in 193.78993225097656 seconds.
Chunk 72 processed sucessfully in 112.94817781448364 seconds.
Chunk 71 processed sucessfully in 122.566561460495 seconds.
Chunk 74 processed sucessfully in 116.82614398002625 seconds.
Chunk 73 processed sucessfully in 148.04683184623718 seconds.
Chunk 78 processed sucessfully in 108.32322216033936 seconds.
Chunk 76 processed sucessfully in 140.81055283546448 seconds.
Chunk 75 processed sucessfully in 154.37837100028992 seconds.
Chunk 77 processed sucessfully in 128.91402673721313 seconds.
Chunk 79 processed sucessfully in 102.94285678863525 seconds.
Chunk 81 processed sucessfully in 102.62431001663208 seconds.
Chunk 80 processed sucessfully in 137.5996527671814 seconds.
Chunk 82 processed sucessfully in 124.79260563850403 seconds.
Chunk 84 processed sucessfully in 107.91151261329651 seconds.
Chunk 83 processed sucessfully in 140.00971031188965 seconds.
Chunk 86 processed sucessfully in 133.80312609672546 seconds.
Chunk 85 processed sucessfully in 167.24382519721985 seconds.
Chunk 87 processed sucessfully in 139.44678568840027 seconds.
Chunk 90 processed sucessfully in 103.32630372047424 seconds.
Chunk 88 processed sucessfully in 145.87574434280396 seconds.
Chunk 91 processed sucessfully in 108.21565079689026 seconds.
Chunk 93 processed sucessfully in 97.64255046844482 seconds.
Chunk 94 processed sucessfully in 97.6534776687622 seconds.
Chunk 95 processed sucessfully in 111.41735768318176 seconds.
Chunk 89 processed sucessfully in 214.96267175674438 seconds.
Chunk 92 processed sucessfully in 158.95460724830627 seconds.
Chunk 96 processed sucessfully in 99.61702299118042 seconds.
Chunk 97 processed sucessfully in 107.10965180397034 seconds.
Chunk 99 processed sucessfully in 125.9698793888092 seconds.
Chunk 100 processed sucessfully in 114.7315890789032 seconds.
Chunk 98 processed sucessfully in 171.67523050308228 seconds.
Chunk 102 processed sucessfully in 107.2398579120636 seconds.
Chunk 101 processed sucessfully in 210.63564276695251 seconds.
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="worplace-population-by-industry">
<h2>Worplace population by industry<a class="headerlink" href="#worplace-population-by-industry" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wpz</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s1">&#39;../../urbangrammar_samba/functional_data/employment/workplace/workplace_by_industry_gb.pq&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">chunk_id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">103</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
    <span class="n">chunk</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/tessellation/tess_</span><span class="si">{</span><span class="n">chunk_id</span><span class="si">}</span><span class="s2">.pq&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;hindex&quot;</span><span class="p">,</span> <span class="s2">&quot;buildings&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">set_geometry</span><span class="p">(</span><span class="s2">&quot;buildings&quot;</span><span class="p">)</span>
    <span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">chunk</span><span class="o">.</span><span class="n">total_bounds</span>
    <span class="n">ests</span> <span class="o">=</span> <span class="n">tobler</span><span class="o">.</span><span class="n">area_weighted</span><span class="o">.</span><span class="n">area_interpolate</span><span class="p">(</span><span class="n">wpz</span><span class="o">.</span><span class="n">cx</span><span class="p">[</span><span class="n">xmin</span><span class="p">:</span><span class="n">xmax</span><span class="p">,</span> <span class="n">ymin</span><span class="p">:</span><span class="n">ymax</span><span class="p">],</span> <span class="n">chunk</span><span class="p">,</span> <span class="n">extensive_variables</span><span class="o">=</span><span class="n">wpz</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">())</span>
    <span class="n">ests</span><span class="p">[</span><span class="s1">&#39;hindex&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">chunk</span><span class="o">.</span><span class="n">hindex</span><span class="o">.</span><span class="n">values</span>
    <span class="n">ests</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;geometry&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/functional/workplace/pop_</span><span class="si">{</span><span class="n">chunk_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Chunk </span><span class="si">{</span><span class="n">chunk_id</span><span class="si">}</span><span class="s2"> processed sucessfully in </span><span class="si">{</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">s</span><span class="si">}</span><span class="s2"> seconds.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 0 processed sucessfully in 4.339667081832886 seconds.
Chunk 1 processed sucessfully in 4.707739353179932 seconds.
Chunk 2 processed sucessfully in 4.347376346588135 seconds.
Chunk 3 processed sucessfully in 3.9326553344726562 seconds.
Chunk 4 processed sucessfully in 6.005887031555176 seconds.
Chunk 5 processed sucessfully in 10.901556253433228 seconds.
Chunk 6 processed sucessfully in 10.061571836471558 seconds.
Chunk 7 processed sucessfully in 5.373244285583496 seconds.
Chunk 8 processed sucessfully in 5.54592227935791 seconds.
Chunk 9 processed sucessfully in 4.712031602859497 seconds.
Chunk 10 processed sucessfully in 4.334367275238037 seconds.
Chunk 11 processed sucessfully in 4.112551212310791 seconds.
Chunk 12 processed sucessfully in 7.6018900871276855 seconds.
Chunk 13 processed sucessfully in 5.514501094818115 seconds.
Chunk 14 processed sucessfully in 5.70710563659668 seconds.
Chunk 15 processed sucessfully in 5.131793260574341 seconds.
Chunk 16 processed sucessfully in 4.482264757156372 seconds.
Chunk 17 processed sucessfully in 4.294769287109375 seconds.
Chunk 18 processed sucessfully in 4.081661939620972 seconds.
Chunk 19 processed sucessfully in 5.647871494293213 seconds.
Chunk 20 processed sucessfully in 4.536542177200317 seconds.
Chunk 21 processed sucessfully in 4.321038484573364 seconds.
Chunk 22 processed sucessfully in 4.270464181900024 seconds.
Chunk 23 processed sucessfully in 4.08439040184021 seconds.
Chunk 24 processed sucessfully in 5.9558069705963135 seconds.
Chunk 25 processed sucessfully in 3.8234286308288574 seconds.
Chunk 26 processed sucessfully in 6.06632924079895 seconds.
Chunk 27 processed sucessfully in 5.437521457672119 seconds.
Chunk 28 processed sucessfully in 4.044689178466797 seconds.
Chunk 29 processed sucessfully in 4.635800123214722 seconds.
Chunk 30 processed sucessfully in 4.824749946594238 seconds.
Chunk 31 processed sucessfully in 5.066036939620972 seconds.
Chunk 32 processed sucessfully in 7.901488542556763 seconds.
Chunk 33 processed sucessfully in 4.961339235305786 seconds.
Chunk 34 processed sucessfully in 5.217444658279419 seconds.
Chunk 35 processed sucessfully in 5.148958921432495 seconds.
Chunk 36 processed sucessfully in 4.371359825134277 seconds.
Chunk 37 processed sucessfully in 5.85659646987915 seconds.
Chunk 38 processed sucessfully in 9.245384693145752 seconds.
Chunk 39 processed sucessfully in 4.758932828903198 seconds.
Chunk 40 processed sucessfully in 8.429875612258911 seconds.
Chunk 41 processed sucessfully in 5.242368936538696 seconds.
Chunk 42 processed sucessfully in 6.48029899597168 seconds.
Chunk 43 processed sucessfully in 4.376807451248169 seconds.
Chunk 44 processed sucessfully in 4.464801549911499 seconds.
Chunk 45 processed sucessfully in 5.512848854064941 seconds.
Chunk 46 processed sucessfully in 5.31675124168396 seconds.
Chunk 47 processed sucessfully in 4.655490875244141 seconds.
Chunk 48 processed sucessfully in 5.132812976837158 seconds.
Chunk 49 processed sucessfully in 5.258089065551758 seconds.
Chunk 50 processed sucessfully in 5.555590867996216 seconds.
Chunk 51 processed sucessfully in 4.771127462387085 seconds.
Chunk 52 processed sucessfully in 4.057063341140747 seconds.
Chunk 53 processed sucessfully in 4.942548990249634 seconds.
Chunk 54 processed sucessfully in 5.032382249832153 seconds.
Chunk 55 processed sucessfully in 4.095034837722778 seconds.
Chunk 56 processed sucessfully in 4.977262735366821 seconds.
Chunk 57 processed sucessfully in 5.027353048324585 seconds.
Chunk 58 processed sucessfully in 4.670578241348267 seconds.
Chunk 59 processed sucessfully in 5.135795593261719 seconds.
Chunk 60 processed sucessfully in 4.671122789382935 seconds.
Chunk 61 processed sucessfully in 8.880449771881104 seconds.
Chunk 62 processed sucessfully in 5.604400873184204 seconds.
Chunk 63 processed sucessfully in 4.67211127281189 seconds.
Chunk 64 processed sucessfully in 8.094477891921997 seconds.
Chunk 65 processed sucessfully in 6.022216558456421 seconds.
Chunk 66 processed sucessfully in 6.465723752975464 seconds.
Chunk 67 processed sucessfully in 7.837080955505371 seconds.
Chunk 68 processed sucessfully in 5.973193168640137 seconds.
Chunk 69 processed sucessfully in 5.307929039001465 seconds.
Chunk 70 processed sucessfully in 5.387362718582153 seconds.
Chunk 71 processed sucessfully in 5.858233451843262 seconds.
Chunk 72 processed sucessfully in 4.696798801422119 seconds.
Chunk 73 processed sucessfully in 6.033826112747192 seconds.
Chunk 74 processed sucessfully in 4.885943412780762 seconds.
Chunk 75 processed sucessfully in 6.394996643066406 seconds.
Chunk 76 processed sucessfully in 6.0048158168792725 seconds.
Chunk 77 processed sucessfully in 5.594425439834595 seconds.
Chunk 78 processed sucessfully in 4.688212871551514 seconds.
Chunk 79 processed sucessfully in 4.243328332901001 seconds.
Chunk 80 processed sucessfully in 5.588174819946289 seconds.
Chunk 81 processed sucessfully in 4.6399085521698 seconds.
Chunk 82 processed sucessfully in 5.229525089263916 seconds.
Chunk 83 processed sucessfully in 6.632182836532593 seconds.
Chunk 84 processed sucessfully in 4.818341016769409 seconds.
Chunk 85 processed sucessfully in 7.419586420059204 seconds.
Chunk 86 processed sucessfully in 5.356421709060669 seconds.
Chunk 87 processed sucessfully in 10.653902769088745 seconds.
Chunk 88 processed sucessfully in 6.0132811069488525 seconds.
Chunk 89 processed sucessfully in 9.062174797058105 seconds.
Chunk 90 processed sucessfully in 4.185963869094849 seconds.
Chunk 91 processed sucessfully in 4.496687650680542 seconds.
Chunk 92 processed sucessfully in 6.412658452987671 seconds.
Chunk 93 processed sucessfully in 4.199322462081909 seconds.
Chunk 94 processed sucessfully in 3.998373508453369 seconds.
Chunk 95 processed sucessfully in 4.693262577056885 seconds.
Chunk 96 processed sucessfully in 4.068650722503662 seconds.
Chunk 97 processed sucessfully in 6.195067882537842 seconds.
Chunk 98 processed sucessfully in 7.321539402008057 seconds.
Chunk 99 processed sucessfully in 9.910168886184692 seconds.
Chunk 100 processed sucessfully in 5.308680772781372 seconds.
Chunk 101 processed sucessfully in 9.048706769943237 seconds.
Chunk 102 processed sucessfully in 4.633718013763428 seconds.
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="corine-land-cover">
<h2>CORINE Land cover<a class="headerlink" href="#corine-land-cover" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">corine</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s2">&quot;../../urbangrammar_samba/functional_data/land_use/corine/corine_gb.pq&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">corine</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Code_18</th>
      <th>Remark</th>
      <th>Area_Ha</th>
      <th>ID</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>112</td>
      <td>None</td>
      <td>1.893751e+02</td>
      <td>EU_514927</td>
      <td>MULTIPOLYGON (((274002.422 39453.334, 273980.8...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>112</td>
      <td>None</td>
      <td>2.696926e+01</td>
      <td>EU_514928</td>
      <td>MULTIPOLYGON (((271153.999 39775.080, 271144.0...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>112</td>
      <td>None</td>
      <td>4.202325e+01</td>
      <td>EU_514929</td>
      <td>MULTIPOLYGON (((267987.903 40256.489, 267988.2...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>112</td>
      <td>None</td>
      <td>2.576880e+01</td>
      <td>EU_514930</td>
      <td>MULTIPOLYGON (((280792.702 43134.915, 280767.8...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>112</td>
      <td>None</td>
      <td>2.976197e+01</td>
      <td>EU_514931</td>
      <td>MULTIPOLYGON (((278839.382 42981.648, 278811.9...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>71785</th>
      <td>231</td>
      <td>None</td>
      <td>3.937547e+01</td>
      <td>EU_1596493</td>
      <td>MULTIPOLYGON (((608620.221 323294.882, 608615....</td>
    </tr>
    <tr>
      <th>71786</th>
      <td>231</td>
      <td>None</td>
      <td>1.024217e+02</td>
      <td>EU_1596519</td>
      <td>MULTIPOLYGON (((608837.110 324476.901, 608680....</td>
    </tr>
    <tr>
      <th>71787</th>
      <td>112</td>
      <td>None</td>
      <td>7.649168e+01</td>
      <td>EU_1573352</td>
      <td>MULTIPOLYGON (((610635.771 323374.952, 610577....</td>
    </tr>
    <tr>
      <th>71788</th>
      <td>512</td>
      <td>None</td>
      <td>2.985387e+01</td>
      <td>EU_1625523</td>
      <td>MULTIPOLYGON (((597901.209 325401.890, 597852....</td>
    </tr>
    <tr>
      <th>71789</th>
      <td>523</td>
      <td>None</td>
      <td>3.428866e+06</td>
      <td>EU_2364838</td>
      <td>MULTIPOLYGON (((1070758.429 489408.563, 107073...</td>
    </tr>
  </tbody>
</table>
<p>71790 rows × 5 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">_dask_binning</span><span class="p">(</span><span class="n">corine</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">n_chunks</span><span class="o">=</span><span class="mi">512</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">dask_geopandas</span> <span class="k">as</span> <span class="nn">dgpd</span>
    <span class="kn">from</span> <span class="nn">scipy.sparse</span> <span class="kn">import</span> <span class="n">coo_matrix</span>
    
    <span class="n">ids_src</span><span class="p">,</span> <span class="n">ids_tgt</span> <span class="o">=</span> <span class="n">cells</span><span class="o">.</span><span class="n">sindex</span><span class="o">.</span><span class="n">query_bulk</span><span class="p">(</span><span class="n">corine</span><span class="o">.</span><span class="n">geometry</span><span class="p">,</span> <span class="n">predicate</span><span class="o">=</span><span class="s2">&quot;intersects&quot;</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">({</span><span class="s1">&#39;clc&#39;</span><span class="p">:</span> <span class="n">corine</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">ids_src</span><span class="p">],</span> <span class="s1">&#39;tess&#39;</span><span class="p">:</span> <span class="n">cells</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">ids_tgt</span><span class="p">]})</span>
    <span class="n">ddf</span> <span class="o">=</span> <span class="n">dgpd</span><span class="o">.</span><span class="n">from_geopandas</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">npartitions</span><span class="o">=</span><span class="n">n_chunks</span><span class="p">)</span>
    <span class="n">areas</span> <span class="o">=</span> <span class="n">ddf</span><span class="o">.</span><span class="n">clc</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">ddf</span><span class="o">.</span><span class="n">tess</span><span class="p">)</span><span class="o">.</span><span class="n">area</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
    <span class="n">table</span> <span class="o">=</span> <span class="n">coo_matrix</span><span class="p">(</span>
        <span class="p">(</span><span class="n">areas</span><span class="p">,</span> <span class="p">(</span><span class="n">ids_src</span><span class="p">,</span> <span class="n">ids_tgt</span><span class="p">),),</span>
        <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">corine</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cells</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
        <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">table</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">todok</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">table</span>


<span class="k">def</span> <span class="nf">_dask_area_interpolate</span><span class="p">(</span><span class="n">corine</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">n_chunks</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">categorical_variables</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">table</span> <span class="o">=</span> <span class="n">_dask_binning</span><span class="p">(</span><span class="n">corine</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">n_chunks</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">categorical_variables</span><span class="p">:</span>
        <span class="n">categorical</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">variable</span> <span class="ow">in</span> <span class="n">categorical_variables</span><span class="p">:</span>
            <span class="n">unique</span> <span class="o">=</span> <span class="n">corine</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">unique</span><span class="p">:</span>
                <span class="n">mask</span> <span class="o">=</span> <span class="n">corine</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span> <span class="o">==</span> <span class="n">value</span>
                <span class="n">categorical</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">variable</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span>
                    <span class="n">table</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">categorical</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">categorical</span><span class="p">)</span>
        <span class="n">categorical</span> <span class="o">=</span> <span class="n">categorical</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">cells</span><span class="o">.</span><span class="n">area</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;rows&quot;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">categorical</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">chunk_id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">103</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
    <span class="n">chunk</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/tessellation/tess_</span><span class="si">{</span><span class="n">chunk_id</span><span class="si">}</span><span class="s2">.pq&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;hindex&quot;</span><span class="p">,</span> <span class="s2">&quot;tessellation&quot;</span><span class="p">])</span>
    <span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">chunk</span><span class="o">.</span><span class="n">total_bounds</span>
    <span class="n">ests</span> <span class="o">=</span> <span class="n">_dask_area_interpolate</span><span class="p">(</span><span class="n">corine</span><span class="o">.</span><span class="n">cx</span><span class="p">[</span><span class="n">xmin</span><span class="p">:</span><span class="n">xmax</span><span class="p">,</span> <span class="n">ymin</span><span class="p">:</span><span class="n">ymax</span><span class="p">],</span> <span class="n">chunk</span><span class="p">,</span> <span class="n">categorical_variables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Code_18&quot;</span><span class="p">])</span>
    <span class="n">ests</span><span class="p">[</span><span class="s1">&#39;hindex&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">chunk</span><span class="o">.</span><span class="n">hindex</span><span class="o">.</span><span class="n">values</span>
    <span class="n">ests</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;../../urbangrammar_samba/spatial_signatures/functional/corine/corine_</span><span class="si">{</span><span class="n">chunk_id</span><span class="si">}</span><span class="s2">.pq&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Chunk </span><span class="si">{</span><span class="n">chunk_id</span><span class="si">}</span><span class="s2"> processed sucessfully in </span><span class="si">{</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">s</span><span class="si">}</span><span class="s2"> seconds.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 0 processed sucessfully in 15.180331945419312 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 1 processed sucessfully in 30.089888095855713 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 2 processed sucessfully in 21.882530212402344 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 3 processed sucessfully in 17.526738166809082 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 4 processed sucessfully in 106.89093780517578 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 5 processed sucessfully in 317.46085810661316 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 6 processed sucessfully in 287.55741930007935 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 7 processed sucessfully in 52.53155994415283 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 8 processed sucessfully in 49.779944896698 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 9 processed sucessfully in 34.78387999534607 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 10 processed sucessfully in 72.16384053230286 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 11 processed sucessfully in 52.640920877456665 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 12 processed sucessfully in 65.59830093383789 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 13 processed sucessfully in 60.7873010635376 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 14 processed sucessfully in 76.49349236488342 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 15 processed sucessfully in 16.41744041442871 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 16 processed sucessfully in 19.981613636016846 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 17 processed sucessfully in 14.932554244995117 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 18 processed sucessfully in 15.702290296554565 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 19 processed sucessfully in 34.342867374420166 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 20 processed sucessfully in 39.59873700141907 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 21 processed sucessfully in 51.94429302215576 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 22 processed sucessfully in 56.69731068611145 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 23 processed sucessfully in 82.09859800338745 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 24 processed sucessfully in 28.112233877182007 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 25 processed sucessfully in 27.96365523338318 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 26 processed sucessfully in 21.680318593978882 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 27 processed sucessfully in 44.50490593910217 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 28 processed sucessfully in 15.241016864776611 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 29 processed sucessfully in 19.445778846740723 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 30 processed sucessfully in 75.84844732284546 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 31 processed sucessfully in 27.67076849937439 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 32 processed sucessfully in 130.36047387123108 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 33 processed sucessfully in 60.720449686050415 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 34 processed sucessfully in 46.61375951766968 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 35 processed sucessfully in 27.770570516586304 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 36 processed sucessfully in 17.652199506759644 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 37 processed sucessfully in 27.977357387542725 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 38 processed sucessfully in 224.82706594467163 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 39 processed sucessfully in 68.05412983894348 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 40 processed sucessfully in 65.66244673728943 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 41 processed sucessfully in 22.07956552505493 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 42 processed sucessfully in 90.9007716178894 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 43 processed sucessfully in 15.793612957000732 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 44 processed sucessfully in 13.336268901824951 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 45 processed sucessfully in 23.21897268295288 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 46 processed sucessfully in 55.5158896446228 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 47 processed sucessfully in 37.40347766876221 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 48 processed sucessfully in 126.36294674873352 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 49 processed sucessfully in 30.093411445617676 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 50 processed sucessfully in 33.95536017417908 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 51 processed sucessfully in 10.096921443939209 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 52 processed sucessfully in 24.450292825698853 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 53 processed sucessfully in 78.68081092834473 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 54 processed sucessfully in 59.39924621582031 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 55 processed sucessfully in 32.3205623626709 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 56 processed sucessfully in 22.943347215652466 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 57 processed sucessfully in 17.458800792694092 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 58 processed sucessfully in 42.03199028968811 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 59 processed sucessfully in 42.75125980377197 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 60 processed sucessfully in 37.35565733909607 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 61 processed sucessfully in 129.34060668945312 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 62 processed sucessfully in 28.503572940826416 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 63 processed sucessfully in 15.832542896270752 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 64 processed sucessfully in 90.61631035804749 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 65 processed sucessfully in 45.89105296134949 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 66 processed sucessfully in 127.9205219745636 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 67 processed sucessfully in 120.23514771461487 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 68 processed sucessfully in 37.70616149902344 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 69 processed sucessfully in 72.71402263641357 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 70 processed sucessfully in 18.224586248397827 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 71 processed sucessfully in 189.8400275707245 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 72 processed sucessfully in 35.05113673210144 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 73 processed sucessfully in 139.2181613445282 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 74 processed sucessfully in 50.77099657058716 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 75 processed sucessfully in 65.76493215560913 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 76 processed sucessfully in 51.584426164627075 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 77 processed sucessfully in 53.522892236709595 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 78 processed sucessfully in 47.52160692214966 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 79 processed sucessfully in 19.825929164886475 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 80 processed sucessfully in 30.792400598526 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 81 processed sucessfully in 19.92421293258667 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 82 processed sucessfully in 36.21914768218994 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 83 processed sucessfully in 175.30663919448853 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 84 processed sucessfully in 64.89760637283325 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 85 processed sucessfully in 80.92152333259583 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 86 processed sucessfully in 30.077708959579468 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 87 processed sucessfully in 267.03305554389954 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 88 processed sucessfully in 42.7241907119751 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 89 processed sucessfully in 84.39536690711975 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 90 processed sucessfully in 31.87593388557434 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 91 processed sucessfully in 93.81584119796753 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 92 processed sucessfully in 60.27356839179993 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 93 processed sucessfully in 34.05999040603638 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 94 processed sucessfully in 57.33334016799927 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 95 processed sucessfully in 75.45840859413147 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 96 processed sucessfully in 25.714704513549805 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 97 processed sucessfully in 150.45864415168762 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 98 processed sucessfully in 53.51958727836609 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 99 processed sucessfully in 44.32690238952637 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 100 processed sucessfully in 117.08002710342407 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 101 processed sucessfully in 47.73750948905945 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/dask_geopandas/backends.py:31: FutureWarning: The input object of type &#39;LineString&#39; is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type &#39;LineString&#39;, or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  a = np.array(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 102 processed sucessfully in 58.08854627609253 seconds.
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="retail-centres">
<h2>Retail centres<a class="headerlink" href="#retail-centres" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">retail</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s2">&quot;../../urbangrammar_samba/functional_data/retail_centres/Pre Release.zip!Retail_Centres_UK.gpkg&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/geopandas/geodataframe.py:577: RuntimeWarning: Sequential read of iterator was interrupted. Resetting iterator. This can negatively impact the performance.
  for feature in features_lst:
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">workers</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">LocalCluster</span><span class="p">(</span><span class="n">n_workers</span><span class="o">=</span><span class="n">workers</span><span class="p">,</span> <span class="n">threads_per_worker</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="n">client</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table style="border: 2px solid white;">
<tr>
<td style="vertical-align: top; border: 0px solid white">
<h3 style="text-align: left;">Client</h3>
<ul style="text-align: left; list-style: none; margin: 0; padding: 0;">
  <li><b>Scheduler: </b>tcp://127.0.0.1:43993</li>
  <li><b>Dashboard: </b><a href='http://127.0.0.1:8787/status' target='_blank'>http://127.0.0.1:8787/status</a></li>
</ul>
</td>
<td style="vertical-align: top; border: 0px solid white">
<h3 style="text-align: left;">Cluster</h3>
<ul style="text-align: left; list-style:none; margin: 0; padding: 0;">
  <li><b>Workers: </b>16</li>
  <li><b>Cores: </b>16</li>
  <li><b>Memory: </b>134.91 GB</li>
</ul>
</td>
</tr>
</table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">measure_nearest</span><span class="p">(</span><span class="n">chunk</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
    <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;../../urbangrammar_samba/spatial_signatures/tessellation/tess_</span><span class="si">{</span><span class="n">chunk</span><span class="si">}</span><span class="s1">.pq&#39;</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">total_bounds</span>
    
    <span class="n">initial_buffer</span> <span class="o">=</span> <span class="mi">500</span>
    <span class="n">buffered</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">tessellation</span><span class="o">.</span><span class="n">buffer</span><span class="p">(</span><span class="n">initial_buffer</span><span class="p">)</span>
    <span class="n">distance</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">orig</span><span class="p">,</span> <span class="n">geom</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">gdf</span><span class="o">.</span><span class="n">tessellation</span><span class="p">,</span> <span class="n">buffered</span><span class="o">.</span><span class="n">geometry</span><span class="p">):</span>
        <span class="n">query</span> <span class="o">=</span> <span class="n">retail</span><span class="o">.</span><span class="n">sindex</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">geom</span><span class="p">,</span> <span class="n">predicate</span><span class="o">=</span><span class="s1">&#39;intersects&#39;</span><span class="p">)</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">initial_buffer</span>
        <span class="k">while</span> <span class="n">query</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">query</span> <span class="o">=</span> <span class="n">retail</span><span class="o">.</span><span class="n">sindex</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">geom</span><span class="o">.</span><span class="n">buffer</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="n">predicate</span><span class="o">=</span><span class="s1">&#39;intersects&#39;</span><span class="p">)</span>
            <span class="n">b</span> <span class="o">+=</span> <span class="n">initial_buffer</span>

        <span class="n">distance</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">retail</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">query</span><span class="p">]</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">orig</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
    <span class="n">gdf</span><span class="p">[</span><span class="s1">&#39;nearest_retail_centre&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">distance</span>
    <span class="n">gdf</span><span class="p">[[</span><span class="s1">&#39;hindex&#39;</span><span class="p">,</span> <span class="s1">&#39;nearest_retail_centre&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;../../urbangrammar_samba/spatial_signatures/functional/retail_centre/retail_</span><span class="si">{</span><span class="n">chunk</span><span class="si">}</span><span class="s1">.pq&#39;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Chunk </span><span class="si">{</span><span class="n">chunk</span><span class="si">}</span><span class="s2"> processed sucessfully in </span><span class="si">{</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">s</span><span class="si">}</span><span class="s2"> seconds.&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">103</span><span class="p">))</span>
<span class="n">futures</span> <span class="o">=</span> <span class="p">[</span><span class="n">client</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">measure_nearest</span><span class="p">,</span> <span class="nb">next</span><span class="p">(</span><span class="n">inputs</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">workers</span><span class="p">)]</span>
<span class="n">ac</span> <span class="o">=</span> <span class="n">as_completed</span><span class="p">(</span><span class="n">futures</span><span class="p">)</span>
<span class="k">for</span> <span class="n">finished_future</span> <span class="ow">in</span> <span class="n">ac</span><span class="p">:</span>
    <span class="c1"># submit new future </span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">new_future</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">measure_nearest</span><span class="p">,</span> <span class="nb">next</span><span class="p">(</span><span class="n">inputs</span><span class="p">))</span>
        <span class="n">ac</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new_future</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">finished_future</span><span class="o">.</span><span class="n">result</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chunk 3 processed sucessfully in 229.41065430641174 seconds.
Chunk 15 processed sucessfully in 223.6650960445404 seconds.
Chunk 0 processed sucessfully in 244.80605340003967 seconds.
Chunk 2 processed sucessfully in 262.985951423645 seconds.
Chunk 11 processed sucessfully in 267.57428884506226 seconds.
Chunk 1 processed sucessfully in 295.50642371177673 seconds.
Chunk 9 processed sucessfully in 307.793461561203 seconds.
Chunk 10 processed sucessfully in 320.450528383255 seconds.
Chunk 7 processed sucessfully in 332.8020794391632 seconds.
Chunk 8 processed sucessfully in 341.40525555610657 seconds.
Chunk 13 processed sucessfully in 357.23317408561707 seconds.
Chunk 18 processed sucessfully in 197.36008834838867 seconds.
Chunk 16 processed sucessfully in 216.73886609077454 seconds.
Chunk 17 processed sucessfully in 217.3698329925537 seconds.
Chunk 14 processed sucessfully in 452.75913739204407 seconds.
Chunk 4 processed sucessfully in 480.302627325058 seconds.
Chunk 12 processed sucessfully in 471.55948305130005 seconds.
Chunk 20 processed sucessfully in 275.74783205986023 seconds.
Chunk 25 processed sucessfully in 205.81609511375427 seconds.
Chunk 19 processed sucessfully in 315.88619017601013 seconds.
Chunk 22 processed sucessfully in 296.9352958202362 seconds.
Chunk 23 processed sucessfully in 291.6380388736725 seconds.
Chunk 21 processed sucessfully in 347.3317663669586 seconds.
Chunk 24 processed sucessfully in 307.0247497558594 seconds.
Chunk 28 processed sucessfully in 218.92937803268433 seconds.
Chunk 26 processed sucessfully in 301.6752872467041 seconds.
Chunk 29 processed sucessfully in 248.87159490585327 seconds.
Chunk 31 processed sucessfully in 350.1357088088989 seconds.
Chunk 34 processed sucessfully in 275.669291973114 seconds.
Chunk 30 processed sucessfully in 371.2933940887451 seconds.
Chunk 27 processed sucessfully in 399.54145312309265 seconds.
Chunk 35 processed sucessfully in 264.3463280200958 seconds.
Chunk 36 processed sucessfully in 253.28276586532593 seconds.
Chunk 33 processed sucessfully in 317.8169991970062 seconds.
Chunk 6 processed sucessfully in 903.3587539196014 seconds.
Chunk 41 processed sucessfully in 247.21626138687134 seconds.
Chunk 37 processed sucessfully in 321.1305663585663 seconds.
Chunk 39 processed sucessfully in 332.087518453598 seconds.
Chunk 32 processed sucessfully in 572.0379726886749 seconds.
Chunk 44 processed sucessfully in 236.5347239971161 seconds.
Chunk 43 processed sucessfully in 242.6256082057953 seconds.
Chunk 5 processed sucessfully in 1089.7548084259033 seconds.
Chunk 45 processed sucessfully in 248.7026686668396 seconds.
Chunk 51 processed sucessfully in 232.10119724273682 seconds.
Chunk 46 processed sucessfully in 318.11290311813354 seconds.
Chunk 52 processed sucessfully in 232.10552144050598 seconds.
Chunk 40 processed sucessfully in 510.62988567352295 seconds.
Chunk 49 processed sucessfully in 305.51303577423096 seconds.
Chunk 47 processed sucessfully in 339.8048632144928 seconds.
Chunk 50 processed sucessfully in 307.6450071334839 seconds.
Chunk 42 processed sucessfully in 539.0357091426849 seconds.
Chunk 55 processed sucessfully in 218.10769367218018 seconds.
Chunk 48 processed sucessfully in 440.29719066619873 seconds.
Chunk 56 processed sucessfully in 237.55282187461853 seconds.
Chunk 38 processed sucessfully in 686.0278518199921 seconds.
Chunk 53 processed sucessfully in 348.22418904304504 seconds.
Chunk 57 processed sucessfully in 257.0237774848938 seconds.
Chunk 58 processed sucessfully in 334.4561765193939 seconds.
Chunk 63 processed sucessfully in 248.49455523490906 seconds.
Chunk 54 processed sucessfully in 389.3916347026825 seconds.
Chunk 60 processed sucessfully in 286.8058297634125 seconds.
Chunk 62 processed sucessfully in 309.3699097633362 seconds.
Chunk 59 processed sucessfully in 347.8663284778595 seconds.
Chunk 65 processed sucessfully in 369.8567621707916 seconds.
Chunk 70 processed sucessfully in 262.00583481788635 seconds.
Chunk 72 processed sucessfully in 290.1499674320221 seconds.
Chunk 68 processed sucessfully in 369.4697890281677 seconds.
Chunk 69 processed sucessfully in 363.84302401542664 seconds.
Chunk 74 processed sucessfully in 277.82506132125854 seconds.
Chunk 66 processed sucessfully in 483.35972332954407 seconds.
Chunk 79 processed sucessfully in 204.1803150177002 seconds.
Chunk 64 processed sucessfully in 604.9508926868439 seconds.
Chunk 76 processed sucessfully in 347.3878936767578 seconds.
Chunk 75 processed sucessfully in 383.04845547676086 seconds.
Chunk 78 processed sucessfully in 365.3083326816559 seconds.
Chunk 81 processed sucessfully in 233.1090157032013 seconds.
Chunk 67 processed sucessfully in 590.5635316371918 seconds.
Chunk 80 processed sucessfully in 298.7273712158203 seconds.
Chunk 71 processed sucessfully in 568.4501793384552 seconds.
Chunk 61 processed sucessfully in 734.6568140983582 seconds.
Chunk 77 processed sucessfully in 426.8115291595459 seconds.
Chunk 82 processed sucessfully in 260.38281416893005 seconds.
Chunk 73 processed sucessfully in 521.3478484153748 seconds.
Chunk 84 processed sucessfully in 336.4568943977356 seconds.
Chunk 86 processed sucessfully in 317.38557291030884 seconds.
Chunk 90 processed sucessfully in 253.7183711528778 seconds.
Chunk 96 processed sucessfully in 217.65001463890076 seconds.
Chunk 94 processed sucessfully in 261.67647528648376 seconds.
Chunk 88 processed sucessfully in 380.05103516578674 seconds.
Chunk 93 processed sucessfully in 291.5382390022278 seconds.
Chunk 91 processed sucessfully in 324.7585823535919 seconds.
Chunk 85 processed sucessfully in 511.55556321144104 seconds.
Chunk 95 processed sucessfully in 333.492094039917 seconds.
Chunk 92 processed sucessfully in 398.7446265220642 seconds.
Chunk 98 processed sucessfully in 344.81411385536194 seconds.
Chunk 102 processed sucessfully in 211.1076967716217 seconds.
Chunk 97 processed sucessfully in 431.70567202568054 seconds.
Chunk 99 processed sucessfully in 336.0125641822815 seconds.
Chunk 100 processed sucessfully in 303.5264847278595 seconds.
Chunk 89 processed sucessfully in 585.6074168682098 seconds.
Chunk 83 processed sucessfully in 766.684189081192 seconds.
Chunk 101 processed sucessfully in 354.22615480422974 seconds.
Chunk 87 processed sucessfully in 784.9089789390564 seconds.
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="water">
<h2>Water<a class="headerlink" href="#water" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">create_engine</span>
<span class="kn">from</span> <span class="nn">shapely.geometry</span> <span class="kn">import</span> <span class="n">box</span>
<span class="kn">from</span> <span class="nn">shapely.ops</span> <span class="kn">import</span> <span class="n">polygonize</span>

<span class="n">user</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DB_USER&#39;</span><span class="p">)</span>
<span class="n">pwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DB_PWD&#39;</span><span class="p">)</span>
<span class="n">host</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DB_HOST&#39;</span><span class="p">)</span>
<span class="n">port</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DB_PORT&#39;</span><span class="p">)</span>

<span class="n">db_connection_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;postgres+psycopg2://</span><span class="si">{</span><span class="n">user</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">pwd</span><span class="si">}</span><span class="s2">@</span><span class="si">{</span><span class="n">host</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">port</span><span class="si">}</span><span class="s2">/built_env&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">measure_nearest</span><span class="p">(</span><span class="n">chunk</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
    <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;../../urbangrammar_samba/spatial_signatures/tessellation/tess_</span><span class="si">{</span><span class="n">chunk</span><span class="si">}</span><span class="s1">.pq&#39;</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">total_bounds</span>
    <span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">db_connection_url</span><span class="p">)</span>
    <span class="n">sql</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;SELECT * FROM gb_coastline_2016 WHERE ST_Intersects(geometry, ST_MakeEnvelope(</span><span class="si">{</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">b</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s1">, 27700))&#39;</span>
    <span class="n">coastline</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_postgis</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">engine</span><span class="p">,</span> <span class="n">geom_col</span><span class="o">=</span><span class="s1">&#39;geometry&#39;</span><span class="p">)</span>
    <span class="n">sql</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;SELECT * FROM openmap_surfacewater_area_200824 WHERE ST_Intersects(geometry, ST_MakeEnvelope(</span><span class="si">{</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">b</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s1">, 27700))&#39;</span>
    <span class="n">water</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_postgis</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">engine</span><span class="p">,</span> <span class="n">geom_col</span><span class="o">=</span><span class="s1">&#39;geometry&#39;</span><span class="p">)</span>
    
    <span class="n">sql</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;SELECT * FROM gb_coastline_2016&#39;</span>
    <span class="n">coastline</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_postgis</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">engine</span><span class="p">,</span> <span class="n">geom_col</span><span class="o">=</span><span class="s1">&#39;geometry&#39;</span><span class="p">)</span>

    <span class="n">polys</span> <span class="o">=</span> <span class="n">polygonize</span><span class="p">(</span><span class="n">coastline</span><span class="o">.</span><span class="n">geometry</span><span class="p">)</span>
    <span class="n">land</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">(</span><span class="n">polys</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="mi">27700</span><span class="p">)</span>
    <span class="n">sea</span> <span class="o">=</span> <span class="n">box</span><span class="p">(</span><span class="o">*</span><span class="n">land</span><span class="o">.</span><span class="n">total_bounds</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">land</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">unary_union</span><span class="p">)</span>
    
    <span class="n">target</span> <span class="o">=</span> <span class="n">water</span><span class="o">.</span><span class="n">geometry</span>
    <span class="n">target</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">water</span><span class="p">)]</span> <span class="o">=</span> <span class="n">sea</span>
    <span class="n">target</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">box</span><span class="p">(</span><span class="o">*</span><span class="n">b</span><span class="p">))</span>
    
    <span class="n">initial_buffer</span> <span class="o">=</span> <span class="mi">500</span>
    <span class="n">buffered</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">tessellation</span><span class="o">.</span><span class="n">buffer</span><span class="p">(</span><span class="n">initial_buffer</span><span class="p">)</span>
    <span class="n">distance</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">orig</span><span class="p">,</span> <span class="n">geom</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">gdf</span><span class="o">.</span><span class="n">tessellation</span><span class="p">,</span> <span class="n">buffered</span><span class="o">.</span><span class="n">geometry</span><span class="p">):</span>
        <span class="n">query</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">sindex</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">geom</span><span class="p">,</span> <span class="n">predicate</span><span class="o">=</span><span class="s1">&#39;intersects&#39;</span><span class="p">)</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">initial_buffer</span>
        <span class="k">while</span> <span class="n">query</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">query</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">sindex</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">geom</span><span class="o">.</span><span class="n">buffer</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="n">predicate</span><span class="o">=</span><span class="s1">&#39;intersects&#39;</span><span class="p">)</span>
            <span class="n">b</span> <span class="o">+=</span> <span class="n">initial_buffer</span>

        <span class="n">distance</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">query</span><span class="p">]</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">orig</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
    <span class="n">gdf</span><span class="p">[</span><span class="s1">&#39;nearest_water&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">distance</span>
    <span class="n">gdf</span><span class="p">[[</span><span class="s1">&#39;hindex&#39;</span><span class="p">,</span> <span class="s1">&#39;nearest_water&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;../../urbangrammar_samba/spatial_signatures/functional/water/water_</span><span class="si">{</span><span class="n">chunk</span><span class="si">}</span><span class="s1">.pq&#39;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Chunk </span><span class="si">{</span><span class="n">chunk</span><span class="si">}</span><span class="s2"> processed sucessfully in </span><span class="si">{</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">s</span><span class="si">}</span><span class="s2"> seconds.&quot;</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./measuring"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Dani Arribas-Bel, Martin Fleischmann<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>